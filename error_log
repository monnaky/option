[16-Nov-2025 06:28:50 Europe/Berlin] PHP Warning:  Constant APP_PATH already defined in C:\xampp\htdocs\vtmoption\config.php on line 98
[16-Nov-2025 05:28:50 UTC] PHP Fatal error:  Uncaught Error: Class "Validator" not found in C:\xampp\htdocs\vtmoption\api\auth.php:57
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\auth.php(28): handleRegister()
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\auth.php on line 57
[16-Nov-2025 06:29:11 Europe/Berlin] PHP Warning:  Constant APP_PATH already defined in C:\xampp\htdocs\vtmoption\config.php on line 98
[16-Nov-2025 05:29:11 UTC] PHP Fatal error:  Uncaught Error: Class "Validator" not found in C:\xampp\htdocs\vtmoption\api\auth.php:57
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\auth.php(28): handleRegister()
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\auth.php on line 57
[16-Nov-2025 06:29:16 Europe/Berlin] PHP Warning:  Constant APP_PATH already defined in C:\xampp\htdocs\vtmoption\config.php on line 98
[16-Nov-2025 05:29:16 UTC] PHP Fatal error:  Uncaught Error: Class "Validator" not found in C:\xampp\htdocs\vtmoption\api\auth.php:57
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\auth.php(28): handleRegister()
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\auth.php on line 57
[16-Nov-2025 06:29:46 Europe/Berlin] PHP Warning:  Constant APP_PATH already defined in C:\xampp\htdocs\vtmoption\config.php on line 98
[16-Nov-2025 05:29:46 UTC] PHP Fatal error:  Uncaught Error: Class "Validator" not found in C:\xampp\htdocs\vtmoption\api\auth.php:57
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\auth.php(28): handleRegister()
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\auth.php on line 57
[16-Nov-2025 06:29:48 Europe/Berlin] PHP Warning:  Constant APP_PATH already defined in C:\xampp\htdocs\vtmoption\config.php on line 98
[16-Nov-2025 05:29:48 UTC] PHP Fatal error:  Uncaught Error: Class "Validator" not found in C:\xampp\htdocs\vtmoption\api\auth.php:57
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\auth.php(28): handleRegister()
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\auth.php on line 57
[16-Nov-2025 06:30:03 Europe/Berlin] PHP Warning:  Constant APP_PATH already defined in C:\xampp\htdocs\vtmoption\config.php on line 98
[16-Nov-2025 06:30:06 Europe/Berlin] PHP Warning:  Constant APP_PATH already defined in C:\xampp\htdocs\vtmoption\config.php on line 98
[16-Nov-2025 06:48:45 Europe/Berlin] PHP Warning:  Constant APP_PATH already defined in C:\xampp\htdocs\vtmoption\config.php on line 98
[16-Nov-2025 06:49:53 Europe/Berlin] PHP Warning:  Constant APP_PATH already defined in C:\xampp\htdocs\vtmoption\config.php on line 98
[16-Nov-2025 05:49:53 UTC] PHP Fatal error:  Uncaught Error: Class "Validator" not found in C:\xampp\htdocs\vtmoption\api\auth.php:57
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\auth.php(28): handleRegister()
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\auth.php on line 57
[16-Nov-2025 05:57:35 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:36 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:36 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:36 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:37 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:38 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:39 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:39 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:39 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:39 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:41 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:42 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:42 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:42 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:43 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:43 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:45 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:45 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:45 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:45 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:47 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:49 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:49 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:49 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:49 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:50 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:52 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:52 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:52 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:52 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:54 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:54 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:55 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:55 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:55 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:56 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:58 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:58 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:58 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:58 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:57:59 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:00 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:00 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:00 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:00 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:02 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:04 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:04 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:04 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:04 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:04 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:06 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:07 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:07 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:07 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:08 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:09 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:10 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:10 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:10 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:10 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:12 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:13 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:13 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:13 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:14 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:14 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:16 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:16 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:16 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:16 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:18 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:19 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:19 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:19 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:19 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:20 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:22 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:22 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:22 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:22 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:24 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:24 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:25 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:25 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:25 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:26 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:28 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:28 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:28 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:28 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:29 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:30 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:31 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:31 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:31 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:32 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:34 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:34 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:34 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:34 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:34 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:36 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:37 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:37 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:37 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:38 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:39 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:40 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:40 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:40 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:40 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:41 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:42 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:42 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:42 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:44 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:44 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:46 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:46 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:46 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:46 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:53 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:53 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:53 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:53 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:58:53 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:28 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:28 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:28 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:28 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:28 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:29 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:30 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:30 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:30 UTC] PHP Fatal error:  Uncaught Error: Class "Dotenv\Dotenv" not found in C:\xampp\htdocs\vtmoption\api\realtime.php:28
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\realtime.php on line 28
[16-Nov-2025 05:59:41 UTC] PHP Fatal error:  Uncaught Error: Class "AuthMiddleware" not found in C:\xampp\htdocs\vtmoption\api\user.php:23
Stack trace:
#0 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\user.php on line 23
[16-Nov-2025 06:05:16 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=1089, App ID: 1089
[16-Nov-2025 06:05:16 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method App\Services\DerivAPI::getAccountInfo() in C:\xampp\htdocs\vtmoption\api\user.php:86
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\user.php on line 86
[16-Nov-2025 06:05:42 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=1089, App ID: 1089
[16-Nov-2025 06:05:42 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method App\Services\DerivAPI::getAccountInfo() in C:\xampp\htdocs\vtmoption\api\user.php:86
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\user.php on line 86
[16-Nov-2025 06:05:46 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=1089, App ID: 1089
[16-Nov-2025 06:05:46 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method App\Services\DerivAPI::getAccountInfo() in C:\xampp\htdocs\vtmoption\api\user.php:86
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\user.php on line 86
[16-Nov-2025 18:26:28 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=1089, App ID: 1089
[16-Nov-2025 18:26:28 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method App\Services\DerivAPI::getAccountInfo() in C:\xampp\htdocs\vtmoption\api\user.php:86
Stack trace:
#0 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#1 {main}
  thrown in C:\xampp\htdocs\vtmoption\api\user.php on line 86
[16-Nov-2025 18:49:28 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=1089, App ID: 1089
[16-Nov-2025 18:49:28 UTC] PHP Fatal error:  Uncaught Error: Class "WebSocket\Client" not found in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php:119
Stack trace:
#0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(84): App\Services\DerivAPI->establishConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(72): App\Services\DerivAPI->establishConnectionWithRetry()
#2 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(317): App\Services\DerivAPI->ensureConnection()
#3 C:\xampp\htdocs\vtmoption\api\user.php(89): App\Services\DerivAPI->getAccountInfo()
#4 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#5 {main}
  thrown in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php on line 119
[16-Nov-2025 18:50:15 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=1089, App ID: 1089
[16-Nov-2025 18:50:15 UTC] PHP Fatal error:  Uncaught Error: Class "WebSocket\Client" not found in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php:119
Stack trace:
#0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(84): App\Services\DerivAPI->establishConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(72): App\Services\DerivAPI->establishConnectionWithRetry()
#2 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(317): App\Services\DerivAPI->ensureConnection()
#3 C:\xampp\htdocs\vtmoption\api\user.php(89): App\Services\DerivAPI->getAccountInfo()
#4 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#5 {main}
  thrown in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php on line 119
[16-Nov-2025 18:52:06 UTC] Starting Deriv API validation for user 1
[16-Nov-2025 18:52:06 UTC] API token length: 15
[16-Nov-2025 18:52:06 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=1089, App ID: 1089
[16-Nov-2025 18:52:06 UTC] Calling authorize() to validate token
[16-Nov-2025 18:52:06 UTC] Attempting to authorize Deriv API token (length: 15)
[16-Nov-2025 18:52:06 UTC] Establishing WebSocket connection to: wss://ws.deriv.com/websockets/v3?app_id=1089
[16-Nov-2025 18:52:06 UTC] PHP Fatal error:  Uncaught Error: Class "WebSocket\Client" not found in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php:123
Stack trace:
#0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(84): App\Services\DerivAPI->establishConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(72): App\Services\DerivAPI->establishConnectionWithRetry()
#2 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(280): App\Services\DerivAPI->ensureConnection()
#3 C:\xampp\htdocs\vtmoption\api\user.php(94): App\Services\DerivAPI->authorize()
#4 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#5 {main}
  thrown in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php on line 123
[16-Nov-2025 19:02:08 UTC] Starting Deriv API validation for user 1
[16-Nov-2025 19:02:08 UTC] API token length: 15
[16-Nov-2025 19:02:08 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=1089, App ID: 1089
[16-Nov-2025 19:02:08 UTC] Calling authorize() to validate token
[16-Nov-2025 19:02:08 UTC] Attempting to authorize Deriv API token (length: 15)
[16-Nov-2025 19:02:08 UTC] Establishing WebSocket connection to: wss://ws.deriv.com/websockets/v3?app_id=1089
[16-Nov-2025 19:02:08 UTC] PHP Fatal error:  Uncaught Error: Class "WebSocket\Client" not found in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php:123
Stack trace:
#0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(84): App\Services\DerivAPI->establishConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(72): App\Services\DerivAPI->establishConnectionWithRetry()
#2 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(280): App\Services\DerivAPI->ensureConnection()
#3 C:\xampp\htdocs\vtmoption\api\user.php(94): App\Services\DerivAPI->authorize()
#4 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#5 {main}
  thrown in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php on line 123
[16-Nov-2025 19:03:44 UTC] Starting Deriv API validation for user 1
[16-Nov-2025 19:03:44 UTC] API token length: 15
[16-Nov-2025 19:03:44 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=105326, App ID: 105326
[16-Nov-2025 19:03:44 UTC] Calling authorize() to validate token
[16-Nov-2025 19:03:44 UTC] Attempting to authorize Deriv API token (length: 15)
[16-Nov-2025 19:03:44 UTC] Establishing WebSocket connection to: wss://ws.deriv.com/websockets/v3?app_id=105326
[16-Nov-2025 19:03:44 UTC] PHP Fatal error:  Uncaught Error: Class "WebSocket\Client" not found in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php:123
Stack trace:
#0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(84): App\Services\DerivAPI->establishConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(72): App\Services\DerivAPI->establishConnectionWithRetry()
#2 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(280): App\Services\DerivAPI->ensureConnection()
#3 C:\xampp\htdocs\vtmoption\api\user.php(94): App\Services\DerivAPI->authorize()
#4 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#5 {main}
  thrown in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php on line 123
[16-Nov-2025 19:04:35 UTC] Starting Deriv API validation for user 1
[16-Nov-2025 19:04:35 UTC] API token length: 15
[16-Nov-2025 19:04:35 UTC] DerivAPI initialized: wss://ws.deriv.com/websockets/v3?app_id=105326, App ID: 105326
[16-Nov-2025 19:04:35 UTC] Calling authorize() to validate token
[16-Nov-2025 19:04:35 UTC] Attempting to authorize Deriv API token (length: 15)
[16-Nov-2025 19:04:35 UTC] Establishing WebSocket connection to: wss://ws.deriv.com/websockets/v3?app_id=105326
[16-Nov-2025 19:04:35 UTC] PHP Fatal error:  Uncaught Error: Class "WebSocket\Client" not found in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php:123
Stack trace:
#0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(84): App\Services\DerivAPI->establishConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(72): App\Services\DerivAPI->establishConnectionWithRetry()
#2 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(280): App\Services\DerivAPI->ensureConnection()
#3 C:\xampp\htdocs\vtmoption\api\user.php(94): App\Services\DerivAPI->authorize()
#4 C:\xampp\htdocs\vtmoption\api\user.php(43): handleSaveToken(1)
#5 {main}
  thrown in C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php on line 123
[17-Nov-2025 12:20:14 UTC] Connecting to WebSocket: ssl://ws.derivws.com:443
[17-Nov-2025 12:20:15 UTC] Fatal error in api/debug.php: Path cannot be empty
[17-Nov-2025 12:20:15 UTC] Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php(88): stream_socket_client('ssl://ws.derivw...', 0, '', 30, 4, Resource id #19)
#1 C:\xampp\htdocs\vtmoption\api\debug.php(206): App\Services\WebSocketClient->connect()
#2 C:\xampp\htdocs\vtmoption\api\debug.php(68): testWebSocketConnection()
#3 {main}
[17-Nov-2025 12:23:13 UTC] WebSocket URL parsed - Host: ws.derivws.com, Port: 443, Path: /websockets/v3?app_id=105326, Secure: yes
[17-Nov-2025 12:23:13 UTC] Connecting to WebSocket: ssl://ws.derivws.com:443
[17-Nov-2025 12:23:13 UTC] Fatal error in api/debug.php: Path cannot be empty
[17-Nov-2025 12:23:13 UTC] Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php(112): stream_socket_client('ssl://ws.derivw...', 0, '', 30, 4, Resource id #19)
#1 C:\xampp\htdocs\vtmoption\api\debug.php(206): App\Services\WebSocketClient->connect()
#2 C:\xampp\htdocs\vtmoption\api\debug.php(68): testWebSocketConnection()
#3 {main}
[17-Nov-2025 12:27:10 UTC] [WebSocketClient] Constructor called with URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:27:10 UTC] [WebSocketClient] URL type: string, length: 48
[17-Nov-2025 12:27:10 UTC] [WebSocketClient] Timeout: 30
[17-Nov-2025 12:27:10 UTC] [WebSocketClient] Calling parseUrl() with: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:27:10 UTC] [parseUrl] Starting URL parsing for: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:27:10 UTC] [parseUrl] parse_url() result: array (
  'scheme' => 'wss',
  'host' => 'ws.derivws.com',
  'path' => '/websockets/v3',
  'query' => 'app_id=105326',
)
[17-Nov-2025 12:27:10 UTC] [parseUrl] Scheme: wss
[17-Nov-2025 12:27:10 UTC] [parseUrl] Host: ws.derivws.com
[17-Nov-2025 12:27:10 UTC] [parseUrl] Port: NOT SET
[17-Nov-2025 12:27:10 UTC] [parseUrl] Path: '/websockets/v3'
[17-Nov-2025 12:27:10 UTC] [parseUrl] Query: app_id=105326
[17-Nov-2025 12:27:10 UTC] [parseUrl] Secure mode: yes
[17-Nov-2025 12:27:10 UTC] [parseUrl] Host extracted: 'ws.derivws.com'
[17-Nov-2025 12:27:10 UTC] [parseUrl] Port extracted: 443
[17-Nov-2025 12:27:10 UTC] [parseUrl] Raw path from parse_url: '/websockets/v3'
[17-Nov-2025 12:27:10 UTC] [parseUrl] Path is empty check: NO
[17-Nov-2025 12:27:10 UTC] [parseUrl] Path is null check: NO
[17-Nov-2025 12:27:10 UTC] [parseUrl] Path after normalization: '/websockets/v3'
[17-Nov-2025 12:27:10 UTC] [parseUrl] Appending query string: app_id=105326
[17-Nov-2025 12:27:10 UTC] [parseUrl] Final path value: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:27:10 UTC] [parseUrl] Final path length: 28
[17-Nov-2025 12:27:10 UTC] [parseUrl] Final path empty check: NO - OK
[17-Nov-2025 12:27:10 UTC] [parseUrl] URL parsing completed successfully - Host: ws.derivws.com, Port: 443, Path: /websockets/v3?app_id=105326, Secure: yes
[17-Nov-2025 12:27:10 UTC] [WebSocketClient] Constructor completed - Host: ws.derivws.com, Port: 443, Path: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:27:10 UTC] [connect] Connect() method called
[17-Nov-2025 12:27:10 UTC] [connect] Current connection status: not connected
[17-Nov-2025 12:27:10 UTC] [connect] Current URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:27:10 UTC] [connect] Current host: 'ws.derivws.com'
[17-Nov-2025 12:27:10 UTC] [connect] Current port: 443
[17-Nov-2025 12:27:10 UTC] [connect] Current path: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:27:10 UTC] [connect] Current path empty check: NO - OK
[17-Nov-2025 12:27:10 UTC] [connect] Current path length: 28
[17-Nov-2025 12:27:10 UTC] Connecting to WebSocket: ssl://ws.derivws.com:443
[17-Nov-2025 12:27:11 UTC] Fatal error in api/debug.php: Path cannot be empty
[17-Nov-2025 12:27:11 UTC] Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php(179): stream_socket_client('ssl://ws.derivw...', 0, '', 30, 4, Resource id #19)
#1 C:\xampp\htdocs\vtmoption\api\debug.php(206): App\Services\WebSocketClient->connect()
#2 C:\xampp\htdocs\vtmoption\api\debug.php(68): testWebSocketConnection()
#3 {main}
[17-Nov-2025 12:30:29 UTC] [ERROR_LOG_TEST] TEST_ERROR_LOG_1763382629_691b156530599
[17-Nov-2025 12:34:13 UTC] [ERROR_LOG_TEST] TEST_ERROR_LOG_1763382853_691b164529bda
[17-Nov-2025 12:35:07 UTC] [testWebSocketConnection] Creating WebSocketClient with URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:35:07 UTC] [WebSocketClient] Constructor called with URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:35:07 UTC] [WebSocketClient] URL type: string, length: 48
[17-Nov-2025 12:35:07 UTC] [WebSocketClient] Timeout: 30
[17-Nov-2025 12:35:07 UTC] [WebSocketClient] Calling parseUrl() with: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:35:07 UTC] [parseUrl] Starting URL parsing for: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:35:07 UTC] [parseUrl] parse_url() result: array (
  'scheme' => 'wss',
  'host' => 'ws.derivws.com',
  'path' => '/websockets/v3',
  'query' => 'app_id=105326',
)
[17-Nov-2025 12:35:07 UTC] [parseUrl] Scheme: wss
[17-Nov-2025 12:35:07 UTC] [parseUrl] Host: ws.derivws.com
[17-Nov-2025 12:35:07 UTC] [parseUrl] Port: NOT SET
[17-Nov-2025 12:35:07 UTC] [parseUrl] Path: '/websockets/v3'
[17-Nov-2025 12:35:07 UTC] [parseUrl] Query: app_id=105326
[17-Nov-2025 12:35:07 UTC] [parseUrl] Secure mode: yes
[17-Nov-2025 12:35:07 UTC] [parseUrl] Host extracted: 'ws.derivws.com'
[17-Nov-2025 12:35:07 UTC] [parseUrl] Port extracted: 443
[17-Nov-2025 12:35:07 UTC] [parseUrl] Raw path from parse_url: '/websockets/v3'
[17-Nov-2025 12:35:07 UTC] [parseUrl] Path is empty check: NO
[17-Nov-2025 12:35:07 UTC] [parseUrl] Path is null check: NO
[17-Nov-2025 12:35:07 UTC] [parseUrl] Path after normalization: '/websockets/v3'
[17-Nov-2025 12:35:07 UTC] [parseUrl] Appending query string: app_id=105326
[17-Nov-2025 12:35:07 UTC] [parseUrl] Final path value: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:35:07 UTC] [parseUrl] Final path length: 28
[17-Nov-2025 12:35:07 UTC] [parseUrl] Final path empty check: NO - OK
[17-Nov-2025 12:35:07 UTC] [parseUrl] URL parsing completed successfully - Host: ws.derivws.com, Port: 443, Path: /websockets/v3?app_id=105326, Secure: yes
[17-Nov-2025 12:35:07 UTC] [WebSocketClient] Constructor completed - Host: ws.derivws.com, Port: 443, Path: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:35:07 UTC] [testWebSocketConnection] Calling connect()
[17-Nov-2025 12:35:07 UTC] [connect] Connect() method called
[17-Nov-2025 12:35:07 UTC] [connect] Current connection status: not connected
[17-Nov-2025 12:35:07 UTC] [connect] Current URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:35:07 UTC] [connect] Current host: 'ws.derivws.com'
[17-Nov-2025 12:35:07 UTC] [connect] Current port: 443
[17-Nov-2025 12:35:07 UTC] [connect] Current path: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:35:07 UTC] [connect] Current path empty check: NO - OK
[17-Nov-2025 12:35:07 UTC] [connect] Current path length: 28
[17-Nov-2025 12:35:07 UTC] Connecting to WebSocket: ssl://ws.derivws.com:443
[17-Nov-2025 12:35:07 UTC] [DEBUG.PHP] Fatal error: Path cannot be empty
[17-Nov-2025 12:35:07 UTC] [DEBUG.PHP] Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php(179): stream_socket_client('ssl://ws.derivw...', 0, '', 30, 4, Resource id #21)
#1 C:\xampp\htdocs\vtmoption\api\debug.php(483): App\Services\WebSocketClient->connect()
#2 C:\xampp\htdocs\vtmoption\api\debug.php(115): testWebSocketConnection()
#3 {main}
[17-Nov-2025 12:35:07 UTC] [DEBUG.PHP] Error details: {
    "message": "Path cannot be empty",
    "type": "ValueError",
    "file": "C:\\xampp\\htdocs\\vtmoption\\app\\services\\WebSocketClient.php",
    "line": 179,
    "trace": [
        "#0 C:\\xampp\\htdocs\\vtmoption\\app\\services\\WebSocketClient.php(179): stream_socket_client('ssl:\/\/ws.derivw...', 0, '', 30, 4, Resource id #21)",
        "#1 C:\\xampp\\htdocs\\vtmoption\\api\\debug.php(483): App\\Services\\WebSocketClient->connect()",
        "#2 C:\\xampp\\htdocs\\vtmoption\\api\\debug.php(115): testWebSocketConnection()",
        "#3 {main}"
    ]
}
[17-Nov-2025 12:39:27 UTC] [testWebSocketConnection] Creating WebSocketClient with URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:39:27 UTC] [WebSocketClient] Constructor called with URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:39:27 UTC] [WebSocketClient] URL type: string, length: 48
[17-Nov-2025 12:39:27 UTC] [WebSocketClient] Timeout: 30
[17-Nov-2025 12:39:27 UTC] [WebSocketClient] Calling parseUrl() with: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:39:27 UTC] [parseUrl] Starting URL parsing for: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:39:27 UTC] [parseUrl] parse_url() result: array (
  'scheme' => 'wss',
  'host' => 'ws.derivws.com',
  'path' => '/websockets/v3',
  'query' => 'app_id=105326',
)
[17-Nov-2025 12:39:27 UTC] [parseUrl] Scheme: wss
[17-Nov-2025 12:39:27 UTC] [parseUrl] Host: ws.derivws.com
[17-Nov-2025 12:39:27 UTC] [parseUrl] Port: NOT SET
[17-Nov-2025 12:39:27 UTC] [parseUrl] Path: '/websockets/v3'
[17-Nov-2025 12:39:27 UTC] [parseUrl] Query: app_id=105326
[17-Nov-2025 12:39:27 UTC] [parseUrl] Secure mode: yes
[17-Nov-2025 12:39:27 UTC] [parseUrl] Host extracted: 'ws.derivws.com'
[17-Nov-2025 12:39:27 UTC] [parseUrl] Port extracted: 443
[17-Nov-2025 12:39:27 UTC] [parseUrl] Raw path from parse_url: '/websockets/v3'
[17-Nov-2025 12:39:27 UTC] [parseUrl] Path is empty check: NO
[17-Nov-2025 12:39:27 UTC] [parseUrl] Path is null check: NO
[17-Nov-2025 12:39:27 UTC] [parseUrl] Path after normalization: '/websockets/v3'
[17-Nov-2025 12:39:27 UTC] [parseUrl] Appending query string: app_id=105326
[17-Nov-2025 12:39:27 UTC] [parseUrl] Final path value: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:39:27 UTC] [parseUrl] Final path length: 28
[17-Nov-2025 12:39:27 UTC] [parseUrl] Final path empty check: NO - OK
[17-Nov-2025 12:39:27 UTC] [parseUrl] URL parsing completed successfully - Host: ws.derivws.com, Port: 443, Path: /websockets/v3?app_id=105326, Secure: yes
[17-Nov-2025 12:39:27 UTC] [WebSocketClient] Constructor completed - Host: ws.derivws.com, Port: 443, Path: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:39:27 UTC] [testWebSocketConnection] Calling connect()
[17-Nov-2025 12:39:27 UTC] [connect] Connect() method called
[17-Nov-2025 12:39:27 UTC] [connect] Current connection status: not connected
[17-Nov-2025 12:39:27 UTC] [connect] Current URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:39:27 UTC] [connect] Current host: 'ws.derivws.com'
[17-Nov-2025 12:39:27 UTC] [connect] Current port: 443
[17-Nov-2025 12:39:27 UTC] [connect] Current path: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:39:27 UTC] [connect] Current path empty check: NO - OK
[17-Nov-2025 12:39:27 UTC] [connect] Current path length: 28
[17-Nov-2025 12:39:27 UTC] [connect] About to call stream_socket_client()
[17-Nov-2025 12:39:27 UTC] [connect] Address: ssl://ws.derivws.com:443
[17-Nov-2025 12:39:27 UTC] [connect] Path will be used in handshake: '/websockets/v3?app_id=105326'
[17-Nov-2025 12:39:27 UTC] [connect] Path length: 28
[17-Nov-2025 12:39:27 UTC] [connect] Calling stream_socket_client() with address: ssl://ws.derivws.com:443
[17-Nov-2025 12:39:27 UTC] [connect] Path '/websockets/v3?app_id=105326' will be sent in HTTP handshake, not in connection string
[17-Nov-2025 12:39:27 UTC] [DEBUG.PHP] Fatal error: Path cannot be empty
[17-Nov-2025 12:39:27 UTC] [DEBUG.PHP] Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php(200): stream_socket_client('ssl://ws.derivw...', 0, '', 30, 4, Resource id #21)
#1 C:\xampp\htdocs\vtmoption\api\debug.php(483): App\Services\WebSocketClient->connect()
#2 C:\xampp\htdocs\vtmoption\api\debug.php(115): testWebSocketConnection()
#3 {main}
[17-Nov-2025 12:39:27 UTC] [DEBUG.PHP] Error details: {
    "message": "Path cannot be empty",
    "type": "ValueError",
    "file": "C:\\xampp\\htdocs\\vtmoption\\app\\services\\WebSocketClient.php",
    "line": 200,
    "trace": [
        "#0 C:\\xampp\\htdocs\\vtmoption\\app\\services\\WebSocketClient.php(200): stream_socket_client('ssl:\/\/ws.derivw...', 0, '', 30, 4, Resource id #21)",
        "#1 C:\\xampp\\htdocs\\vtmoption\\api\\debug.php(483): App\\Services\\WebSocketClient->connect()",
        "#2 C:\\xampp\\htdocs\\vtmoption\\api\\debug.php(115): testWebSocketConnection()",
        "#3 {main}"
    ]
}
[17-Nov-2025 12:45:44 UTC] [testWebSocketConnection] Creating WebSocketClient with URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:45:44 UTC] [testWebSocketConnection] Calling connect()
[17-Nov-2025 12:45:44 UTC] [DEBUG.PHP] Fatal error: Path cannot be empty
[17-Nov-2025 12:45:44 UTC] [DEBUG.PHP] Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php(235): stream_socket_client('ssl://ws.derivw...', 0, '', 30, 4, Resource id #53)
#1 C:\xampp\htdocs\vtmoption\api\debug.php(483): App\Services\WebSocketClient->connect()
#2 C:\xampp\htdocs\vtmoption\api\debug.php(115): testWebSocketConnection()
#3 {main}
[17-Nov-2025 12:45:44 UTC] [DEBUG.PHP] Error details: {
    "message": "Path cannot be empty",
    "type": "ValueError",
    "file": "C:\\xampp\\htdocs\\vtmoption\\app\\services\\WebSocketClient.php",
    "line": 235,
    "trace": [
        "#0 C:\\xampp\\htdocs\\vtmoption\\app\\services\\WebSocketClient.php(235): stream_socket_client('ssl:\/\/ws.derivw...', 0, '', 30, 4, Resource id #53)",
        "#1 C:\\xampp\\htdocs\\vtmoption\\api\\debug.php(483): App\\Services\\WebSocketClient->connect()",
        "#2 C:\\xampp\\htdocs\\vtmoption\\api\\debug.php(115): testWebSocketConnection()",
        "#3 {main}"
    ]
}
[17-Nov-2025 12:46:20 UTC] [testWebSocketConnection] Creating WebSocketClient with URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:46:20 UTC] [testWebSocketConnection] Calling connect()
[17-Nov-2025 12:46:20 UTC] [DEBUG.PHP] Fatal error: Path cannot be empty
[17-Nov-2025 12:46:20 UTC] [DEBUG.PHP] Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php(235): stream_socket_client('ssl://ws.derivw...', 0, '', 30, 4, Resource id #53)
#1 C:\xampp\htdocs\vtmoption\api\debug.php(483): App\Services\WebSocketClient->connect()
#2 C:\xampp\htdocs\vtmoption\api\debug.php(115): testWebSocketConnection()
#3 {main}
[17-Nov-2025 12:46:20 UTC] [DEBUG.PHP] Error details: {
    "message": "Path cannot be empty",
    "type": "ValueError",
    "file": "C:\\xampp\\htdocs\\vtmoption\\app\\services\\WebSocketClient.php",
    "line": 235,
    "trace": [
        "#0 C:\\xampp\\htdocs\\vtmoption\\app\\services\\WebSocketClient.php(235): stream_socket_client('ssl:\/\/ws.derivw...', 0, '', 30, 4, Resource id #53)",
        "#1 C:\\xampp\\htdocs\\vtmoption\\api\\debug.php(483): App\\Services\\WebSocketClient->connect()",
        "#2 C:\\xampp\\htdocs\\vtmoption\\api\\debug.php(115): testWebSocketConnection()",
        "#3 {main}"
    ]
}
[17-Nov-2025 12:50:52 UTC] [testWebSocketConnection] Creating WebSocketClient with URL: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 12:50:52 UTC] [testWebSocketConnection] Calling connect()
[17-Nov-2025 13:30:57 UTC] Starting Deriv API validation for user 2
[17-Nov-2025 13:30:57 UTC] API token length: 15
[17-Nov-2025 13:30:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:30:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:30:57 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:30:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:30:57 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:30:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:30:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:30:57 UTC] Calling authorize() to validate token
[17-Nov-2025 13:30:57 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:30:57 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:30:57 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:30:57 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:30:58 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:30:58 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:30:58 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:30:58 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:31:03 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:31:03 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:31:03 UTC] Authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:31:03 UTC] Deriv API validation completed successfully
[17-Nov-2025 13:37:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:37:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:37:16 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:37:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:37:16 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:37:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:37:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:37:16 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:37:16 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:37:16 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:37:16 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:37:16 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:37:16 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:37:16 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:37:16 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:37:16 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:37:18 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:37:18 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:37:18 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:37:18 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:37:50 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:38:24 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:38:24 UTC] Account endpoint failed, falling back to authorize: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:38:24 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:38:24 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:38:25 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:38:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:38:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:38:25 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:38:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:38:25 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:38:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:38:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:38:25 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:38:25 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:38:25 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:38:25 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:38:25 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:38:25 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:38:25 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:38:25 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:38:25 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:38:26 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:38:26 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:38:26 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:38:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:38:58 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:39:32 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:39:32 UTC] Account endpoint failed, falling back to authorize: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:39:32 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:39:32 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:39:33 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:39:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:39:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:39:33 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:39:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:39:33 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:39:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:39:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:39:33 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:39:33 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:39:33 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:39:33 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:39:33 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:39:33 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:39:33 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:39:33 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:39:33 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:39:34 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:39:34 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:39:34 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:39:35 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:39:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:39:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:39:41 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:39:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:39:41 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:39:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:39:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:39:41 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:39:41 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:39:41 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:39:41 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:39:41 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:39:41 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:39:41 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:39:41 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:39:41 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:39:41 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:39:42 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:39:42 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:39:42 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:40:07 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:40:14 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:40:41 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[17-Nov-2025 13:40:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:40:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:40:41 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:40:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:40:41 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:40:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:40:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:40:41 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:40:41 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:40:41 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:40:41 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:40:41 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:40:41 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:40:41 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:40:41 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:40:41 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:40:42 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:40:42 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:40:42 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:40:42 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:40:48 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:40:48 UTC] Account endpoint failed, falling back to authorize: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:40:48 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:40:48 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:40:49 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:41:14 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:41:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:41:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:41:42 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:41:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:41:42 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:41:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:41:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:41:42 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:41:42 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:41:42 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:41:42 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:41:42 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:41:42 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:41:42 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:41:42 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:41:42 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:41:43 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:41:43 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:41:43 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:41:44 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:41:48 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:41:48 UTC] Account endpoint failed, falling back to authorize: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:41:48 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:41:48 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:41:49 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:41:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:41:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:41:55 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:41:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:41:55 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:41:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:41:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:41:55 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:41:55 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:41:55 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:41:55 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:41:55 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:41:55 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:41:55 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:41:55 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:41:55 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:41:56 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:41:56 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:41:56 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:41:57 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:42:16 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:42:29 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:42:50 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:42:50 UTC] Account endpoint failed, falling back to authorize: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:42:50 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:42:50 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:42:50 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:42:50 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:42:50 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:42:50 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:42:50 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:42:50 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:42:50 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:42:50 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:42:50 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:42:50 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:42:50 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:42:50 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:42:50 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:42:50 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:42:50 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:42:50 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:42:51 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:42:52 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:42:52 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:42:52 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:42:52 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:43:04 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:43:04 UTC] Account endpoint failed, falling back to authorize: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:43:04 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:43:04 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:43:05 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:43:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:43:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:43:06 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:43:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:43:06 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:43:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:43:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:43:06 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:43:06 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:43:06 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:43:06 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:43:06 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:43:06 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:43:06 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:43:06 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:43:06 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:43:07 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:43:08 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:43:09 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:43:09 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:43:24 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:43:41 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:43:58 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:43:58 UTC] Account endpoint failed, falling back to authorize: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:43:58 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:43:58 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:43:59 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:43:59 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:43:59 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:43:59 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:43:59 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:43:59 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:43:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:43:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:43:59 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:43:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:43:59 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:43:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:43:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:43:59 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:43:59 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:43:59 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:43:59 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:43:59 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:43:59 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:43:59 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:43:59 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:43:59 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:44:00 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:44:00 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:44:00 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:44:00 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:44:00 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:44:00 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:44:00 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:44:00 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:44:15 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:44:15 UTC] Account endpoint failed, falling back to authorize: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:44:15 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:44:15 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:44:16 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:44:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:44:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:44:16 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:44:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:44:16 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:44:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:44:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:44:16 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:44:16 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:44:16 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:44:16 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:44:16 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:44:16 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:44:16 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:44:16 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:44:16 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:44:17 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:44:18 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:44:18 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:44:18 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:44:32 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:44:50 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:45:06 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:45:06 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:45:06 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:45:06 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:45:06 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:45:07 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:45:07 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:45:07 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:45:07 UTC] [TradingBotService::getAccountBalance] Closing DerivAPI connection
[17-Nov-2025 13:45:07 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:45:07 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:45:07 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:45:07 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:45:07 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:45:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:45:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:45:07 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:45:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:45:07 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:45:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:45:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:45:07 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:45:07 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:45:07 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:45:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:45:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:45:07 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:45:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:45:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:45:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:45:08 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:45:08 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:45:08 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:45:08 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:45:08 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:45:09 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:45:09 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:45:09 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:45:24 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[17-Nov-2025 13:45:24 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:45:24 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:45:24 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:45:24 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:45:24 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:45:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:45:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:45:24 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:45:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:45:24 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:45:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:45:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:45:24 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:45:24 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:45:24 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:45:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:45:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:45:24 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:45:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:45:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:45:25 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:45:25 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:45:25 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:45:25 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:45:25 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:45:25 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:45:26 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:45:26 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:45:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:45:41 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:45:58 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:46:15 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:46:15 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:46:15 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:46:15 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:46:15 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:46:15 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:46:15 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:46:15 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:46:15 UTC] [TradingBotService::getAccountBalance] Closing DerivAPI connection
[17-Nov-2025 13:46:15 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:46:15 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:46:15 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:46:15 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:46:16 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:46:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:46:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:46:16 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:46:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:46:16 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:46:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:46:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:46:16 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:46:16 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:46:16 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:46:16 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:46:16 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:46:16 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:46:16 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:46:16 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:46:16 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:46:16 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:46:16 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:46:16 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:46:16 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:46:16 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:46:17 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:46:17 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:46:17 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:46:32 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:46:32 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:46:32 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:46:32 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:46:32 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:46:32 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:46:32 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:46:32 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:46:32 UTC] [TradingBotService::getAccountBalance] Closing DerivAPI connection
[17-Nov-2025 13:46:33 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:46:33 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:46:33 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:46:33 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:46:33 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:46:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:46:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:46:33 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:46:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:46:33 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:46:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:46:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:46:33 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:46:33 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:46:33 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:46:33 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:46:33 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:46:33 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:46:33 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:46:33 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:46:33 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:46:33 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:46:33 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:46:33 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:46:33 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:46:33 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:46:34 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:46:34 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:46:34 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:46:49 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:47:06 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:47:23 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:47:23 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:47:23 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:47:23 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:47:23 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:47:23 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:47:23 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:47:23 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:47:23 UTC] [TradingBotService::getAccountBalance] Closing DerivAPI connection
[17-Nov-2025 13:47:24 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:47:24 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:47:24 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:47:24 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:47:24 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:47:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:47:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:47:24 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:47:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:47:24 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:47:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:47:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:47:24 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:47:24 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:47:24 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:47:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:47:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:47:24 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:47:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:47:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:47:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:47:24 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:47:24 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:47:24 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:47:24 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:47:24 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:47:25 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:47:25 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:47:25 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:47:40 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[17-Nov-2025 13:47:40 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:47:40 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:47:40 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:47:40 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:47:40 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:47:40 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:47:40 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:47:40 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:47:40 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:47:40 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:47:40 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:47:40 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:47:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:47:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:47:40 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:47:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:47:40 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:47:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:47:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:47:40 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:47:40 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:47:40 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:47:40 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:47:40 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:47:40 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:47:40 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:47:40 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:47:40 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:47:41 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:47:41 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:47:41 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:47:41 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:47:41 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:47:42 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:47:42 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:47:42 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:47:57 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:48:14 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:48:31 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:48:31 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:48:31 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:48:31 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:48:31 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:48:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:48:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:48:31 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:48:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:48:31 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:48:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:48:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:48:31 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:48:31 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:48:31 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:48:31 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:48:31 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:48:31 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:48:31 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:48:31 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:48:31 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:48:33 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:48:33 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:48:33 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:48:33 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:48:33 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:48:34 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:48:34 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:48:34 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:48:48 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:48:48 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:48:48 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:48:48 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:48:48 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:48:48 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:48:48 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:48:48 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:48:48 UTC] [TradingBotService::getAccountBalance] Closing DerivAPI connection
[17-Nov-2025 13:48:48 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:48:48 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:48:48 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:48:48 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:48:48 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:48:48 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:48:48 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:48:48 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:48:48 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:48:48 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:48:48 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:48:48 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:48:48 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:48:48 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:48:48 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:48:48 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:48:48 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:48:48 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:48:48 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:48:48 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:48:49 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:48:50 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:48:50 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:48:50 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:48:50 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:48:50 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:48:50 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:48:50 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:48:50 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:49:06 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:49:22 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:49:40 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:49:40 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:49:40 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:49:40 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:49:40 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:49:41 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:49:41 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:49:41 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:49:41 UTC] [TradingBotService::getAccountBalance] Closing DerivAPI connection
[17-Nov-2025 13:49:41 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:49:41 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:49:41 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:49:41 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:49:41 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:49:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:49:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:49:41 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:49:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:49:41 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:49:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:49:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:49:41 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:49:41 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:49:41 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:49:41 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:49:41 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:49:41 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:49:41 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:49:41 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:49:41 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:49:42 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:49:42 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:49:42 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:49:42 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:49:42 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:49:43 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:49:43 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:49:43 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:49:56 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:49:56 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:49:56 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:49:56 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:49:56 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:49:57 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:49:57 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:49:57 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:49:57 UTC] [TradingBotService::getAccountBalance] Closing DerivAPI connection
[17-Nov-2025 13:49:57 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:49:57 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:49:57 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:49:57 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:49:57 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:49:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:49:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:49:57 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:49:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:49:57 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:49:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:49:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:49:57 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:49:57 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:49:57 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:49:57 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:49:57 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:49:57 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:49:57 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:49:57 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:49:58 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:49:59 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:49:59 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:49:59 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:49:59 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:49:59 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:49:59 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:49:59 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:50:00 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:50:15 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:50:32 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:50:49 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:50:49 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:50:49 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:50:49 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:50:49 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:50:49 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:50:49 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:50:49 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:50:49 UTC] [TradingBotService::getAccountBalance] Closing DerivAPI connection
[17-Nov-2025 13:50:49 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:50:49 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:50:49 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:50:49 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:50:49 UTC] [TradingBotService::getAccountBalance] Creating DerivAPI instance
[17-Nov-2025 13:50:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:50:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:50:49 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:50:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:50:49 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:50:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:50:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:50:49 UTC] [TradingBotService::getAccountBalance] Calling DerivAPI->getBalance()
[17-Nov-2025 13:50:49 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:50:49 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:50:49 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:50:49 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:50:49 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:50:49 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:50:49 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:50:50 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:50:50 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:50:50 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:50:50 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:50:50 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:50:50 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:50:51 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:50:51 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:50:51 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:51:06 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:51:06 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:51:06 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:51:06 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:51:06 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:51:06 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:51:06 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:51:06 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:51:06 UTC] [TradingBotService::getAccountBalance] Closing DerivAPI connection
[17-Nov-2025 13:51:06 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:51:06 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:51:06 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:51:06 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:51:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:51:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:51:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:51:06 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:51:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:51:06 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:51:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:51:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:51:06 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 13:51:06 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 13:51:06 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 13:51:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:51:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:51:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:51:06 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:51:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:51:06 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:51:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:51:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:51:06 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:51:06 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:51:06 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:51:06 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:51:06 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:51:06 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:51:06 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:51:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:51:08 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:51:08 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:51:08 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:51:08 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:51:08 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:51:08 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:51:08 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:51:08 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:51:23 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:51:40 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:51:57 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[17-Nov-2025 13:51:57 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:51:58 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:51:58 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:51:58 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:51:58 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:51:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:51:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:51:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:51:58 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:51:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:51:58 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:51:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:51:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:51:58 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 13:51:58 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 13:51:58 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 13:51:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:51:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:51:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:51:58 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:51:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:51:58 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:51:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:51:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:51:58 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:51:58 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:51:58 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:51:58 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:51:58 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:51:58 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:51:58 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:51:58 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:51:59 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:51:59 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:51:59 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:51:59 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:51:59 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:51:59 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:51:59 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:51:59 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:52:14 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:52:14 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:52:14 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:52:14 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:52:14 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:52:15 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:52:15 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:52:15 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:52:16 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:52:16 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:52:16 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:52:16 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:52:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:52:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:52:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:52:16 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:52:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:52:16 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:52:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:52:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:52:16 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 13:52:16 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 13:52:16 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 13:52:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:52:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:52:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:52:16 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:52:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:52:16 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:52:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:52:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:52:16 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:52:16 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:52:16 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:52:16 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:52:16 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:52:16 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:52:16 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:52:16 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:52:17 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:52:17 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:52:17 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:52:17 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:52:17 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:52:17 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:52:17 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:52:17 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:52:31 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:52:49 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:53:05 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:53:05 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:53:05 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:53:05 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:53:05 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:53:06 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:53:06 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:53:06 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:53:06 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:53:06 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:53:06 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:53:06 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:53:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:53:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:53:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:53:06 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:53:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:53:06 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:53:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:53:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:53:06 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 13:53:06 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 13:53:06 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 13:53:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:53:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:53:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:53:06 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:53:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:53:06 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:53:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:53:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:53:06 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:53:06 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:53:06 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:53:06 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:53:06 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:53:06 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:53:06 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:53:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:53:08 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:53:08 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:53:08 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:53:08 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:53:08 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:53:08 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:53:08 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:53:08 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:53:23 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:53:23 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:53:23 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:53:23 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:53:23 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:53:24 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:53:24 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:53:24 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:53:24 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:53:24 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:53:24 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:53:24 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:53:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:53:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:53:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:53:24 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:53:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:53:24 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:53:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:53:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:53:25 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 13:53:25 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 13:53:25 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 13:53:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:53:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:53:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:53:25 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:53:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:53:25 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:53:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:53:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:53:25 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:53:25 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:53:25 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:53:25 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:53:25 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:53:25 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:53:25 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:53:25 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:53:26 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:53:26 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:53:26 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:53:26 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:53:26 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:53:26 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:53:26 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:53:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:53:40 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:53:58 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:14 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:54:14 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:54:14 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:54:14 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:54:14 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:54:14 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:54:14 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:54:14 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:54:14 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:54:14 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:54:14 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:54:14 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:54:14 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 13:54:14 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 13:54:14 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 13:54:14 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:54:14 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:54:14 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:54:14 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:54:14 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:54:14 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:54:14 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:54:14 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:54:14 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:54:14 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:54:14 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:54:14 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:54:14 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:54:14 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:54:14 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:54:14 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:54:15 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:54:15 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:54:15 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:54:15 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:54:15 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:54:16 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:54:16 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:54:16 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:54:32 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 13:54:32 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 13:54:32 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 13:54:32 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:54:32 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:54:33 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:54:33 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 13:54:33 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 13:54:33 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 13:54:33 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 13:54:33 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 13:54:33 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 13:54:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:54:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:54:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:54:33 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:54:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:54:33 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:54:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:54:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:54:33 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 13:54:33 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 13:54:33 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 13:54:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 13:54:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 13:54:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 13:54:33 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 13:54:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:54:33 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 13:54:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 13:54:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 13:54:33 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 13:54:33 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 13:54:33 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 13:54:33 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 13:54:33 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 13:54:33 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 13:54:33 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 13:54:33 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 13:54:34 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 13:54:34 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 13:54:34 UTC] Not authorized, calling authorize() first
[17-Nov-2025 13:54:34 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 13:54:34 UTC] Sending authorization request to Deriv API
[17-Nov-2025 13:54:34 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 13:54:34 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 13:54:34 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:54:48 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:55:06 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[17-Nov-2025 13:55:06 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:55:06 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:55:06 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:55:06 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:55:06 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:55:06 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:55:06 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 13:55:06 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:40:07 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 18:40:07 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 18:40:07 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 18:40:07 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 18:40:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:40:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:40:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:40:07 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:40:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:40:07 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:40:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:40:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:40:07 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 18:40:07 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 18:40:07 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 18:40:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:40:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:40:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:40:07 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:40:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:40:07 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:40:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:40:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:40:07 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 18:40:07 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 18:40:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 18:40:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:40:07 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 18:40:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 18:40:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 18:40:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 18:40:09 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 18:40:09 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 18:40:09 UTC] Not authorized, calling authorize() first
[17-Nov-2025 18:40:09 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 18:40:09 UTC] Sending authorization request to Deriv API
[17-Nov-2025 18:40:09 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 18:40:09 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 18:40:10 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 18:40:42 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 18:41:16 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 18:41:16 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 18:41:16 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 18:41:16 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 18:41:16 UTC] Sending authorization request to Deriv API
[17-Nov-2025 18:41:16 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 18:41:16 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 18:41:16 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 18:41:16 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 18:41:16 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 18:41:16 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 18:41:16 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 18:41:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:41:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:41:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:41:16 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:41:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:41:16 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:41:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:41:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:41:16 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 18:41:16 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 18:41:16 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 18:41:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:41:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:41:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:41:16 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:41:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:41:16 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:41:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:41:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:41:16 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 18:41:16 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 18:41:16 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 18:41:16 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:41:16 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 18:41:16 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 18:41:16 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 18:41:16 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 18:41:17 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 18:41:17 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 18:41:17 UTC] Not authorized, calling authorize() first
[17-Nov-2025 18:41:17 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 18:41:17 UTC] Sending authorization request to Deriv API
[17-Nov-2025 18:41:18 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 18:41:18 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 18:41:18 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 18:41:50 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 18:42:24 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 18:42:24 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 18:42:24 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 18:42:24 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 18:42:24 UTC] Sending authorization request to Deriv API
[17-Nov-2025 18:42:24 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 18:42:24 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 18:42:24 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 18:42:30 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 18:42:30 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 18:42:30 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 18:42:30 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 18:42:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:42:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:42:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:42:30 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:42:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:42:30 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:42:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:42:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:42:30 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 18:42:30 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 18:42:30 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 18:42:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:42:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:42:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:42:30 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:42:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:42:30 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:42:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:42:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:42:30 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 18:42:30 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 18:42:30 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 18:42:30 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:42:30 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 18:42:30 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 18:42:30 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 18:42:30 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 18:42:31 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 18:42:31 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 18:42:31 UTC] Not authorized, calling authorize() first
[17-Nov-2025 18:42:31 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 18:42:31 UTC] Sending authorization request to Deriv API
[17-Nov-2025 18:42:32 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 18:42:32 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 18:42:32 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 18:43:04 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 18:43:38 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 18:43:38 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 18:43:38 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 18:43:38 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 18:43:38 UTC] Sending authorization request to Deriv API
[17-Nov-2025 18:43:38 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 18:43:38 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 18:43:38 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 18:43:38 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 18:43:38 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 18:43:38 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 18:43:38 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 18:43:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:43:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:43:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:43:38 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:43:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:43:38 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:43:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:43:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:43:38 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 18:43:38 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 18:43:38 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 18:43:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:43:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:43:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:43:38 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:43:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:43:38 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:43:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:43:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:43:38 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 18:43:38 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 18:43:38 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 18:43:38 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:43:38 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 18:43:38 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 18:43:38 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 18:43:39 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 18:43:39 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 18:43:39 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 18:43:39 UTC] Not authorized, calling authorize() first
[17-Nov-2025 18:43:39 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 18:43:39 UTC] Sending authorization request to Deriv API
[17-Nov-2025 18:43:40 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 18:43:40 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 18:43:40 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 18:44:12 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 18:44:46 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 18:44:46 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 18:44:46 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 18:44:46 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 18:44:46 UTC] Sending authorization request to Deriv API
[17-Nov-2025 18:44:47 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 18:44:47 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 18:44:47 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 18:44:47 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 18:44:47 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 18:44:47 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 18:44:47 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 18:44:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:44:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:44:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:44:47 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:44:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:44:47 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:44:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:44:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:44:47 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 18:44:47 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 18:44:47 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 18:44:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 18:44:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 18:44:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 18:44:47 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 18:44:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:44:47 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 18:44:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 18:44:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 18:44:47 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 18:44:47 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 18:44:47 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 18:44:47 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 18:44:47 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 18:44:47 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 18:44:47 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 18:44:47 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 18:44:48 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 18:44:48 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 18:44:48 UTC] Not authorized, calling authorize() first
[17-Nov-2025 18:44:48 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 18:44:48 UTC] Sending authorization request to Deriv API
[17-Nov-2025 18:44:48 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 18:44:48 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 18:44:49 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 18:45:21 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 18:45:55 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[17-Nov-2025 23:50:22 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 23:50:22 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 23:50:22 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 23:50:22 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 23:50:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:50:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:50:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:50:22 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:50:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:50:22 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:50:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:50:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:50:22 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 23:50:22 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 23:50:22 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 23:50:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:50:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:50:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:50:22 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:50:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:50:22 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:50:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:50:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:50:22 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 23:50:22 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 23:50:22 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 23:50:22 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:50:22 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 23:50:22 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 23:50:22 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 23:50:22 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 23:50:24 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 23:50:24 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 23:50:24 UTC] Not authorized, calling authorize() first
[17-Nov-2025 23:50:24 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:50:24 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:50:24 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:50:24 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 23:50:24 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 23:50:56 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 23:51:30 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 23:51:30 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 23:51:30 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 23:51:30 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:51:30 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:51:31 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:51:31 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 23:51:31 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 23:51:31 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 23:51:31 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 23:51:31 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 23:51:31 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 23:51:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:51:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:51:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:51:31 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:51:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:51:31 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:51:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:51:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:51:31 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 23:51:31 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 23:51:31 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 23:51:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:51:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:51:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:51:31 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:51:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:51:31 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:51:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:51:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:51:31 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 23:51:31 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 23:51:31 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 23:51:31 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:51:31 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 23:51:31 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 23:51:31 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 23:51:31 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 23:51:32 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 23:51:32 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 23:51:32 UTC] Not authorized, calling authorize() first
[17-Nov-2025 23:51:32 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:51:32 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:51:32 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:51:32 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 23:51:32 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 23:52:04 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 23:52:38 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 23:52:38 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 23:52:38 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 23:52:38 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:52:38 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:52:39 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:52:39 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 23:52:39 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 23:52:39 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 23:52:39 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 23:52:39 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 23:52:39 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 23:52:39 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:52:39 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:52:39 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:52:39 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:52:39 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:52:39 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:52:39 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:52:39 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:52:39 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 23:52:39 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 23:52:39 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 23:52:39 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:52:39 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:52:39 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:52:39 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:52:39 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:52:39 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:52:39 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:52:39 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:52:39 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 23:52:39 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 23:52:39 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 23:52:39 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:52:39 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 23:52:39 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 23:52:39 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 23:52:39 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 23:52:40 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 23:52:40 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 23:52:40 UTC] Not authorized, calling authorize() first
[17-Nov-2025 23:52:40 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:52:40 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:52:40 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:52:40 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 23:52:40 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 23:53:12 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 23:53:46 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 23:53:46 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 23:53:46 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 23:53:46 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:53:46 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:53:47 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:53:47 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 23:53:47 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 23:53:47 UTC] [TradingBotService::getAccountBalance] Starting for user 2
[17-Nov-2025 23:53:47 UTC] [TradingBotService::getAccountBalance] User query result: found
[17-Nov-2025 23:53:47 UTC] [TradingBotService::getAccountBalance] Encrypted token length: 96
[17-Nov-2025 23:53:47 UTC] [TradingBotService::getAccountBalance] Token decrypted successfully, length: 15
[17-Nov-2025 23:53:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:53:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:53:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:53:47 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:53:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:53:47 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:53:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:53:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:53:47 UTC] [TradingBotService::getAccountBalance] Attempt 1/3
[17-Nov-2025 23:53:47 UTC] [TradingBotService::getAccountBalance] Connection not healthy, recreating
[17-Nov-2025 23:53:47 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 23:53:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:53:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:53:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:53:47 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:53:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:53:47 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:53:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:53:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:53:47 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 23:53:47 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 23:53:47 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 23:53:47 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:53:47 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 23:53:47 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 23:53:47 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 23:53:47 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 23:53:48 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 23:53:48 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 23:53:48 UTC] Not authorized, calling authorize() first
[17-Nov-2025 23:53:48 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:53:48 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:53:48 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:53:48 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 23:53:48 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 23:54:20 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 23:54:54 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 23:54:54 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 23:54:54 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 23:54:54 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:54:54 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:54:55 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:54:55 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 23:54:55 UTC] [TradingBotService::getAccountBalance] Balance retrieved: 108.88
[17-Nov-2025 23:54:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:54:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:54:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:54:55 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:54:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:54:55 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:54:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:54:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:54:55 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 23:54:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:54:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:54:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:54:55 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:54:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:54:55 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:54:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:54:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:54:55 UTC] [DerivAPI::getBalance] Starting getBalance()
[17-Nov-2025 23:54:55 UTC] [DerivAPI::getBalance] No cached balance, fetching from API
[17-Nov-2025 23:54:55 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 23:54:55 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:54:55 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 23:54:55 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 23:54:55 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 23:54:55 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 23:54:56 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 23:54:56 UTC] [DerivAPI::getBalance] Trying account endpoint
[17-Nov-2025 23:54:56 UTC] Not authorized, calling authorize() first
[17-Nov-2025 23:54:56 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:54:56 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:54:56 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:54:56 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 23:54:56 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 23:55:28 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 23:56:02 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 23:56:02 UTC] [DerivAPI::getBalance] Account endpoint failed: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
[17-Nov-2025 23:56:02 UTC] [DerivAPI::getBalance] Falling back to authorize()
[17-Nov-2025 23:56:02 UTC] Attempting to authorize Deriv API token (length: 15)
[17-Nov-2025 23:56:02 UTC] Sending authorization request to Deriv API
[17-Nov-2025 23:56:03 UTC] Deriv API authorization successful. LoginID: VRTC1155676
[17-Nov-2025 23:56:03 UTC] [DerivAPI::getBalance] Balance from authorize(): 108.88
[17-Nov-2025 23:56:03 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-17 23:54:55
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[17-Nov-2025 23:56:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:56:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:56:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:56:03 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:56:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:56:03 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:56:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:56:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:56:03 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 23:56:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:56:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:56:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:56:03 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:56:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:56:03 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:56:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:56:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:56:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 23:56:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:56:03 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 23:56:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 23:56:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 23:56:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 23:56:04 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 23:56:04 UTC] Not authorized, calling authorize() first
[17-Nov-2025 23:56:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-17 23:56:04
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[17-Nov-2025 23:56:04 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 23:56:05 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 23:56:37 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 23:57:11 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 23:57:11 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-17 23:57:11
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[17-Nov-2025 23:57:11 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-17 23:56:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[17-Nov-2025 23:57:11 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-17 23:56:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[17-Nov-2025 23:57:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:57:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:57:11 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:57:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:57:11 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:57:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:57:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:57:11 UTC] Fatal error in api/debug-balance.php: Call to private method App\Services\DerivAPI::ensureConnection() from global scope
[17-Nov-2025 23:57:11 UTC] Stack trace: #0 {main}
[17-Nov-2025 23:57:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:57:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:57:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:57:11 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:57:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:57:11 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:57:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:57:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:57:11 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 23:57:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:57:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:57:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:57:11 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:57:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:57:11 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:57:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:57:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:57:11 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 23:57:11 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:57:11 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 23:57:11 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 23:57:11 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 23:57:11 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 23:57:12 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 23:57:12 UTC] Not authorized, calling authorize() first
[17-Nov-2025 23:57:12 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-17 23:57:12
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[17-Nov-2025 23:57:12 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 23:57:13 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 23:57:45 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 23:58:19 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 23:58:19 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-17 23:58:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[17-Nov-2025 23:58:19 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-17 23:57:11
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[17-Nov-2025 23:58:19 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-17 23:57:11
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[17-Nov-2025 23:58:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:58:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:58:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:58:19 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:58:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:58:19 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:58:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:58:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:58:19 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 23:58:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:58:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:58:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:58:19 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:58:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:58:19 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:58:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:58:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:58:19 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 23:58:19 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:58:19 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 23:58:19 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 23:58:19 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 23:58:19 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 23:58:20 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 23:58:20 UTC] Not authorized, calling authorize() first
[17-Nov-2025 23:58:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-17 23:58:20
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[17-Nov-2025 23:58:21 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 23:58:21 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[17-Nov-2025 23:58:53 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[17-Nov-2025 23:59:27 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[17-Nov-2025 23:59:27 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-17 23:59:27
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[17-Nov-2025 23:59:27 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-17 23:58:19
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[17-Nov-2025 23:59:27 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-17 23:58:19
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[17-Nov-2025 23:59:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:59:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:59:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:59:27 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:59:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:59:27 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:59:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:59:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:59:27 UTC] [TradingBotService] Closing connection for user 2
[17-Nov-2025 23:59:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[17-Nov-2025 23:59:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[17-Nov-2025 23:59:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[17-Nov-2025 23:59:27 UTC] [DerivAPI] appId: '105326'
[17-Nov-2025 23:59:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:59:27 UTC] [DerivAPI] wsUrl length: 48
[17-Nov-2025 23:59:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[17-Nov-2025 23:59:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[17-Nov-2025 23:59:27 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[17-Nov-2025 23:59:27 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[17-Nov-2025 23:59:27 UTC] [DerivAPI::ensureConnection] URL type: string
[17-Nov-2025 23:59:27 UTC] [DerivAPI::ensureConnection] URL length: 48
[17-Nov-2025 23:59:27 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[17-Nov-2025 23:59:27 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[17-Nov-2025 23:59:28 UTC] WebSocket connection established to Deriv API
[17-Nov-2025 23:59:28 UTC] Not authorized, calling authorize() first
[17-Nov-2025 23:59:29 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-17 23:59:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[17-Nov-2025 23:59:29 UTC] Sending WebSocket request: account (req_id: 1)
[17-Nov-2025 23:59:29 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:00:01 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:00:35 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:00:35 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:00:35
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:00:35 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-17 23:59:27
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:00:35 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-17 23:59:27
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:00:35 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:00:35 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:00:35 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:00:35 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:00:35 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:00:35 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:00:35 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:00:35 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:00:35 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:00:35 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:00:35 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:00:35 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:00:35 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:00:35 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:00:35 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:00:35 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:00:35 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:00:35 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:00:35 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:00:35 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:00:35 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:00:35 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:00:35 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:00:36 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:00:36 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:00:37 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:00:36
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:00:37 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:00:37 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:01:09 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:01:43 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:01:43 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:01:43
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:01:43 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:00:35
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:01:43 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:00:35
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:01:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:01:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:01:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:01:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:01:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:01:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:01:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:01:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:01:43 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:01:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:01:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:01:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:01:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:01:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:01:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:01:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:01:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:01:43 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:01:43 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:01:43 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:01:43 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:01:43 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:01:43 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:01:44 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:01:44 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:01:45 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:01:44
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:01:45 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:01:45 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:02:17 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:02:51 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:02:52 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:02:51
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:02:52 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:01:43
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:02:52 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:01:43
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:02:52 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:02:52 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:02:52 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:02:52 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:02:52 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:02:52 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:02:52 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:02:52 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:02:52 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:02:52 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:02:52 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:02:52 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:02:52 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:02:52 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:02:52 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:02:52 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:02:52 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:02:52 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:02:52 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:02:52 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:02:52 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:02:52 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:02:52 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:02:52 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:02:52 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:02:53 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:02:53
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:02:53 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:02:53 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:03:25 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:03:59 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:04:00 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:03:59
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:04:00 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:02:52
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:04:00 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:02:52
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:04:00 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:04:00 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:04:00 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:04:00 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:04:00 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:04:00 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:04:00 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:04:00 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:04:00 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:04:00 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:04:00 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:04:00 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:04:00 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:04:01 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:04:01 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:04:00
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:04:01 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:04:01
Step 1: Checking cached auth data
  - Using cached balance: 108.88
=== DerivAPI::getBalance SUCCESS (cached) ===
[18-Nov-2025 00:04:01 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:04:01 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:04:01 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:04:01 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:04:01 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:04:01 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:04:01 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:04:01 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:04:01 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:04:01 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:04:01 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:04:01 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:04:01 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:04:01 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:04:01 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:04:01 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:04:01 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:04:01 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:04:01 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:04:01 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:04:01 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:04:01 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:04:01 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:04:02 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:04:02 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:04:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:04:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:04:02 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:04:02 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:04:35 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:05:09 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[18-Nov-2025 00:05:09 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:05:09 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:05:09 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:05:09 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:05:09 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:05:09 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:05:09 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:05:09 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:05:09 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:05:09 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:05:09 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:05:09 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:05:09 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:05:09 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:05:09 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:05:09 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:05:09 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:05:09 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:05:09 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:05:09 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:05:09 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:05:09 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:05:09 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:05:09 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:05:09 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:05:09 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:05:09 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:05:10 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:05:10 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:05:10 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:05:10
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:05:10 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:05:11 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:05:43 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:06:17 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:06:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:06:17
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:06:17 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:05:09
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:06:17 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:05:09
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:06:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:06:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:06:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:06:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:06:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:06:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:06:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:06:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:06:17 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:06:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:06:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:06:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:06:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:06:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:06:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:06:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:06:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:06:17 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:06:17 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:06:17 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:06:17 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:06:17 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:06:17 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:06:18 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:06:18 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:06:18 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:06:18
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:06:18 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:06:19 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:06:51 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:07:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[18-Nov-2025 00:07:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:07:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:07:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:07:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:07:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:07:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:07:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:07:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:07:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:07:25 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:07:25 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:07:25 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:07:25 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:07:25 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:07:25 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:07:26 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:07:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:07:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:07:26 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:07:26
Step 1: Checking cached auth data
  - Using cached balance: 108.88
=== DerivAPI::getBalance SUCCESS (cached) ===
[18-Nov-2025 00:07:26 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:07:26 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:07:26 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:07:26 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:07:26 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:07:26 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:07:26 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:07:26 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:07:26 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:07:26 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:07:26 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:07:26 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:07:26 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:07:26 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:07:26 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:07:26 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:07:26 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:07:26 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:07:26 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:07:26 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:07:26 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:07:26 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:07:26 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:07:27 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:07:27 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:07:27 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:07:27
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:07:27 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:07:28 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:08:00 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:08:34 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[18-Nov-2025 00:08:34 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:08:34 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:08:34 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:08:34 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:08:34 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:08:34 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:08:34 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:08:34 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:08:34 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:08:34 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:08:34 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:08:34 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:08:34 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:08:34 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:08:34 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:08:35 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:08:35 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:08:34
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:08:35 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:08:35
Step 1: Checking cached auth data
  - Using cached balance: 108.88
=== DerivAPI::getBalance SUCCESS (cached) ===
[18-Nov-2025 00:08:35 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:08:35 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:08:35 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:08:35 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:08:35 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:08:35 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:08:35 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:08:35 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:08:35 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:08:35 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:08:35 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:08:35 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:08:35 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:08:35 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:08:35 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:08:35 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:08:35 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:08:35 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:08:35 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:08:35 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:08:35 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:08:35 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:08:35 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:08:36 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:08:36 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:08:36 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:08:36
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:08:36 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:08:37 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:09:09 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:09:43 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 406
[18-Nov-2025 00:09:43 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:09:43 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:09:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:09:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:09:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:09:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:09:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:09:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:09:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:09:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:09:43 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:09:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:09:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:09:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:09:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:09:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:09:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:09:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:09:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:09:43 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:09:43 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:09:43 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:09:43 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:09:43 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:09:43 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:09:44 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:09:44 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:09:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:09:44
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:09:44 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:09:44 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:10:16 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:10:50 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:10:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:10:50
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:10:51 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:09:43
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:10:51 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:09:43
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:10:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:10:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:10:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:10:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:10:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:10:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:10:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:10:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:10:57 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:10:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:10:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:10:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:10:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:10:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:10:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:10:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:10:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:10:57 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:10:57 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:10:57 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:10:57 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:10:57 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:10:57 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:10:58 UTC] WebSocket connection established to Deriv API
[18-Nov-2025 00:10:58 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:10:58 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:10:58
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:10:58 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:10:58 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:11:30 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:12:04 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:12:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:12:04
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:12:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:10:57
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(459): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:12:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:10:57
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:12:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:12:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:12:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:12:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:12:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:12:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:12:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:12:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:12:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:12:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:12:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:12:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:12:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:12:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:12:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:12:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:12:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:12:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:12:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:12:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:12:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:12:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:12:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:12:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:12:06 UTC] WebSocket connection established to Deriv API in 1396.48ms
[18-Nov-2025 00:12:06 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:12:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:12:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:12:06 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:12:07 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:12:24 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:12:43 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:12:43 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:12:43
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:12:43 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:12:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:12:43 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:12:05
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:12:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:12:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:12:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:12:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:12:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:12:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:12:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:12:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:12:43 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:12:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:12:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:12:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:12:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:12:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:12:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:12:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:12:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:12:43 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:12:43 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:12:43 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:12:43 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:12:43 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:12:43 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:12:43 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:12:45 UTC] WebSocket connection established to Deriv API in 1229.44ms
[18-Nov-2025 00:12:45 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:12:45 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:12:45
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:12:45 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:12:45 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:13:02 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:13:21 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:13:22 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:13:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:13:22 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:12:43
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:13:22 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:12:43
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:13:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:13:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:13:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:13:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:13:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:13:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:13:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:13:22 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:13:22 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:13:22 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:13:22 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:13:22 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:13:22 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:13:22 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:13:23 UTC] WebSocket connection established to Deriv API in 1168.43ms
[18-Nov-2025 00:13:23 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:13:22
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:13:23 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:13:23
Step 1: Checking cached auth data
  - Using cached balance: 108.88
=== DerivAPI::getBalance SUCCESS (cached) ===
[18-Nov-2025 00:13:23 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:13:23 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:13:23 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:13:23 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:13:23 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:13:23 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:13:23 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:13:23 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:13:23 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:13:23 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:13:23 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:13:23 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:13:23 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:13:23 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:13:23 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:13:23 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:13:23 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:13:23 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:13:23 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:13:23 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:13:23 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:13:23 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:13:23 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:13:23 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:13:25 UTC] WebSocket connection established to Deriv API in 1105.02ms
[18-Nov-2025 00:13:25 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:13:25 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:13:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:13:25 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:13:25 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:13:42 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:14:01 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:14:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:14:01
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:14:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:13:23
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\debug-balance.php(261): App\Services\TradingBotService->getAccountBalance(2)
#3 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:14:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:13:23
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:14:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:14:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:14:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:14:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:14:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:14:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:14:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:14:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:14:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:14:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:14:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:14:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:14:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:14:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:14:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:14:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:14:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:14:02 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:14:02 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:14:02 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:14:02 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:14:02 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:14:02 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:14:02 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:14:03 UTC] WebSocket connection established to Deriv API in 1105.14ms
[18-Nov-2025 00:14:03 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:14:03 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:14:03
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:14:03 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:14:04 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:14:21 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:14:40 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:14:40 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:14:40
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:14:40 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:14:02
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:14:40 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:14:02
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:14:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:14:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:14:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:14:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:14:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:14:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:14:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:14:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:14:40 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:14:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:14:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:14:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:14:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:14:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:14:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:14:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:14:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:14:40 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:14:40 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:14:40 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:14:40 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:14:40 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:14:40 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:14:40 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:14:41 UTC] WebSocket connection established to Deriv API in 1072.46ms
[18-Nov-2025 00:14:41 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:14:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:14:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:14:42 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:14:42 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:14:59 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:15:18 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:15:18 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:15:18
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:15:18 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:14:40
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:15:18 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:14:40
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:15:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:15:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:15:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:15:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:15:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:15:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:15:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:15:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:15:19 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:15:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:15:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:15:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:15:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:15:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:15:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:15:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:15:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:15:19 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:15:19 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:15:19 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:15:19 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:15:19 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:15:19 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:15:19 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:15:21 UTC] WebSocket connection established to Deriv API in 2150.79ms
[18-Nov-2025 00:15:21 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:15:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:15:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:15:21 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:15:22 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:15:39 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:15:58 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:15:58 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:15:58
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:15:58 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:15:19
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:15:58 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:15:19
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:15:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:15:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:15:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:15:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:15:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:15:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:15:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:15:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:15:58 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:15:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:15:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:15:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:15:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:15:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:15:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:15:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:15:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:15:58 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:15:58 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:15:58 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:15:58 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:15:58 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:15:58 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:15:58 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:15:59 UTC] WebSocket connection established to Deriv API in 1117.5ms
[18-Nov-2025 00:15:59 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:16:00 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:15:59
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:16:00 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:16:00 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:16:17 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:16:36 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:16:36 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:16:36
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:16:36 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:15:58
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:16:36 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:15:58
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:16:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:16:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:16:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:16:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:16:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:16:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:16:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:16:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:16:37 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:16:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:16:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:16:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:16:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:16:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:16:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:16:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:16:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:16:37 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:16:37 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:16:37 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:16:37 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:16:37 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:16:37 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:16:37 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:16:38 UTC] WebSocket connection established to Deriv API in 1104.58ms
[18-Nov-2025 00:16:38 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:16:38 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:16:38
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:16:38 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:16:38 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:16:55 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:17:14 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:17:15 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:17:14
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:17:15 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:16:37
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:17:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:16:37
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:17:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:17:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:17:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:17:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:17:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:17:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:17:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:17:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:17:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:17:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:17:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:17:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:17:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:17:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:17:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:17:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:17:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:17:15 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:17:15 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:17:15 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:17:15 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:17:15 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:17:15 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:17:15 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:17:16 UTC] WebSocket connection established to Deriv API in 1089.39ms
[18-Nov-2025 00:17:16 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:17:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:17:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:17:17 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:17:17 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:17:34 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:17:53 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:17:54 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:17:53
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:17:54 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:17:15
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:17:54 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:17:15
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:17:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:17:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:17:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:17:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:17:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:17:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:17:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:17:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:17:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:17:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:17:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:17:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:17:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:17:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:17:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:17:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:17:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:17:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:17:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:17:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:17:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:17:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:17:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:17:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:17:55 UTC] WebSocket connection established to Deriv API in 1280.19ms
[18-Nov-2025 00:17:55 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:17:56 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:17:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:17:56 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:17:56 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:18:13 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:18:32 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:18:33 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:18:32
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:18:33 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:17:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:18:33 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:17:54
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:18:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:18:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:18:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:18:33 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:18:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:18:33 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:18:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:18:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:18:33 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:18:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:18:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:18:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:18:33 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:18:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:18:33 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:18:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:18:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:18:33 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:18:33 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:18:33 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:18:33 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:18:33 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:18:33 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:18:33 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:18:34 UTC] WebSocket connection established to Deriv API in 1105.39ms
[18-Nov-2025 00:18:34 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:18:34 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:18:34
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:18:34 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:18:34 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:18:51 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:19:10 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:19:11 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:19:10
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:19:11 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:18:33
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:19:11 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:18:33
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:19:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:19:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:19:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:19:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:19:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:19:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:19:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:19:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:19:11 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:19:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:19:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:19:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:19:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:19:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:19:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:19:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:19:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:19:11 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:19:11 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:19:11 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:19:11 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:19:11 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:19:11 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:19:11 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:19:12 UTC] WebSocket connection established to Deriv API in 1082.06ms
[18-Nov-2025 00:19:12 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:19:13 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:19:12
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:19:13 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:19:13 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:19:30 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:19:49 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:19:50 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:19:49
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:19:50 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:19:11
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:19:50 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:19:11
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:19:50 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:19:50 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:19:50 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:19:50 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:19:50 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:19:50 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:19:50 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:19:50 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:19:50 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:19:50 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:19:50 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:19:50 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:19:50 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:19:50 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:19:50 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:19:50 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:19:50 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:19:50 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:19:50 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:19:50 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:19:50 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:19:50 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:19:50 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:19:50 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:19:51 UTC] WebSocket connection established to Deriv API in 1089.96ms
[18-Nov-2025 00:19:51 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:19:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:19:51
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:19:51 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:19:52 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:20:09 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:20:28 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:20:28 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:20:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:20:28 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:19:50
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:20:28 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:19:50
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:20:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:20:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:20:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:20:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:20:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:20:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:20:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:20:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:20:28 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:20:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:20:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:20:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:20:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:20:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:20:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:20:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:20:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:20:28 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:20:28 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:20:28 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:20:28 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:20:28 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:20:28 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:20:28 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:20:29 UTC] WebSocket connection established to Deriv API in 1089.94ms
[18-Nov-2025 00:20:29 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:20:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:20:29
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:20:30 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:20:30 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:20:47 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:21:06 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:21:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:21:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:21:06 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:20:28
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:21:06 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:20:28
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:21:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:21:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:21:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:21:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:21:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:21:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:21:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:21:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:21:07 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:21:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:21:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:21:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:21:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:21:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:21:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:21:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:21:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:21:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:21:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:21:07 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:21:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:21:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:21:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:21:07 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:21:08 UTC] WebSocket connection established to Deriv API in 1112.12ms
[18-Nov-2025 00:21:08 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:21:08 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:21:08
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:21:08 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:21:08 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:21:25 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:21:44 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:21:45 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:21:44
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:21:45 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:21:07
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:21:45 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:21:07
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:21:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:21:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:21:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:21:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:21:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:21:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:21:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:21:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:21:45 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:21:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:21:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:21:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:21:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:21:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:21:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:21:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:21:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:21:45 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:21:45 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:21:45 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:21:45 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:21:45 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:21:45 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:21:45 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:21:46 UTC] WebSocket connection established to Deriv API in 1100.18ms
[18-Nov-2025 00:21:46 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:21:46 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:21:46
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:21:46 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:21:47 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:22:04 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:22:23 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:22:23 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:22:23
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:22:23 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:21:45
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:22:23 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:21:45
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:22:23 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:22:23 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:22:23 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:22:23 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:22:23 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:22:23 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:22:23 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:22:23 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:22:23 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:22:23 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:22:23 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:22:23 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:22:23 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:22:23 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:22:23 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:22:23 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:22:23 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:22:23 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:22:23 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:22:23 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:22:23 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:22:23 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:22:23 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:22:23 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:22:24 UTC] WebSocket connection established to Deriv API in 1062.61ms
[18-Nov-2025 00:22:24 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:22:25 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:22:24
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:22:25 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:22:25 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:22:42 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:23:01 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:23:01 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:23:01
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:23:01 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:22:23
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:23:01 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:22:23
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:23:01 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:23:01 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:23:01 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:23:01 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:23:01 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:23:01 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:23:01 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:23:01 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:23:01 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:23:01 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:23:01 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:23:01 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:23:01 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:23:01 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:23:01 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:23:01 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:23:01 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:23:01 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:23:01 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:23:01 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:23:01 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:23:01 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:23:01 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:23:01 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:23:03 UTC] WebSocket connection established to Deriv API in 1225.64ms
[18-Nov-2025 00:23:03 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:23:03 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:23:03
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:23:03 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:23:03 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:23:20 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:23:39 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:23:40 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:23:39
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:23:40 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:23:01
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:23:40 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:23:01
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:23:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:23:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:23:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:23:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:23:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:23:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:23:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:23:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:23:40 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:23:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:23:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:23:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:23:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:23:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:23:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:23:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:23:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:23:40 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:23:40 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:23:40 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:23:40 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:23:40 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:23:40 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:23:40 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:23:41 UTC] WebSocket connection established to Deriv API in 1216.69ms
[18-Nov-2025 00:23:41 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:23:41 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:23:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:23:41 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:23:42 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:23:59 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 528
[18-Nov-2025 00:23:59 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:24:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:24:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:24:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:24:16 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:24:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:24:16 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:24:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:24:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:24:16 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:24:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:24:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:24:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:24:16 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:24:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:24:16 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:24:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:24:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:24:16 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:24:16 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:24:16 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:24:16 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:24:16 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:24:16 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:24:16 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:24:17 UTC] WebSocket connection established to Deriv API in 1083.76ms
[18-Nov-2025 00:24:17 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:24:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:24:17
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:24:17 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:24:17 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:24:34 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:24:53 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:24:54 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:24:53
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:24:54 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:24:16
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:24:54 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:24:16
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:24:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:24:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:24:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:24:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:24:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:24:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:24:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:24:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:24:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:24:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:24:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:24:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:24:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:24:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:24:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:24:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:24:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:24:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:24:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:24:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:24:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:24:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:24:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:24:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:24:55 UTC] WebSocket connection established to Deriv API in 1126.48ms
[18-Nov-2025 00:24:55 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:24:56 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:24:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:24:56 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:24:56 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:25:13 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:25:32 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:25:32 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:25:32
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:25:32 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:24:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:25:32 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:24:54
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:25:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:25:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:25:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:25:33 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:25:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:25:33 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:25:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:25:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:25:33 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:25:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:25:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:25:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:25:33 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:25:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:25:33 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:25:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:25:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:25:33 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:25:33 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:25:33 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:25:33 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:25:33 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:25:33 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:25:33 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:25:34 UTC] WebSocket connection established to Deriv API in 1097.64ms
[18-Nov-2025 00:25:34 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:25:34 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:25:34
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:25:34 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:25:34 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:25:51 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:26:10 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:26:11 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:26:10
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:26:11 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:25:33
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:26:11 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:25:33
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:26:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:26:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:26:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:26:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:26:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:26:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:26:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:26:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:26:11 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:26:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:26:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:26:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:26:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:26:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:26:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:26:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:26:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:26:11 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:26:11 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:26:11 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:26:11 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:26:11 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:26:11 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:26:11 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:26:12 UTC] WebSocket connection established to Deriv API in 1093.49ms
[18-Nov-2025 00:26:12 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:26:12 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:26:12
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:26:12 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:26:13 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:26:30 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:26:49 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:26:49 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:26:49
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:26:49 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:26:11
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:26:49 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:26:11
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:26:49 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:26:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:26:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:26:49 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:26:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:26:49 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:26:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:26:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:26:49 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:26:49 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:26:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:26:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:26:49 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:26:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:26:49 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:26:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:26:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:26:49 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:26:49 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:26:49 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:26:49 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:26:49 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:26:49 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:26:49 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:26:50 UTC] WebSocket connection established to Deriv API in 1082.22ms
[18-Nov-2025 00:26:50 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:26:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:26:50
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:26:51 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:26:51 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:27:08 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:27:27 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:27:27 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:27:27
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:27:27 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:26:49
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:27:27 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:26:49
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:27:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:27:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:27:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:27:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:27:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:27:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:27:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:27:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:27:27 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:27:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:27:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:27:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:27:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:27:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:27:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:27:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:27:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:27:27 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:27:27 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:27:27 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:27:27 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:27:27 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:27:28 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:27:28 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:27:29 UTC] WebSocket connection established to Deriv API in 1104.58ms
[18-Nov-2025 00:27:29 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:27:29 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:27:29
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:27:29 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:27:29 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:27:46 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:28:05 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:28:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:28:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:28:06 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:27:28
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:28:06 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:27:27
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:28:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:28:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:28:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:28:06 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:28:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:28:06 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:28:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:28:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:28:06 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:28:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:28:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:28:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:28:06 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:28:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:28:06 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:28:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:28:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:28:06 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:28:06 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:28:06 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:28:06 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:28:06 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:28:06 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:28:06 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:28:07 UTC] WebSocket connection established to Deriv API in 1197.31ms
[18-Nov-2025 00:28:07 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:28:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:28:07
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:28:07 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:28:08 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:28:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 528
[18-Nov-2025 00:28:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:28:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:28:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:28:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:28:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:28:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:28:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:28:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:28:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:28:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:28:25 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:28:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:28:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:28:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:28:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:28:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:28:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:28:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:28:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:28:25 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:28:25 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:28:25 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:28:25 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:28:25 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:28:25 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:28:25 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:28:26 UTC] WebSocket connection established to Deriv API in 1094.56ms
[18-Nov-2025 00:28:26 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:28:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:28:26
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:28:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:28:27 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:28:44 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:29:03 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:29:03 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:29:03
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:29:03 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:28:25
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:29:03 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:28:25
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:29:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:29:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:29:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:29:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:29:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:29:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:29:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:29:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:29:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:29:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:29:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:29:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:29:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:29:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:29:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:29:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:29:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:29:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:29:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:29:03 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:29:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:29:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:29:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:29:03 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:29:05 UTC] WebSocket connection established to Deriv API in 1142.48ms
[18-Nov-2025 00:29:05 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:29:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:29:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:29:05 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:29:05 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:29:22 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:29:41 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:29:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:29:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:29:42 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:29:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:29:42 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:29:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:29:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:29:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:29:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:29:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:29:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:29:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:29:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:29:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:29:42 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:29:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:29:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:29:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:29:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:29:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:29:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:29:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:29:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:29:42 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:29:42 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:29:42 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:29:42 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:29:42 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:29:42 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:29:42 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:29:43 UTC] WebSocket connection established to Deriv API in 1169.81ms
[18-Nov-2025 00:29:43 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:29:43 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:29:43
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:29:43 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:29:44 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:30:01 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:30:20 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:30:20 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:30:20
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:30:20 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:29:42
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:30:20 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:29:42
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:30:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:30:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:30:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:30:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:30:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:30:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:30:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:30:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:30:20 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:30:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:30:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:30:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:30:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:30:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:30:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:30:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:30:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:30:20 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:30:20 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:30:20 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:30:20 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:30:20 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:30:20 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:30:20 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:30:21 UTC] WebSocket connection established to Deriv API in 1098.22ms
[18-Nov-2025 00:30:21 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:30:22 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:30:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:30:22 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:30:22 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:30:39 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:30:58 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:30:58 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:30:58
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:30:58 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:30:20
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:30:58 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:30:20
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:30:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:30:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:30:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:30:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:30:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:30:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:30:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:30:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:30:58 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:30:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:30:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:30:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:30:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:30:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:30:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:30:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:30:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:30:58 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:30:58 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:30:58 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:30:58 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:30:58 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:30:58 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:30:58 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:31:00 UTC] WebSocket connection established to Deriv API in 1081.4ms
[18-Nov-2025 00:31:00 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:31:00 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:31:00
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:31:00 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:31:00 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:31:17 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:31:36 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:31:37 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:31:36
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:31:37 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:30:58
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:31:37 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:30:58
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:31:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:31:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:31:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:31:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:31:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:31:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:31:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:31:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:31:37 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:31:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:31:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:31:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:31:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:31:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:31:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:31:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:31:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:31:37 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:31:37 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:31:37 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:31:37 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:31:37 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:31:37 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:31:37 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:31:38 UTC] WebSocket connection established to Deriv API in 1125.46ms
[18-Nov-2025 00:31:38 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:31:38 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:31:38
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:31:38 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:31:39 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:31:56 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:32:15 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:32:15 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:32:15
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:32:15 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:31:37
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:32:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:31:37
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:32:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:32:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:32:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:32:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:32:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:32:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:32:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:32:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:32:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:32:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:32:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:32:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:32:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:32:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:32:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:32:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:32:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:32:15 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:32:15 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:32:15 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:32:15 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:32:15 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:32:15 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:32:15 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:32:16 UTC] WebSocket connection established to Deriv API in 1110.75ms
[18-Nov-2025 00:32:16 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:32:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:32:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:32:17 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:32:17 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:32:34 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:32:53 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:32:53 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:32:53
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:32:53 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:32:15
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:32:53 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:32:15
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:32:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:32:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:32:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:32:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:32:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:32:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:32:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:32:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:32:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:32:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:32:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:32:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:32:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:32:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:32:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:32:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:32:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:32:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:32:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:32:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:32:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:32:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:32:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:32:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:32:55 UTC] WebSocket connection established to Deriv API in 1127.45ms
[18-Nov-2025 00:32:55 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:32:55 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:32:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:32:55 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:32:55 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:33:12 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:33:31 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:33:32 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:33:31
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:33:32 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:32:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:33:32 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:32:54
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:33:32 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:33:32 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:33:32 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:33:32 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:33:32 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:33:32 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:33:32 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:33:32 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:33:32 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:33:32 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:33:32 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:33:32 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:33:32 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:33:32 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:33:32 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:33:32 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:33:32 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:33:32 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:33:32 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:33:32 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:33:32 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:33:32 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:33:32 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:33:32 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:33:33 UTC] WebSocket connection established to Deriv API in 1278.39ms
[18-Nov-2025 00:33:33 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:33:34 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:33:33
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:33:34 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:33:34 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 528
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:33:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:33:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:33:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:33:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:33:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:33:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:33:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:33:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:33:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:33:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:33:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:33:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:33:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:33:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:33:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:33:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:33:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:33:51 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:33:51 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:33:51 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:33:51 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:33:51 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:33:51 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:33:51 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:33:52 UTC] WebSocket connection established to Deriv API in 1133.43ms
[18-Nov-2025 00:33:52 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:33:53 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:33:52
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:33:53 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:33:53 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:34:10 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:34:29 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:34:29 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:34:29
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:34:29 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:33:51
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:34:29 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:33:51
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:34:29 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:34:29 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:34:29 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:34:29 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:34:29 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:34:29 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:34:29 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:34:29 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:34:30 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:34:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:34:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:34:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:34:30 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:34:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:34:30 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:34:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:34:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:34:30 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:34:30 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:34:30 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:34:30 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:34:30 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:34:30 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:34:30 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:34:31 UTC] WebSocket connection established to Deriv API in 1094.82ms
[18-Nov-2025 00:34:31 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:34:31 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:34:31
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:34:31 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:34:31 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:34:48 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:35:07 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:35:08 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:35:07
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:35:08 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:34:30
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:35:08 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:34:29
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:35:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:35:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:35:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:35:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:35:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:35:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:35:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:35:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:35:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:35:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:35:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:35:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:35:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:35:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:35:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:35:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:35:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:35:08 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:35:08 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:35:08 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:35:08 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:35:08 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:35:08 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:35:08 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:35:09 UTC] WebSocket connection established to Deriv API in 1052.73ms
[18-Nov-2025 00:35:09 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:35:09 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:35:09
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:35:09 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:35:10 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:35:27 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:35:46 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:35:46 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:35:46
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:35:46 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:35:08
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:35:46 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:35:08
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:35:46 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:35:46 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:35:46 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:35:46 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:35:46 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:35:46 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:35:46 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:35:46 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:35:46 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:35:46 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:35:46 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:35:46 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:35:46 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:35:46 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:35:46 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:35:46 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:35:46 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:35:46 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:35:46 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:35:46 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:35:46 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:35:46 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:35:46 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:35:46 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:35:47 UTC] WebSocket connection established to Deriv API in 1120.22ms
[18-Nov-2025 00:35:47 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:35:48 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:35:47
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:35:48 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:35:48 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:36:05 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:36:24 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:36:24 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:36:24
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:36:24 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:35:46
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:36:24 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:35:46
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:36:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:36:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:36:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:36:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:36:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:36:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:36:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:36:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:36:25 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:36:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:36:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:36:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:36:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:36:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:36:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:36:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:36:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:36:25 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:36:25 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:36:25 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:36:25 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:36:25 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:36:25 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:36:25 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:36:26 UTC] WebSocket connection established to Deriv API in 1124.09ms
[18-Nov-2025 00:36:26 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:36:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:36:26
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:36:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:36:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:36:43 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:37:02 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:37:03 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:37:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:37:03 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:36:25
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:37:03 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:36:25
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:37:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:37:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:37:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:37:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:37:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:37:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:37:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:37:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:37:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:37:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:37:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:37:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:37:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:37:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:37:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:37:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:37:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:03 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:37:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:37:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:37:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:37:03 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:37:04 UTC] WebSocket connection established to Deriv API in 1074.2ms
[18-Nov-2025 00:37:04 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:37:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:37:04
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:37:04 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:37:05 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:37:22 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:37:41 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:37:56 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:37:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Timeout, continuing...
  - ERROR: No valid authorization response received
  - Data received: null
=== DerivAPI::authorize FAILED ===
[18-Nov-2025 00:37:56 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:37:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Timeout, continuing...
  - ERROR: No valid authorization response received
  - Data received: null
=== DerivAPI::authorize FAILED ===
EXCEPTION CAUGHT: Authorization timeout or invalid response
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(487): App\Services\DerivAPI->authorize()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::authorize EXCEPTION ===
[18-Nov-2025 00:37:56 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:37:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
EXCEPTION CAUGHT: Authorization timeout or invalid response
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(487): App\Services\DerivAPI->authorize()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:37:56 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:37:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:37:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:37:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:37:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:37:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:37:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:37:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:37:57 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:37:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:37:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:37:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:37:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:37:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:37:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:37:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:37:57 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:37:57 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:37:57 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:37:57
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:37:57 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:37:59 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:37:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:37:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:37:59 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:37:59 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:37:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:37:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:37:59 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:37:59 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:37:59
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:37:59 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:37:59 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:37:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Authorization timeout or invalid response
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(487): App\Services\DerivAPI->authorize()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:37:59 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:37:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Authorization timeout or invalid response
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(487): App\Services\DerivAPI->authorize()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:37:59 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:37:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:37:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:37:59 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:37:59 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:37:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:37:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:37:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:37:59 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:37:59 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:37:59 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:37:59
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:37:59 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:00 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:00 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:00 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:00 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:00 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:00 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:00 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:00 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:00 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:00 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:00 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:00 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:00 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:00 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:00 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:00 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:00 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:00 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:00 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:00 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:00
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:00 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:02 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:02
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:37:59
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:37:59
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:02 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:02 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:02
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:03 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:03 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:03 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:05 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:02
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:02
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:05 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:05 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:06 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:06 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:06 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:06 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:06 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:06 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:06 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:06 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:06
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:06 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:08 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:08 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:08
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:08 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:05
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:08 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:05
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:08 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:08 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:08 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:08
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:09 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:09 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:09 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:09 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:09 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:09 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:09 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:09 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:09 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:09 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:09 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:09 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:09 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:09 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:09 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:09 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:09 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:09 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:09 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:09 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:09
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:09 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:11 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:11 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:11 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:11
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:11 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:11 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:08
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:11 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:08
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:11 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:11 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:12 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:12 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:12 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:12 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:12 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:11
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:12 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:13 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:13 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:13 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:13 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:13
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:13 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:15 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:15 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:15
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:11
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:11
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:15 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:15 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:15 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:15
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:16 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:16 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:16 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:16 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:16 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:16 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:16 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:16 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:16
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:16 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:18 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:18 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:18
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:18 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:15
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:18 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:15
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:18 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:18 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:18 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:18
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:19 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:19 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:19 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:19 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:19
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:19 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:21 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:21 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:21 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:21
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:21 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:21 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:18
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:21 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:18
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:21 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:21 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:21 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:21 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:21
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:21 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:22 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:22 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:22 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:22 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:22
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:22 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:24 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:24 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:24
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:24 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:21
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:24 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:21
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:24 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:24 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:24 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:24
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:25 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:25 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:25 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:25 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:25 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:25 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:26 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:26 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:26 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:26 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:26 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:26 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:26 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:25
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:26 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:28 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:28 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:28 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:28
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:28 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:28 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:24
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:28 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:24
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:28 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:28 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:28 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:28 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:28
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:28 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:29 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:29 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:29 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:29 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:29 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:29 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:29 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:29 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:29 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:29 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:29 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:29 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:29 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:29 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:29 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:29 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:29 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:29 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:29 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:29 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:29
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:29 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:31 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:31 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:31 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:31
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:31 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:31 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:28
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:31 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:28
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:31 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:31 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:31 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:31 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:31
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:31 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:32 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:32 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:32 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:32 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:32 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:32 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:32 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:32 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:32 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:32 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:32 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:32 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:32 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:32 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:32 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:32 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:32 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:32 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:32 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:32 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:32
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:32 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:34 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:34 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:34 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:34 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:34 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:34 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:34 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:34 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:34 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:34
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:34 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:34 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:31
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:34 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:31
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:34 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:34 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:34 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:34 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:34 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:34 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:34 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:34 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:34 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:34 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:34 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:34
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:34 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:35 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:35 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:35 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:35 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:35 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:35 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:35 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:35 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:35 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:35 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:35 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:35 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:35 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:35 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:35 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:35 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:35 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:35 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:35 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:35 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:35
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:35 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:37 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:37 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:37 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:37 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:37
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:37 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:37 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:34
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:37 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:34
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:38 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:38 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:38 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:38 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:38 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:38 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:38 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:38 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:38
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:38 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:39 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:39 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:39 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:39 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:39 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:39 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:39 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:39 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:39 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:39 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:39 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:39 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:39 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:39 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:39 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:39 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:39 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:39 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:39 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:39 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:39
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:39 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:41 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:41 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:41 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:41
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:41 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:41 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:38
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:41 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:38
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:41 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:41 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:41 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:41 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:41
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:41 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:42 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:42 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:42 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:42 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:42
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:42 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:44 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:44 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:44 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:44
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:44 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:44 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:41
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:44 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:41
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:44 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:44 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:44 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:44 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:44
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:44 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:45 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:45 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:45 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:45 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:45
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:45 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:47 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:47 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:47 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:47 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:47
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:47 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:47 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:44
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:47 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:44
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:48 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:48 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:48 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:48 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:48 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:48 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:48 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:48 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:48 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:48 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:48 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:48 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:48 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:48 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:48 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:48 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:48 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:48 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:48 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:48 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:48
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:48 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:49 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:49 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:49 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:49 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:49 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:49 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:49 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:49 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:49 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:49 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:49
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:49 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:51 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:51 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:51
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:51 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:48
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:51 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:48
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:51 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:51 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:51 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:51
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:52 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:52 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:52 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:52 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:52 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:52 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:52 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:52 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:52 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:52 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:52 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:52 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:52 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:52 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:52 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:52 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:52 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:52 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:52 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:52 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:52
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:52 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:54 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:54 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:54 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:51
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:54 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:51
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:54 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:54 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:54 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:55 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:55 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:55 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:55 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:55 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:55 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:55 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:55 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:55
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:55 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:57 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:57 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:57 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:57
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:57 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:57 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:54
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:38:57 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:54
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:38:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:57 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:57 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:57 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:57 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:57
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:57 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:58 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:38:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:38:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:38:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:38:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:38:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:38:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:38:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:58 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:38:58 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:38:58 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:38:58
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:38:58 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:00 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:00 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:00 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:00 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:00 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:00 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:00 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:00 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:00 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:00 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:00 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:00 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:00 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:00 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:00 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:00 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:00 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:00 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:00 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:00 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:00
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:00 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:00 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:57
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:39:00 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:38:57
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:39:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:02 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:02 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:02
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:03 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:03 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:03 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:05 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:05 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:02
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:39:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:02
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:39:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:07 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:07 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:07 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:07 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:07
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:07 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:08 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:08 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:08 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:08
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:10 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:10 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:10 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:10 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:10 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:10 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:10 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:10 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:10
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:10 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:10 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:07
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:39:10 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:07
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:39:12 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:12 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:12 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:12 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:12 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:12 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:12 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:12 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:12 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:12 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:12 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:12 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:12 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:12 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:12 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:12 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:12 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:12 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:12 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:12 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:12
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:12 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:13 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:13 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:13 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:13 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:13
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:13 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:15 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:15 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:15 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:15
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:12
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:39:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:12
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:39:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:17 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:17 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:17 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:17 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:17
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:17 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:18 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:18 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:18 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:18
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:20 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:20 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:20 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:20 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:20
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:20 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:20 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:17
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:39:20 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:17
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:39:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:21 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:21 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:21 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:21 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:21
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:21 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:22 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:22 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:22 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:22 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:22
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:22 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:24 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:24 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:25 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:39:25 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:25 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:39:25 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:39:25 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:24
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:39:25 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:25 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:21
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:39:25 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:21
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:39:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:27 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:39:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:39:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:39:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:39:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:39:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:39:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:39:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:39:27 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:39:27 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:39:27 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:39:27 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:39:27 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:39:27 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:39:27 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:39:28 UTC] WebSocket connection established to Deriv API in 1273.24ms
[18-Nov-2025 00:39:28 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:39:28 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:39:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:39:28 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:39:29 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:39:46 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:40:05 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:40:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:40:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:40:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:39:27
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:40:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:39:27
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:40:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:40:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:40:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:40:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:40:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:40:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:40:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:40:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:40:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:40:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:40:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:40:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:40:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:40:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:40:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:40:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:40:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:40:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:40:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:40:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:40:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:40:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:40:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:40:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:40:06 UTC] WebSocket connection established to Deriv API in 1147.08ms
[18-Nov-2025 00:40:06 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:40:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:40:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:40:07 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:40:07 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:40:24 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:40:43 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:40:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:40:43
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:40:44 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:40:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:40:44 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:40:05
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:40:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:40:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:40:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:40:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:40:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:40:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:40:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:40:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:40:44 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:40:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:40:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:40:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:40:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:40:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:40:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:40:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:40:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:40:44 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:40:44 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:40:44 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:40:44 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:40:44 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:40:44 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:40:44 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:40:45 UTC] WebSocket connection established to Deriv API in 1086.19ms
[18-Nov-2025 00:40:45 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:40:45 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:40:45
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:40:45 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:40:45 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:41:02 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:41:21 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:41:22 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:41:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:41:22 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:40:44
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:41:22 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:40:44
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:41:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:41:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:41:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:41:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:41:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:41:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:41:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:41:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:41:22 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:41:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:41:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:41:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:41:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:41:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:41:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:41:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:41:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:41:22 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:41:22 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:41:22 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:41:22 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:41:22 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:41:22 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:41:22 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:41:25 UTC] WebSocket connection established to Deriv API in 2448.92ms
[18-Nov-2025 00:41:25 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:41:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:41:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:41:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:41:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:41:43 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:42:02 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:42:03 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:42:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:42:03 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:41:22
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:42:03 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:41:22
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:42:09 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:42:09 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:42:09 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:42:09 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:42:09 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:42:09 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:42:09 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:42:09 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:42:09 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:42:09 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:42:09 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:42:09 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:42:09 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:42:09 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:42:09 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:42:09 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:42:09 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:42:09 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:42:09 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:42:09 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:42:09 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:42:09 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:42:09 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:42:09 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:42:10 UTC] WebSocket connection established to Deriv API in 1072.38ms
[18-Nov-2025 00:42:10 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:42:10 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:42:10
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:42:10 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:42:10 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:42:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:42:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:42:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:42:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:42:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:42:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:42:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:42:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:42:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:42:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:42:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:42:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:42:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:42:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:42:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:42:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:42:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:42:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:42:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:42:24 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:42:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:42:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:42:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:42:24 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:42:25 UTC] WebSocket connection established to Deriv API in 1135.76ms
[18-Nov-2025 00:42:25 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:42:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:42:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:42:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:42:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:42:27 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:42:43 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:42:46 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:42:47 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:42:46
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:42:47 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:42:09
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:42:47 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:42:09
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:42:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:42:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:42:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:42:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:42:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:42:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:42:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:42:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:42:47 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:42:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:42:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:42:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:42:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:42:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:42:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:42:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:42:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:42:47 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:42:47 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:42:47 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:42:47 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:42:47 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:42:47 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:42:47 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:42:48 UTC] WebSocket connection established to Deriv API in 1243.44ms
[18-Nov-2025 00:42:48 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:42:49 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:42:48
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:42:49 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:42:49 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:43:02 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:43:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:43:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:43:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:42:24
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:43:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:42:24
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:43:06 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:43:25 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:43:25 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:43:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:43:25 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:42:47
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:43:25 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:42:47
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:43:26 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:43:26 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:43:26 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:43:26 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:43:26 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:43:26 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:43:26 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:43:26 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:43:26 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:43:26 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:43:26 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:43:26 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:43:26 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:43:26 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:43:26 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:43:26 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:43:26 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:43:26 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:43:26 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:43:26 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:43:26 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:43:26 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:43:26 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:43:26 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:43:27 UTC] WebSocket connection established to Deriv API in 1186.63ms
[18-Nov-2025 00:43:27 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:43:27 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:43:27
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:43:27 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:43:27 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:43:44 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:43:46 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:43:46 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:43:46 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:43:46 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:43:46 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:43:46 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:43:46 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:43:46 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:43:46 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:43:46 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:43:46 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:43:46 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:43:46 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:43:46 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:43:46 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:43:46 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:43:46 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:43:46 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:43:46 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:43:46 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:43:46 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:43:46 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:43:46 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:43:46 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:43:47 UTC] WebSocket connection established to Deriv API in 1177.16ms
[18-Nov-2025 00:43:47 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:43:48 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:43:47
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:43:48 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:43:48 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:44:03 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:44:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:44:03
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:44:04 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:43:26
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:44:04 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:43:26
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:44:04 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:44:04 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:44:04 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:44:04 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:44:04 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:04 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:44:04 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:44:04 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:44:04 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:44:04 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:44:04 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:44:04 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:44:04 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:44:04 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:04 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:44:04 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:44:04 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:44:04 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:44:04 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:04 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:44:04 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:44:04 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:44:04 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:44:04 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:44:05 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:44:05 UTC] WebSocket connection established to Deriv API in 1104.75ms
[18-Nov-2025 00:44:05 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:44:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:44:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:44:06 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:44:06 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:44:23 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:44:24 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:44:25 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:44:24
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:44:25 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:43:46
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:44:25 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:43:46
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:44:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:44:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:44:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:44:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:44:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:44:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:44:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:44:25 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:44:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:44:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:44:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:44:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:44:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:44:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:44:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:44:25 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:44:25 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:25 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:44:25 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:44:25 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:44:25 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:44:25 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:44:26 UTC] WebSocket connection established to Deriv API in 1117.05ms
[18-Nov-2025 00:44:26 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:44:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:44:26
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:44:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:44:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:44:42 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:44:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:44:42
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:44:42 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:44:04
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:44:42 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:44:04
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:44:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:44:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:44:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:44:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:44:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:44:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:44:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:44:42 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:44:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:44:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:44:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:44:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:44:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:44:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:44:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:44:42 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:44:42 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:42 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:44:42 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:44:42 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:44:42 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:44:42 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:44:43 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:44:53 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:44:53 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:44:53 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:44:53 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:44:53 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:44:42
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:44:53 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:44:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:44:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:44:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:44:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:44:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:44:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:44:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:44:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:44:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:44:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:44:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:44:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:44:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:44:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:44:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:44:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:44:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:44:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:44:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:44:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:44:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:44:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:45:03 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:45:03 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:45:03
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:45:03 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:44:25
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:45:03 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:44:25
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:45:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:45:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:03 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:45:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:45:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:45:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:45:03 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:45:06 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:45:06 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:45:06 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:06 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:06 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:45:06 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:45:06 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:06 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:06 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:45:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:45:06 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:44:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:45:06 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:06 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:07 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:45:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:07 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:45:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:45:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:45:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:45:07 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:45:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:08 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:45:08 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:08 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:45:08 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:45:08 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:45:08 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:45:08 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:18 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:45:18 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:45:07
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:45:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:18 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:18 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:45:08
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:45:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:18 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:44:42
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:45:18 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:44:42
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:45:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:45:18 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:45:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:20 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:20 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:45:20 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:20 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:45:20 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:45:20 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:45:20 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:45:20 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 00:45:29 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:29 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 00:45:29 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:45:20
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:45:29 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:45:18
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 00:45:29 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:29 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:29 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:45:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 00:45:29 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:45:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 2s before retry
  - Recreating connection
Step 5: Attempt 3/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 3 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 00:45:29 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:29 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:29 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:29 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:29 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:29 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:29 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:29 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:29 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:29 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:29 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:29 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:29 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:29 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:29 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:29 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:29 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:45:29 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:45:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:30 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:30 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:30 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:45:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:45:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:45:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:45:30 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:45:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:30 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:45:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:45:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:45:30 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:45:30 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:45:30 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:45:30 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:45:30 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:45:30 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:45:30 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:45:30 UTC] WebSocket connection established to Deriv API in 1076.01ms
[18-Nov-2025 00:45:30 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:45:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:45:30
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:45:30 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:45:31 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:45:31 UTC] WebSocket connection established to Deriv API in 1061.2ms
[18-Nov-2025 00:45:31 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:45:31 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:45:31
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:45:31 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:45:32 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:45:48 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:45:49 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:46:07 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:46:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:46:07
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:46:07 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:45:29
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:46:07 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:45:29
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:46:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:46:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:46:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:46:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:46:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:46:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:46:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:46:07 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:46:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:46:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:46:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:46:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:46:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:46:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:46:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:46:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:46:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:07 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:46:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:46:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:46:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:46:07 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:46:08 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:46:08 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:46:08
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:46:08 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:45:30
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:46:08 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:45:18
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 1s before retry
  - Recreating connection
Step 5: Attempt 2/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:46:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:46:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:46:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:46:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:46:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:46:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:46:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:46:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:46:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:46:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:46:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:46:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:46:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:46:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:46:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:46:08 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:46:08 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:08 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:46:08 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:46:08 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:46:08 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:46:08 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:46:08 UTC] WebSocket connection established to Deriv API in 1114.89ms
[18-Nov-2025 00:46:08 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:46:09 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:46:08
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:46:09 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:46:09 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:46:09 UTC] WebSocket connection established to Deriv API in 1043.53ms
[18-Nov-2025 00:46:09 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:46:09 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:46:09
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:46:09 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:46:10 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:46:26 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:46:27 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:46:45 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:46:45 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:46:45
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:46:45 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:46:07
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:46:45 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:46:07
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:46:46 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:46:46 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:46:46 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:46:46 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:46:46 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:46 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:46:46 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:46:46 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:46:46 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:46:46 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:46:46 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:46:46 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:46:46 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:46:46 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:46 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:46:46 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:46:46 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:46:46 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:46:46 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:46 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:46:46 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:46:46 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:46:46 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:46:46 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:46:46 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:46:47 UTC] WebSocket connection established to Deriv API in 1244.22ms
[18-Nov-2025 00:46:47 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:46:47 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:46:46
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:46:47 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:46:08
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:46:47 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:46:08
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:46:47 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:46:47
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:46:47 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:46:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:46:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:46:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:46:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:46:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:46:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:46:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:46:47 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:46:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:46:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:46:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:46:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:46:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:46:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:46:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:46:47 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:46:47 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:46:47 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:46:47 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:46:47 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:46:47 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:46:47 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:46:47 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:46:49 UTC] WebSocket connection established to Deriv API in 1151.42ms
[18-Nov-2025 00:46:49 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:46:49 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:46:49
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:46:49 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:46:49 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:47:05 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:47:06 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:47:24 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:47:24 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:47:24
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:47:24 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:46:46
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:47:24 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:46:46
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:47:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:47:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:47:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:47:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:47:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:47:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:47:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:47:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:47:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:47:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:47:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:47:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:47:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:47:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:47:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:47:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:47:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:47:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:47:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:47:24 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:47:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:47:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:47:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:47:24 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:47:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 528
[18-Nov-2025 00:47:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:47:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:47:25 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:47:25 UTC] WebSocket connection established to Deriv API in 1141.41ms
[18-Nov-2025 00:47:25 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:47:26 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:47:26 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:47:26 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:47:26 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:47:26 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:47:26 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:47:26 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:47:26 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:47:26 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:47:26 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:47:26 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:47:26 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:47:26 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:47:26 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:47:26 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:47:26 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:47:26 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:47:26 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:47:26 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:47:26 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:47:26 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:47:26 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:47:26 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:47:26 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:47:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:47:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:47:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:47:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:47:27 UTC] WebSocket connection established to Deriv API in 1230.73ms
[18-Nov-2025 00:47:27 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:47:27 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:47:27
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:47:27 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:47:28 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:47:43 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:47:45 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:48:02 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:48:03 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:48:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:48:03 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:47:24
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:48:03 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:47:24
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:48:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:48:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:48:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:48:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:48:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:48:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:48:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:48:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:48:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:48:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:48:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:48:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:48:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:48:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:48:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:48:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:48:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:03 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:48:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:48:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:48:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:48:03 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:48:04 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:48:04 UTC] WebSocket connection established to Deriv API in 1056.54ms
[18-Nov-2025 00:48:04 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:48:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:48:04
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:48:04 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:47:26
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:48:04 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:47:26
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:48:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:48:04
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:48:04 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:48:04 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:48:04 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:48:04 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:48:04 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:48:04 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:04 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:48:04 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:48:04 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:48:04 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:48:04 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:48:04 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:48:04 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:48:04 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:48:04 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:04 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:48:04 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:48:04 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:48:04 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:48:04 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:48:04 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:04 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:48:04 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:48:04 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:48:04 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:48:04 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:48:05 UTC] WebSocket connection established to Deriv API in 1060.11ms
[18-Nov-2025 00:48:05 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:48:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:48:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:48:06 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:48:06 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:48:21 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:48:23 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:48:40 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:48:41 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:48:40
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:48:41 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:48:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:48:41 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:48:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:48:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:48:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:48:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:48:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:48:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:48:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:48:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:48:41 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:48:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:48:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:48:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:48:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:48:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:48:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:48:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:48:41 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:48:41 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:41 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:48:41 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:48:41 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:48:41 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:48:41 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:48:42 UTC] WebSocket connection established to Deriv API in 1075.34ms
[18-Nov-2025 00:48:42 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:48:42 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:48:43 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:48:42
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:48:43 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:48:04
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:48:43 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:48:04
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:48:43 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:48:42
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:48:43 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:48:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:48:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:48:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:48:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:48:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:48:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:48:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:48:43 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:48:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:48:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:48:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:48:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:48:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:48:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:48:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:48:43 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:48:43 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:48:43 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:48:43 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:48:43 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:48:43 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:48:43 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:48:43 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:48:44 UTC] WebSocket connection established to Deriv API in 1120.37ms
[18-Nov-2025 00:48:44 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:48:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:48:44
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:48:44 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:48:44 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:49:00 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:49:01 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:49:19 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:49:19 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:49:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:49:19 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:48:41
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:49:19 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:48:41
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:49:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:49:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:49:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:49:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:49:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:49:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:49:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:49:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:49:19 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:49:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:49:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:49:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:49:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:49:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:49:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:49:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:49:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:49:19 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:49:19 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:49:19 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:49:19 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:49:19 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:49:19 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:49:19 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:49:20 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:49:21 UTC] WebSocket connection established to Deriv API in 1180.22ms
[18-Nov-2025 00:49:21 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:49:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:49:20
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:49:21 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:48:43
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:49:21 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:48:43
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:49:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:49:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:49:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:49:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:49:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:49:21 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:49:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:49:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:49:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:49:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:49:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:49:21 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:49:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:49:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:49:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:49:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:49:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:49:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:49:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:49:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:49:21 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:49:21 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:49:21 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:49:21 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:49:21 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:49:21 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:49:21 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:49:21 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:49:22 UTC] WebSocket connection established to Deriv API in 1201.32ms
[18-Nov-2025 00:49:22 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:49:23 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:49:22
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:49:23 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:49:23 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:49:38 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:49:40 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:49:57 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:49:58 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:49:57
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:49:58 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:49:19
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:49:58 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:49:19
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:49:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:49:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:49:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:49:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:49:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:49:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:49:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:49:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:49:58 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:49:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:49:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:49:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:49:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:49:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:49:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:49:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:49:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:49:58 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:49:58 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:49:58 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:49:58 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:49:58 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:49:59 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:49:59 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:49:59 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:50:00 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:49:59
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:50:00 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:49:21
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:50:00 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:49:21
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:50:00 UTC] WebSocket connection established to Deriv API in 1171.03ms
[18-Nov-2025 00:50:00 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:50:00 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:50:00 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:50:00 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:50:00 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:50:00 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:50:00 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:50:00 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:50:00 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:50:00 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:50:00 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:50:00 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:50:00 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:50:00 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:50:00 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:50:00 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:50:00 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:50:00 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:50:00 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:50:00 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:50:00 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:50:00 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:50:00 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:50:00 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:50:00
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:50:00 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:50:00 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:50:00 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:50:00 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:50:01 UTC] WebSocket connection established to Deriv API in 1174.26ms
[18-Nov-2025 00:50:01 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:50:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:50:01
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:50:02 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:50:02 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:50:17 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:50:19 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:50:36 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:50:37 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:50:36
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:50:37 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:49:58
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:50:37 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:49:58
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:50:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:50:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:50:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:50:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:50:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:50:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:50:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:50:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:50:37 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:50:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:50:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:50:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:50:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:50:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:50:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:50:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:50:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:50:37 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:50:37 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:50:37 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:50:37 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:50:37 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:50:37 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:50:37 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:50:38 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:50:38 UTC] WebSocket connection established to Deriv API in 1231.16ms
[18-Nov-2025 00:50:38 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:50:38 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:50:38
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:50:38 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:50:00
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:50:38 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:50:00
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:50:39 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:50:39 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:50:39 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:50:39 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:50:39 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:50:39 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:50:39 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:50:39 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:50:39 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:50:39 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:50:39 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:50:39 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:50:39 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:50:39 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:50:39 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:50:39 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:50:39 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:50:39 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:50:39 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:50:39 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:50:39 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:50:39 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:50:39 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:50:39 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:50:39 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:50:38
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:50:39 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:50:39 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:50:40 UTC] WebSocket connection established to Deriv API in 1149.17ms
[18-Nov-2025 00:50:40 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:50:40 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:50:40
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:50:40 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:50:40 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:50:56 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:50:57 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:51:15 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:51:15 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:51:15
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:51:15 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:50:37
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:51:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:50:37
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:51:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:51:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:51:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:51:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:51:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:51:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:51:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:51:16 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:51:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:51:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:51:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:51:16 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:51:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:16 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:51:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:51:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:51:16 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:51:16 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:16 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:51:16 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:51:16 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:51:16 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:51:16 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:51:16 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:51:17 UTC] WebSocket connection established to Deriv API in 1125.02ms
[18-Nov-2025 00:51:17 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:51:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:51:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:51:17 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:50:39
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:51:17 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:50:39
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:51:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:51:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:51:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:51:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:51:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:51:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:51:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:51:17 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:51:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:51:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:51:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:51:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:51:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:51:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:51:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:51:17 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:51:17 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:17 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:51:17 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:51:17 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:51:17 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:51:17 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:51:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:51:17
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:51:17 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:51:17 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:51:18 UTC] WebSocket connection established to Deriv API in 1114.58ms
[18-Nov-2025 00:51:18 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:51:18 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:51:18
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:51:18 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:51:19 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:51:34 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:51:36 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:51:53 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:51:54 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:51:53
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:51:54 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:51:16
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:51:54 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:51:16
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:51:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:51:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:51:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:51:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:51:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:51:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:51:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:51:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:51:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:51:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:51:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:51:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:51:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:51:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:51:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:51:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:51:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:51:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:51:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:51:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:51:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:51:55 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:51:55 UTC] WebSocket connection established to Deriv API in 1103.66ms
[18-Nov-2025 00:51:55 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:51:55 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:51:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:51:55 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:51:17
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:51:55 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:51:17
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:51:55 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:51:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:51:55 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:51:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:51:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:51:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:51:55 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:51:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:55 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:51:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:51:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:51:55 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:51:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:51:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:51:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:51:55 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:51:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:55 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:51:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:51:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:51:55 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:51:55 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:51:55 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:51:55 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:51:55 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:51:55 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:51:55 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:51:56 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:51:57 UTC] WebSocket connection established to Deriv API in 1241.16ms
[18-Nov-2025 00:51:57 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:51:57 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:51:57
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:51:57 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:51:57 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:52:13 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:52:14 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:52:32 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:52:32 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:52:32
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:52:32 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:51:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:52:32 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:51:54
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:52:32 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:52:32 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:52:32 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:52:32 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:52:32 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:52:32 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:52:32 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:52:32 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:52:32 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:52:32 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:52:32 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:52:32 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:52:32 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:52:32 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:52:32 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:52:32 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:52:32 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:52:32 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:52:32 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:52:32 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:52:32 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:52:32 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:52:32 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:52:32 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:52:33 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:52:33 UTC] WebSocket connection established to Deriv API in 1146.73ms
[18-Nov-2025 00:52:33 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:52:34 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:52:33
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:52:34 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:51:55
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:52:34 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:51:55
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:52:34 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:52:33
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:52:34 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:52:34 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:52:34 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:52:34 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:52:34 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:52:34 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:52:34 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:52:34 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:52:34 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:52:34 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:52:34 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:52:34 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:52:34 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:52:34 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:52:34 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:52:34 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:52:34 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:52:34 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:52:34 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:52:34 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:52:34 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:52:34 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:52:34 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:52:34 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:52:34 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:52:34 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:52:35 UTC] WebSocket connection established to Deriv API in 1125.49ms
[18-Nov-2025 00:52:35 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:52:36 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:52:35
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:52:36 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:52:36 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:52:51 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:52:53 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:53:10 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:53:11 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:53:10
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:53:11 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:52:32
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:53:11 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:52:32
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:53:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:53:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:53:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:53:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:53:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:53:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:53:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:53:11 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:53:11 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:53:11 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:53:11 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:53:11 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:53:11 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:11 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:53:11 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:53:11 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:53:11 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:53:11 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:11 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:53:11 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:53:11 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:53:11 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:53:11 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:53:12 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:53:12 UTC] WebSocket connection established to Deriv API in 1158.66ms
[18-Nov-2025 00:53:12 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:53:12 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:53:12
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:53:12 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:52:34
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:53:12 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:52:34
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:53:12 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:53:12
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:53:12 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:53:12 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:53:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:53:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:53:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:53:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:53:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:53:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:53:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:53:13 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:53:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:53:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:53:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:53:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:53:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:53:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:53:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:53:13 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:53:13 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:13 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:53:13 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:53:13 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:53:13 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:53:13 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:53:14 UTC] WebSocket connection established to Deriv API in 1129.81ms
[18-Nov-2025 00:53:14 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:53:14 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:53:14
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:53:14 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:53:15 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:53:30 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:53:32 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:53:49 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:53:49 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:53:49
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:53:49 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:53:11
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:53:49 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:53:11
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:53:49 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:53:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:53:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:53:49 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:53:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:49 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:53:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:53:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:53:50 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:53:50 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:53:50 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:53:50 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:53:50 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:53:50 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:50 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:53:50 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:53:50 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:53:50 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:53:50 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:50 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:53:50 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:53:50 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:53:50 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:53:50 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:53:51 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:53:51 UTC] WebSocket connection established to Deriv API in 1215.28ms
[18-Nov-2025 00:53:51 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:53:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:53:51
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:53:51 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:53:13
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:53:51 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:53:13
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:53:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:53:51
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:53:51 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:53:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:53:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:53:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:53:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:53:51 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:53:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:53:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:53:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:53:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:53:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:53:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:53:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:53:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:53:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:53:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:53:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:53:51 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:53:51 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:53:51 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:53:51 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:53:51 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:53:51 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:53:51 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:53:53 UTC] WebSocket connection established to Deriv API in 1121.84ms
[18-Nov-2025 00:53:53 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:53:53 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:53:53
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:53:53 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:53:53 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:54:08 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:54:10 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:54:27 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:54:28 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:54:27
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:54:28 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:53:50
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:54:28 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:53:49
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:54:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:54:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:54:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:54:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:54:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:54:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:54:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:54:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:54:28 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:54:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:54:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:54:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:54:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:54:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:54:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:54:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:54:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:54:28 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:54:28 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:54:28 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:54:28 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:54:28 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:54:28 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:54:28 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:54:29 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:54:29 UTC] WebSocket connection established to Deriv API in 1146.22ms
[18-Nov-2025 00:54:29 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:54:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:54:29
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:54:30 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:53:51
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:54:30 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:53:51
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:54:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:54:29
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:54:30 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:54:30 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:54:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:54:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:54:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:54:30 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:54:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:54:30 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:54:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:54:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:54:30 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:54:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:54:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:54:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:54:30 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:54:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:54:30 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:54:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:54:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:54:30 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:54:30 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:54:30 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:54:30 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:54:30 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:54:30 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:54:30 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:54:31 UTC] WebSocket connection established to Deriv API in 1117.95ms
[18-Nov-2025 00:54:31 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:54:32 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:54:31
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:54:32 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:54:32 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:54:47 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:54:49 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:55:06 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:55:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:55:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:55:06 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:54:28
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:55:06 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:54:28
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:55:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:55:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:55:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:55:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:55:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:55:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:55:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:55:07 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:55:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:55:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:55:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:55:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:55:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:55:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:55:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:55:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:55:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:07 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:55:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:55:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:55:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:55:07 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:55:08 UTC] WebSocket connection established to Deriv API in 1126.42ms
[18-Nov-2025 00:55:08 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:55:08 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:55:08 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:55:08
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:55:08 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:55:09 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:55:08
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:55:09 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:54:30
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:55:09 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:54:30
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:55:09 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:55:09 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:55:09 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:55:09 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:55:09 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:55:09 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:09 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:55:09 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:55:09 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:55:09 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:55:09 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:55:09 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:55:09 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:55:09 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:55:09 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:09 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:55:09 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:55:09 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:55:09 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:55:09 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:09 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:55:09 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:55:09 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:55:09 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:55:09 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:55:10 UTC] WebSocket connection established to Deriv API in 1183.31ms
[18-Nov-2025 00:55:10 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:55:11 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:55:10
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:55:11 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:55:11 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:55:26 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:55:28 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:55:45 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:55:45 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:55:45
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:55:45 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:55:07
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:55:45 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:55:07
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:55:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:55:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:55:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:55:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:55:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:55:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:55:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:55:45 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:55:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:55:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:55:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:55:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:55:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:55:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:55:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:55:45 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:55:45 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:45 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:55:45 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:55:45 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:55:45 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:55:45 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:55:47 UTC] WebSocket connection established to Deriv API in 1292.68ms
[18-Nov-2025 00:55:47 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:55:47 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:55:47 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:55:47
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:55:47 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:55:47 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:55:47 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:55:47
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:55:47 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:55:09
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:55:47 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:55:09
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:55:48 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:55:48 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:55:48 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:55:48 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:55:48 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:48 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:55:48 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:55:48 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:55:48 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:55:48 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:55:48 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:55:48 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:55:48 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:55:48 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:48 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:55:48 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:55:48 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:55:48 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:55:48 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:55:48 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:55:48 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:55:48 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:55:48 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:55:48 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:55:49 UTC] WebSocket connection established to Deriv API in 1297.18ms
[18-Nov-2025 00:55:49 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:55:49 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:55:49
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:55:49 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:55:50 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:56:04 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:56:07 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:56:23 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:56:24 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:56:23
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:56:24 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:55:45
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:56:24 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:55:45
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:56:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:56:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:56:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:56:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:56:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:56:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:56:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:56:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:56:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:56:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:56:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:56:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:56:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:56:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:56:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:56:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:56:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:56:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:56:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:56:24 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:56:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:56:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:56:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:56:24 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:56:25 UTC] WebSocket connection established to Deriv API in 1168.35ms
[18-Nov-2025 00:56:25 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:56:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:56:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:56:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:56:26 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:56:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:56:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:56:26
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:56:26 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:55:48
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:56:26 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:55:48
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:56:26 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:56:26 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:56:26 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:56:26 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:56:26 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:56:26 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:56:26 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:56:26 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:56:26 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:56:26 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:56:26 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:56:26 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:56:26 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:56:26 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:56:26 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:56:26 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:56:26 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:56:26 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:56:26 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:56:26 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:56:26 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:56:26 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:56:26 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:56:26 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:56:28 UTC] WebSocket connection established to Deriv API in 1290.19ms
[18-Nov-2025 00:56:28 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:56:28 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:56:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:56:28 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:56:28 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:56:43 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:56:45 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:57:02 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:57:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:57:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:57:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:56:24
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:57:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:56:24
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:57:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:57:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:57:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:57:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:57:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:57:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:57:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:57:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:57:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:57:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:57:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:57:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:57:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:57:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:57:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:57:02 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:57:02 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:02 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:57:02 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:57:02 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:57:02 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:57:02 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:57:04 UTC] WebSocket connection established to Deriv API in 1132.94ms
[18-Nov-2025 00:57:04 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:57:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:57:04
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:57:04 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:57:04 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:57:04 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:57:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:57:04
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:57:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:56:26
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:57:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:56:26
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:57:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:57:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:57:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:57:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:57:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:57:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:57:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:57:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:57:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:57:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:57:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:57:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:57:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:57:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:57:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:57:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:57:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:57:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:57:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:57:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:57:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:57:06 UTC] WebSocket connection established to Deriv API in 1111.2ms
[18-Nov-2025 00:57:06 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:57:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:57:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:57:07 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:57:07 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:57:21 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:57:24 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:57:40 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:57:41 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:57:40
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:57:41 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:57:02
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:57:41 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:57:02
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:57:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:57:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:57:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:57:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:57:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:57:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:57:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:57:41 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:57:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:57:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:57:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:57:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:57:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:57:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:57:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:57:41 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:57:41 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:41 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:57:41 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:57:41 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:57:41 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:57:41 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:57:42 UTC] WebSocket connection established to Deriv API in 1085.07ms
[18-Nov-2025 00:57:42 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:57:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:57:42
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:57:42 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:57:42 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:57:43 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:57:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:57:43
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:57:44 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:57:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:57:44 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:57:05
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:57:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:57:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:57:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:57:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:57:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:57:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:57:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:57:45 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:57:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:57:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:57:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:57:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:57:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:57:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:57:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:57:45 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:57:45 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:57:45 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:57:45 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:57:45 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:57:45 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:57:45 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:57:47 UTC] WebSocket connection established to Deriv API in 2002.52ms
[18-Nov-2025 00:57:47 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:57:47 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:57:47
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:57:47 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:57:48 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:58:00 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:58:05 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:58:19 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:58:19 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:58:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:58:19 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:57:41
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:58:19 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:57:41
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:58:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:58:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:58:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:58:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:58:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:58:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:58:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:58:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:58:19 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:58:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:58:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:58:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:58:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:58:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:58:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:58:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:58:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:58:19 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:58:19 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:58:19 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:58:19 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:58:19 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:58:19 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:58:19 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:58:20 UTC] WebSocket connection established to Deriv API in 1071.14ms
[18-Nov-2025 00:58:20 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:58:20 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:58:20
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:58:20 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:58:21 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:58:24 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:58:24 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:58:24
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:58:24 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:57:45
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:58:24 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:57:45
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:58:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:58:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:58:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:58:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:58:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:58:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:58:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:58:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:58:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:58:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:58:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:58:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:58:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:58:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:58:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:58:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:58:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:58:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:58:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:58:24 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:58:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:58:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:58:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:58:24 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:58:25 UTC] WebSocket connection established to Deriv API in 1053.46ms
[18-Nov-2025 00:58:25 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:58:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:58:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:58:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:58:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\services\WebSocketClient.php on line 528
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:58:38 UTC] PHP Fatal error:  Maximum execution time of 120 seconds exceeded in C:\xampp\htdocs\vtmoption\app\autoload.php on line 86
[18-Nov-2025 00:58:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:58:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:58:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:58:38 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:58:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:58:38 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:58:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:58:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:58:38 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:58:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:58:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:58:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:58:38 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:58:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:58:38 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:58:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:58:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:58:38 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:58:38 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:58:38 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:58:38 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:58:38 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:58:38 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:58:38 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:58:40 UTC] WebSocket connection established to Deriv API in 1169.44ms
[18-Nov-2025 00:58:40 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:58:40 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:58:40
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:58:40 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:58:40 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:58:43 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:58:57 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:59:02 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:59:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:59:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:59:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:58:24
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:59:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:58:24
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:59:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:59:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:59:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:59:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:59:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:59:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:59:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:59:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:59:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:59:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:59:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:59:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:59:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:59:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:59:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:59:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:59:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:59:02 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:59:02 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:59:02 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:59:02 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:59:02 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:59:02 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:59:02 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:59:03 UTC] WebSocket connection established to Deriv API in 1061ms
[18-Nov-2025 00:59:03 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:59:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:59:03
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:59:04 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:59:04 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:59:16 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:59:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:59:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:59:17 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:58:38
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:59:17 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:58:38
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:59:17 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 00:58:38
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 00:59:21 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:59:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:59:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:59:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:59:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:59:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:59:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:59:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:59:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:59:22 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:59:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:59:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:59:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:59:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:59:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:59:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:59:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:59:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:59:22 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:59:22 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:59:22 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:59:22 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:59:22 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:59:22 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:59:22 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:59:24 UTC] WebSocket connection established to Deriv API in 1170.09ms
[18-Nov-2025 00:59:24 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:59:24 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:59:24
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:59:24 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:59:24 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:59:40 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 00:59:41 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:59:40
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:59:41 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:59:02
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 00:59:41 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:59:02
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 00:59:41 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 00:59:02
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 00:59:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:59:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:59:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:59:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:59:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:59:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:59:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:59:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:59:41 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 00:59:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 00:59:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 00:59:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 00:59:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 00:59:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:59:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 00:59:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 00:59:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 00:59:41 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 00:59:41 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 00:59:41 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 00:59:41 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 00:59:41 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 00:59:41 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 00:59:41 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 00:59:41 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 00:59:42 UTC] WebSocket connection established to Deriv API in 1181.88ms
[18-Nov-2025 00:59:42 UTC] Not authorized, calling authorize() first
[18-Nov-2025 00:59:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 00:59:42
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 00:59:42 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 00:59:42 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 00:59:59 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:00:00 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:00:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:00:00
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:00:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:59:22
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:00:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:59:22
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:00:02 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 00:59:22
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:00:19 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:00:19 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:00:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:00:19 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 00:59:41
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:00:19 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 00:59:41
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:00:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:00:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:00:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:00:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:00:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:00:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:00:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:00:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:00:19 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:00:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:00:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:00:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:00:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:00:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:00:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:00:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:00:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:00:19 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:00:19 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:00:19 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:00:19 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:00:19 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:00:19 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:00:19 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:00:20 UTC] WebSocket connection established to Deriv API in 1106.74ms
[18-Nov-2025 01:00:20 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:00:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:00:20
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:00:21 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:00:21 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:00:36 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:00:36 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:00:36 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:00:36 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:00:36 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:00:36 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:00:36 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:00:36 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:00:36 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:00:36 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:00:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:00:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:00:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:00:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:00:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:00:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:00:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:00:37 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:00:37 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:00:37 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:00:37 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:00:37 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:00:37 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:00:37 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:00:38 UTC] WebSocket connection established to Deriv API in 1105.93ms
[18-Nov-2025 01:00:38 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:00:38 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:00:38 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:00:38
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:00:38 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:00:38 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:00:55 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:00:57 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:00:57 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:00:57
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:00:57 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:00:19
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:00:57 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:00:19
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:00:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:00:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:00:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:00:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:00:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:00:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:00:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:00:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:00:57 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:00:57 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:00:57 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:00:57 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:00:57 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:00:57 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:00:57 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:00:57 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:00:57 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:00:57 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:00:57 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:00:57 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:00:57 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:00:57 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:00:57 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:00:57 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:00:59 UTC] WebSocket connection established to Deriv API in 1285.85ms
[18-Nov-2025 01:00:59 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:00:59 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:00:59
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:00:59 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:00:59 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:01:14 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:01:15 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:01:14
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:01:15 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:00:37
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:01:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:00:36
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:01:15 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:00:36
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:01:16 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:01:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:01:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:01:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:01:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:01:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:01:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:01:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:01:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:01:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:01:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:01:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:01:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:01:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:01:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:01:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:01:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:01:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:01:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:01:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:01:24 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:01:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:01:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:01:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:01:24 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:01:25 UTC] WebSocket connection established to Deriv API in 1092.51ms
[18-Nov-2025 01:01:25 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:01:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:01:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:01:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:01:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:01:35 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:01:36 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:01:35
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:01:36 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:00:57
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:01:36 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:00:57
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:01:36 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:01:36 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:01:36 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:01:36 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:01:36 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:01:36 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:01:36 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:01:36 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:01:36 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:01:36 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:01:36 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:01:36 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:01:36 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:01:36 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:01:36 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:01:36 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:01:36 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:01:36 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:01:36 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:01:36 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:01:36 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:01:36 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:01:36 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:01:36 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:01:37 UTC] WebSocket connection established to Deriv API in 1109.05ms
[18-Nov-2025 01:01:37 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:01:37 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:01:37
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:01:37 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:01:38 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:01:43 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:01:55 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:02:02 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:02:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:02:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:02:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:01:24
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:02:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:01:24
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:02:02 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:01:24
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:02:14 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:02:14 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:02:14
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:02:14 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:01:36
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:02:14 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:01:36
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:02:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:02:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:02:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:02:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:02:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:02:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:02:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:02:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:02:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:02:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:02:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:02:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:02:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:02:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:02:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:02:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:02:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:02:15 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:02:15 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:02:15 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:02:15 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:02:15 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:02:15 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:02:15 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:02:16 UTC] WebSocket connection established to Deriv API in 1119.28ms
[18-Nov-2025 01:02:16 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:02:16 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:02:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:02:16 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:02:16 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:02:33 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:02:52 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:02:53 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:02:52
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:02:53 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:02:15
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:02:53 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:02:15
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:02:53 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:02:53 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:02:53 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:02:53 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:02:53 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:02:53 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:02:53 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:02:53 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:02:53 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:02:53 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:02:53 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:02:53 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:02:53 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:02:53 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:02:53 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:02:53 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:02:53 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:02:53 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:02:53 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:02:53 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:02:53 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:02:53 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:02:53 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:02:53 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:02:54 UTC] WebSocket connection established to Deriv API in 1089.49ms
[18-Nov-2025 01:02:54 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:02:54 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:02:54
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:02:54 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:02:55 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:03:12 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:03:31 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:03:31 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:03:31
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:03:31 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:02:53
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:03:31 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:02:53
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:03:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:03:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:03:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:03:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:03:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:03:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:03:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:03:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:03:31 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:03:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:03:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:03:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:03:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:03:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:03:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:03:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:03:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:03:31 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:03:31 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:03:31 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:03:31 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:03:31 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:03:31 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:03:31 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:03:32 UTC] WebSocket connection established to Deriv API in 1113.95ms
[18-Nov-2025 01:03:32 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:03:33 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:03:32
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:03:33 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:03:33 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:03:50 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:04:09 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:04:10 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:04:09
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:04:10 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:03:31
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:04:10 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:03:31
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:04:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:04:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:04:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:04:10 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:04:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:04:10 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:04:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:04:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:04:10 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:04:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:04:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:04:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:04:10 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:04:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:04:10 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:04:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:04:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:04:10 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:04:10 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:04:10 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:04:10 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:04:10 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:04:10 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:04:10 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:04:11 UTC] WebSocket connection established to Deriv API in 1084.73ms
[18-Nov-2025 01:04:11 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:04:11 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:04:11
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:04:11 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:04:11 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:04:28 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:04:47 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:04:48 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:04:47
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:04:48 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:04:10
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:04:48 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:04:10
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:04:48 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:04:48 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:04:48 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:04:48 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:04:48 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:04:48 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:04:48 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:04:48 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:04:48 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:04:48 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:04:48 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:04:48 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:04:48 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:04:48 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:04:48 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:04:48 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:04:48 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:04:48 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:04:48 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:04:48 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:04:48 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:04:48 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:04:48 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:04:48 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:04:49 UTC] WebSocket connection established to Deriv API in 1229.65ms
[18-Nov-2025 01:04:49 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:04:50 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:04:49
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:04:50 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:04:50 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:05:07 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:05:26 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:05:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:05:26
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:05:26 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:04:48
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:05:26 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:04:48
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/3 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:05:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:05:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:05:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:05:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:05:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:05:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:05:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:05:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:05:27 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:05:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:05:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:05:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:05:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:05:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:05:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:05:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:05:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:05:27 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:05:27 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:05:27 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:05:27 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:05:27 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:05:27 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:05:27 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:05:28 UTC] WebSocket connection established to Deriv API in 1158.95ms
[18-Nov-2025 01:05:28 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:05:28 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:05:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:05:28 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:05:29 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:05:46 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:06:05 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:06:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:06:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:06:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:05:27
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:06:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:05:27
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:06:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:06:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:06:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:06:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:06:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:06:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:06:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:06:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:06:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:06:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:06:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:06:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:06:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:06:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:06:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:06:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:06:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:06:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:06:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:06:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:06:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:06:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:06:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:06:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 15 seconds
[18-Nov-2025 01:06:06 UTC] WebSocket connection established to Deriv API in 1334.48ms
[18-Nov-2025 01:06:06 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:06:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:06:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:06:07 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:06:07 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:06:24 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:06:43 UTC] WebSocket receive attempt 3 failed: WebSocket receive timeout
[18-Nov-2025 01:06:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:06:43
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:06:44 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:06:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 3 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:06:44 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:06:05
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:06:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:06:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:06:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:06:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:06:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:06:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:06:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:06:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:06:44 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:06:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:06:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:06:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:06:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:06:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:06:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:06:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:06:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:06:44 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:06:44 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:06:44 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:06:44 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:06:44 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:06:44 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:06:44 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:06:45 UTC] WebSocket connection established to Deriv API in 1174.71ms
[18-Nov-2025 01:06:45 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:06:45 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:06:45
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:06:45 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:06:46 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:06:55 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:06:55 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:06:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:06:55 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:06:44
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:06:55 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:06:44
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:06:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:06:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:06:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:06:55 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:06:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:06:55 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:06:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:06:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:06:55 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:06:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:06:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:06:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:06:55 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:06:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:06:55 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:06:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:06:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:06:55 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:06:55 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:06:55 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:06:55 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:06:55 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:06:55 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:06:55 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:06:56 UTC] WebSocket connection established to Deriv API in 1240.75ms
[18-Nov-2025 01:06:56 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:06:57 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:06:56
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:06:57 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:06:57 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:07:06 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:07:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:07 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:06:55
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:07:07 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:06:55
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:07:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:07 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:07:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:07:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:07 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:07:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:07:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:07:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:07:07 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:07:08 UTC] WebSocket connection established to Deriv API in 1130.66ms
[18-Nov-2025 01:07:08 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:07:09 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:08
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:09 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:07:09 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:07:18 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:07:18 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:18
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:18 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:07:07
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:07:18 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:07:07
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:07:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:07:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:18 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:07:18 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:18 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:07:18 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:07:18 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:07:18 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:07:18 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:07:19 UTC] WebSocket connection established to Deriv API in 1122.42ms
[18-Nov-2025 01:07:19 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:07:20 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:20 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:07:20 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:07:29 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:07:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:29
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:30 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:07:18
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:07:30 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:07:18
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:07:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:30 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:30 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:30 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:07:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:30 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:30 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:30 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:07:30 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:30 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:07:30 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:07:30 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:07:30 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:07:30 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:07:31 UTC] WebSocket connection established to Deriv API in 1165.47ms
[18-Nov-2025 01:07:31 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:07:32 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:31
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:32 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:07:32 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:07:41 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:07:41 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:41 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:07:30
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:07:41 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:07:30
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:07:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:41 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:07:41 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:41 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:41 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:41 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:41 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:41 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:41 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:41 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:41 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:07:41 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:41 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:07:41 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:07:41 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:07:41 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:07:41 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:07:42 UTC] WebSocket connection established to Deriv API in 1096.82ms
[18-Nov-2025 01:07:42 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:07:43 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:42
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:43 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:07:43 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:07:52 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:07:53 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:52
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:53 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:07:41
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:07:53 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:07:41
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:07:53 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:53 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:53 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:53 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:53 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:53 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:53 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:53 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:53 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:07:53 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:07:53 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:07:53 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:07:53 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:07:53 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:53 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:07:53 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:07:53 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:07:53 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:07:53 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:07:53 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:07:53 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:07:53 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:07:53 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:07:53 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:07:54 UTC] WebSocket connection established to Deriv API in 1117.22ms
[18-Nov-2025 01:07:54 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:07:54 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:07:54
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:07:54 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:07:54 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:08:03 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:08:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:03
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:04 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:07:53
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:08:04 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:07:53
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:08:04 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:04 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:04 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:04 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:04 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:04 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:04 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:04 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:04 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:08:04 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:04 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:04 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:04 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:04 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:04 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:04 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:04 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:04 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:08:04 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:04 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:08:04 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:08:04 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:08:04 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:08:04 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:08:06 UTC] WebSocket connection established to Deriv API in 1410.96ms
[18-Nov-2025 01:08:06 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:08:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:06 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:08:07 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:08:16 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:08:16 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:16 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:08:04
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:08:16 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:08:04
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:08:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:16 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:16 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:16 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:08:16 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:16 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:16 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:16 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:16 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:16 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:16 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:16 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:16 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:08:16 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:16 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:08:16 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:08:16 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:08:16 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:08:16 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:08:17 UTC] WebSocket connection established to Deriv API in 1119.49ms
[18-Nov-2025 01:08:17 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:08:18 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:17
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:18 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:08:18 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:08:27 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:08:28 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:27
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:28 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:08:16
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:08:28 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:08:16
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:08:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:28 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:08:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:28 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:08:28 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:28 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:08:28 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:08:28 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:08:28 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:08:28 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:08:29 UTC] WebSocket connection established to Deriv API in 1100.94ms
[18-Nov-2025 01:08:29 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:08:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:29
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:30 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:08:30 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:08:39 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:08:39 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:39
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:39 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:08:28
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:08:39 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:08:28
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:08:39 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:39 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:39 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:39 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:39 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:39 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:39 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:39 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:39 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:08:39 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:39 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:39 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:39 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:39 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:39 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:39 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:39 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:39 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:08:39 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:39 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:08:39 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:08:39 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:08:39 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:08:39 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:08:41 UTC] WebSocket connection established to Deriv API in 1142.54ms
[18-Nov-2025 01:08:41 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:08:41 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:41 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:08:41 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:08:50 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:08:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:50
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:51 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:08:39
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:08:51 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:08:39
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:08:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:08:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:08:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:08:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:08:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:08:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:08:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:08:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:08:51 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:08:51 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:08:51 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:08:51 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:08:51 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:08:51 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:08:51 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:08:52 UTC] WebSocket connection established to Deriv API in 1202.18ms
[18-Nov-2025 01:08:52 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:08:52 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:08:52
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:08:52 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:08:53 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:09:02 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:09:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:08:51
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:09:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:08:51
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:09:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:09:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:09:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:03 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:09:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:09:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:09:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:09:03 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:09:05 UTC] WebSocket connection established to Deriv API in 1147.15ms
[18-Nov-2025 01:09:05 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:09:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:05 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:09:05 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:09:14 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:09:15 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:14
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:15 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:09:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:09:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:09:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:09:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:09:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:15 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:09:15 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:15 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:09:15 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:09:15 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:09:15 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:09:15 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:09:16 UTC] WebSocket connection established to Deriv API in 1239.42ms
[18-Nov-2025 01:09:16 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:09:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:17 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:09:17 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:09:26 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:09:27 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:26
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:27 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:09:15
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:09:27 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:09:15
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:09:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:27 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:09:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:27 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:09:27 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:27 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:09:27 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:09:27 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:09:27 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:09:27 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:09:28 UTC] WebSocket connection established to Deriv API in 1093.52ms
[18-Nov-2025 01:09:28 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:09:28 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:28 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:09:28 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:09:37 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:09:38 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:37
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:38 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:09:27
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:09:38 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:09:27
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:09:38 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:09:27
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:09:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:38 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:38 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:38 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:09:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:38 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:38 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:38 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:09:38 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:38 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:09:38 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:09:38 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:09:38 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:09:38 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:09:39 UTC] WebSocket connection established to Deriv API in 1162.56ms
[18-Nov-2025 01:09:39 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:09:39 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:39
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:39 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:09:40 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:09:49 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:09:49 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:49
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:49 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:09:38
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:09:49 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:09:38
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:09:49 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:49 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:09:49 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:09:49 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:49 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:09:49 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:09:49 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:09:49 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:09:49 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:09:49 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:09:51 UTC] WebSocket connection established to Deriv API in 1173.05ms
[18-Nov-2025 01:09:51 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:09:51 UTC] WebSocket connection established to Deriv API in 1143ms
[18-Nov-2025 01:09:51 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:09:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:51
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:51 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:09:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:09:51
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:09:51 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:09:51 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:09:51 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:10:00 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:10:00 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:10:01 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:00
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:01 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:09:49
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:10:01 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:09:49
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:10:01 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:00
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:01 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:09:49
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:10:01 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:09:49
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:10:01 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:09:49
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:10:01 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:01 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:01 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:01 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:01 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:01 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:01 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:01 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:01 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:10:01 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:01 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:01 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:01 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:01 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:01 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:01 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:01 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:01 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:10:01 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:01 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:10:01 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:10:01 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:10:01 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:10:01 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:10:02 UTC] WebSocket connection established to Deriv API in 1085.78ms
[18-Nov-2025 01:10:02 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:10:03 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:03 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:10:03 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:10:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:07 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:10:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:10:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:07 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:10:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:10:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:10:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:10:07 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:10:08 UTC] WebSocket connection established to Deriv API in 1124.17ms
[18-Nov-2025 01:10:08 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:10:08 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:08
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:08 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:10:09 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:10:12 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:10:13 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:12
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:13 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:10:01
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:10:13 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:10:01
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:10:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:13 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:10:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:13 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:10:13 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:13 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:10:13 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:10:13 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:10:13 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:10:13 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:10:14 UTC] WebSocket connection established to Deriv API in 1117.83ms
[18-Nov-2025 01:10:14 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:10:14 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:14
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:14 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:10:14 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:10:18 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:10:18 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:18
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:18 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:10:07
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:10:18 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:10:07
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:10:18 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:10:07
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:10:23 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:10:24 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:23
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:24 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:10:13
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:10:24 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:10:13
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:10:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:24 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:10:24 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:24 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:24 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:24 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:24 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:24 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:24 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:24 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:24 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:10:24 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:24 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:10:24 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:10:24 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:10:24 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:10:24 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:10:25 UTC] WebSocket connection established to Deriv API in 1157.31ms
[18-Nov-2025 01:10:25 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:10:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:26 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:10:26 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:10:35 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:10:35 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:35
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:35 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:10:24
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:10:35 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:10:24
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:10:35 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:35 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:35 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:35 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:35 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:35 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:35 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:35 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:35 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:10:35 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:35 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:35 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:35 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:35 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:35 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:35 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:35 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:35 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:10:35 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:35 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:10:35 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:10:35 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:10:35 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:10:35 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:10:36 UTC] WebSocket connection established to Deriv API in 1117.44ms
[18-Nov-2025 01:10:36 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:10:37 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:36
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:37 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:10:37 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:10:46 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:10:47 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:46
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:47 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:10:35
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:10:47 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:10:35
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:10:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:47 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:10:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:47 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:10:47 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:47 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:10:47 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:10:47 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:10:47 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:10:47 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:10:48 UTC] WebSocket connection established to Deriv API in 1137.22ms
[18-Nov-2025 01:10:48 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:10:49 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:48
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:49 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:10:49 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:10:58 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:10:58 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:10:58
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:10:58 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:10:47
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:10:58 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:10:47
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:10:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:58 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:10:58 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:10:58 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:10:58 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:10:58 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:10:58 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:58 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:10:58 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:10:58 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:10:58 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:10:58 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:10:58 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:10:58 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:10:58 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:10:58 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:10:58 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:11:00 UTC] WebSocket connection established to Deriv API in 1198.5ms
[18-Nov-2025 01:11:00 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:11:00 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:00
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:00 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:11:00 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:11:09 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:11:10 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:09
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:10 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:10:58
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:11:10 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:10:58
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:11:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:10 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:10 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:10 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:11:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:10 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:10 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:10 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:11:10 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:10 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:11:10 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:11:10 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:11:10 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:11:10 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:11:11 UTC] WebSocket connection established to Deriv API in 1248.54ms
[18-Nov-2025 01:11:11 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:11:12 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:11
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:12 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:11:12 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:11:21 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:11:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:21 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:11:10
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:11:21 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:11:10
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:11:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:21 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:11:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:21 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:21 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:21 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:11:21 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:21 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:11:21 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:11:21 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:11:21 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:11:21 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:11:23 UTC] WebSocket connection established to Deriv API in 1167.12ms
[18-Nov-2025 01:11:23 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:11:23 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:23
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:23 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:11:23 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:11:32 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:11:33 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:32
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:33 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:11:21
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:11:33 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:11:21
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:11:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:33 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:33 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:33 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:11:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:33 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:33 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:33 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:11:33 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:33 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:11:33 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:11:33 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:11:33 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:11:33 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:11:34 UTC] WebSocket connection established to Deriv API in 1125.45ms
[18-Nov-2025 01:11:34 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:11:35 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:34
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:35 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:11:35 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:11:44 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:11:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:44
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:44 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:11:33
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:11:44 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:11:33
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:11:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:45 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:11:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:45 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:11:45 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:45 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:11:45 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:11:45 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:11:45 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:11:45 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:11:46 UTC] WebSocket connection established to Deriv API in 1190.77ms
[18-Nov-2025 01:11:46 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:11:46 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:46
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:46 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:11:46 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:11:55 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:11:56 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:56 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:11:45
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:11:56 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:11:45
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:11:56 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:56 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:56 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:56 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:56 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:56 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:56 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:56 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:56 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:11:56 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:11:56 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:11:56 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:11:56 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:11:56 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:56 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:11:56 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:11:56 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:11:56 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:11:56 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:11:56 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:11:56 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:11:56 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:11:56 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:11:56 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:11:58 UTC] WebSocket connection established to Deriv API in 1457.16ms
[18-Nov-2025 01:11:58 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:11:58 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:11:58
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:11:58 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:11:59 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:12:08 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:12:08 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:08
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:08 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:11:56
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:12:08 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:11:56
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:12:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:12:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:08 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:12:08 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:08 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:12:08 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:12:08 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:12:08 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:12:08 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:12:09 UTC] WebSocket connection established to Deriv API in 1128.13ms
[18-Nov-2025 01:12:09 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:12:10 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:09
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:10 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:12:10 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:12:19 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:12:20 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:20 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:12:08
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:12:20 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:12:08
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:12:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:20 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:12:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:20 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:12:20 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:20 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:12:20 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:12:20 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:12:20 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:12:20 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:12:21 UTC] WebSocket connection established to Deriv API in 1212.11ms
[18-Nov-2025 01:12:21 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:12:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:21 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:12:22 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:12:31 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:12:31 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:31
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:31 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:12:20
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:12:31 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:12:20
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:12:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:31 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:12:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:31 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:12:31 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:31 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:12:31 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:12:31 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:12:31 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:12:31 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:12:32 UTC] WebSocket connection established to Deriv API in 1078.27ms
[18-Nov-2025 01:12:32 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:12:33 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:32
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:33 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:12:33 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:12:42 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:12:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:42
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:42 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:12:31
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:12:42 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:12:31
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:12:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:42 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:12:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:42 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:12:42 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:42 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:12:42 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:12:42 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:12:42 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:12:42 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:12:44 UTC] WebSocket connection established to Deriv API in 1161.71ms
[18-Nov-2025 01:12:44 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:12:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:44
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:44 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:12:44 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:12:53 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:12:54 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:53
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:54 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:12:42
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:12:54 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:12:42
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:12:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:12:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:12:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:12:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:12:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:12:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:12:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:12:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:12:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:12:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:12:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:12:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:12:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:12:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:12:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:12:55 UTC] WebSocket connection established to Deriv API in 1130.31ms
[18-Nov-2025 01:12:55 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:12:55 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:12:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:12:55 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:12:56 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:13:05 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:13:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:12:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:13:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:12:54
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:13:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:13:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:13:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:13:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:13:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:13:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:13:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:13:07 UTC] WebSocket connection established to Deriv API in 2081.11ms
[18-Nov-2025 01:13:07 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:13:08 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:07
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:08 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:13:08 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:13:17 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:13:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:17
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:17 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:13:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:13:17 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:13:05
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:13:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:17 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:13:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:17 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:13:17 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:17 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:13:17 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:13:17 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:13:17 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:13:17 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:13:19 UTC] WebSocket connection established to Deriv API in 1112.62ms
[18-Nov-2025 01:13:19 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:13:19 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:19 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:13:19 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:13:28 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:13:29 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:29 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:13:17
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:13:29 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:13:17
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:13:29 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:29 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:29 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:29 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:29 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:29 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:29 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:29 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:29 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:13:29 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:29 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:29 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:29 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:29 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:29 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:29 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:29 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:29 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:13:29 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:29 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:13:29 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:13:29 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:13:29 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:13:29 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:13:30 UTC] WebSocket connection established to Deriv API in 1045.09ms
[18-Nov-2025 01:13:30 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:13:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:30
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:30 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:13:31 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:13:40 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:13:40 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:40
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:40 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:13:29
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:13:40 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:13:29
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:13:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:40 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:13:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:40 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:13:40 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:40 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:13:40 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:13:40 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:13:40 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:13:40 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:13:41 UTC] WebSocket connection established to Deriv API in 1041.81ms
[18-Nov-2025 01:13:41 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:13:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:42 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:13:42 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:13:51 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:13:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:51
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:51 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:13:40
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:13:51 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:13:40
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:13:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:13:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:13:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:13:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:13:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:13:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:13:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:13:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:13:51 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:13:51 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:13:51 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:13:51 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:13:51 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:13:51 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:13:51 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:13:52 UTC] WebSocket connection established to Deriv API in 1088.21ms
[18-Nov-2025 01:13:52 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:13:53 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:13:52
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:13:53 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:13:53 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:14:02 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:14:03 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:14:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:14:03 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:13:51
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:14:03 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:13:51
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:14:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:14:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:14:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:14:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:14:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:14:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:14:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:14:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:14:03 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:14:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:14:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:14:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:14:03 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:14:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:14:03 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:14:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:14:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:14:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:14:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:14:03 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:14:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:14:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:14:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:14:03 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:14:04 UTC] WebSocket connection established to Deriv API in 1083.78ms
[18-Nov-2025 01:14:04 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:14:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:14:04
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:14:04 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:14:04 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:14:13 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:14:14 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:14:13
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:14:14 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:14:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:14:14 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:14:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:14:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:14:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:14:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:14:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:14:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:14:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:32:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:08 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:32:08 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:08 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:08 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:08 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:08 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:08 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:08 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:08 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:08 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:32:08 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:08 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:32:08 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:32:08 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:32:08 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:32:08 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:32:09 UTC] WebSocket connection established to Deriv API in 1188.14ms
[18-Nov-2025 01:32:09 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:32:10 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:32:09
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:32:10 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:32:10 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:32:19 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:32:19 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:32:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:32:19 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:32:08
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:32:19 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:32:08
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:32:19 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:32:08
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:32:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:19 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:32:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:19 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:32:19 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:19 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:32:19 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:32:19 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:32:19 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:32:19 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:32:21 UTC] WebSocket connection established to Deriv API in 1104.7ms
[18-Nov-2025 01:32:21 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:32:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:32:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:32:21 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:32:21 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:32:30 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:32:31 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:32:30
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:32:31 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:32:19
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:32:31 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:32:19
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:32:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:31 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:32:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:31 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:32:31 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:31 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:32:31 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:32:31 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:32:31 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:32:31 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:32:32 UTC] WebSocket connection established to Deriv API in 1078.53ms
[18-Nov-2025 01:32:32 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:32:32 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:32:32
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:32:32 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:32:32 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:32:41 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:32:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:32:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:32:42 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:32:31
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:32:42 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:32:31
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:32:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:42 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:32:42 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:42 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:42 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:42 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:42 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:42 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:42 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:42 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:42 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:32:42 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:42 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:32:42 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:32:42 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:32:42 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:32:42 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:32:43 UTC] WebSocket connection established to Deriv API in 1182.94ms
[18-Nov-2025 01:32:43 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:32:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:32:43
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:32:44 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:32:44 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:32:53 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:32:53 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:32:53
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:32:53 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:32:42
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:32:53 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:32:42
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:32:53 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:53 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:53 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:53 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:53 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:53 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:53 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:53 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:53 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:32:53 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:32:53 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:32:53 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:32:53 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:32:53 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:53 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:32:53 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:32:53 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:32:53 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:32:53 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:32:53 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:32:53 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:32:53 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:32:53 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:32:53 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:32:55 UTC] WebSocket connection established to Deriv API in 1157.73ms
[18-Nov-2025 01:32:55 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:32:55 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:32:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:32:55 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:32:55 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:33:04 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:33:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:33:04
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:33:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:32:53
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:33:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:32:53
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:33:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:33:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:33:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:33:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:33:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:33:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:33:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:33:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:33:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:33:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:33:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:33:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:33:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:33:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:33:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:33:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:33:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:33:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:33:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:33:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:33:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:33:06 UTC] WebSocket connection established to Deriv API in 1109.31ms
[18-Nov-2025 01:33:06 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:33:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:33:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:33:07 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:33:07 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:33:16 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:33:16 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:33:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:33:16 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:33:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:33:16 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:33:05
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:33:36 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:33:36 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:33:36 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:33:36 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:33:36 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:36 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:33:36 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:33:36 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:33:36 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:33:36 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:33:36 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:33:36 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:33:36 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:33:36 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:36 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:33:36 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:33:36 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:33:36 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:33:36 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:36 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:33:36 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:33:36 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:33:36 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:33:36 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:33:37 UTC] WebSocket connection established to Deriv API in 1136.69ms
[18-Nov-2025 01:33:37 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:33:38 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:33:37
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:33:38 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:33:38 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:33:47 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:33:47 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:33:47
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:33:47 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:33:36
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:33:47 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:33:36
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:33:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:33:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:33:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:33:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:33:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:33:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:33:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:33:47 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:33:47 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:33:47 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:33:47 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:33:47 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:33:47 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:47 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:33:47 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:33:47 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:33:47 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:33:47 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:47 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:33:47 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:33:47 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:33:47 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:33:47 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:33:49 UTC] WebSocket connection established to Deriv API in 1154.03ms
[18-Nov-2025 01:33:49 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:33:49 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:33:49
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:33:49 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:33:49 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:33:58 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:33:59 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:33:58
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:33:59 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:33:47
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:33:59 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:33:47
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:33:59 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:33:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:33:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:33:59 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:33:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:59 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:33:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:33:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:33:59 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:33:59 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:33:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:33:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:33:59 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:33:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:59 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:33:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:33:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:33:59 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:33:59 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:33:59 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:33:59 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:33:59 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:33:59 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:33:59 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:34:00 UTC] WebSocket connection established to Deriv API in 1059.46ms
[18-Nov-2025 01:34:00 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:34:01 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:00
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:01 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:34:01 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:34:10 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:34:10 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:10
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:10 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:33:59
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:34:10 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:33:59
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:34:10 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:33:59
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:34:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:10 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:10 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:10 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:34:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:10 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:10 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:10 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:34:10 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:10 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:34:10 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:34:10 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:34:10 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:34:10 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:34:11 UTC] WebSocket connection established to Deriv API in 1059.92ms
[18-Nov-2025 01:34:11 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:34:12 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:11
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:12 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:34:12 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:34:21 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:34:22 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:22 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:34:10
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:34:22 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:34:10
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:34:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:22 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:34:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:22 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:22 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:22 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:22 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:22 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:22 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:22 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:22 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:34:22 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:22 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:34:22 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:34:22 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:34:22 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:34:22 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:34:23 UTC] WebSocket connection established to Deriv API in 1326.53ms
[18-Nov-2025 01:34:23 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:34:24 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:23
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:24 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:34:24 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:34:33 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:34:33 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:33
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:33 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:34:22
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:34:33 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:34:22
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:34:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:33 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:33 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:33 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:34:33 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:33 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:33 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:33 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:33 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:33 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:33 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:33 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:33 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:34:33 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:33 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:34:33 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:34:33 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:34:33 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:34:33 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:34:35 UTC] WebSocket connection established to Deriv API in 1088.55ms
[18-Nov-2025 01:34:35 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:34:35 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:35
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:35 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:34:35 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:34:44 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:34:45 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:44
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:45 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:34:33
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:34:45 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:34:33
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:34:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:45 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:34:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:45 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:45 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:45 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:45 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:34:45 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:45 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:34:45 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:34:45 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:34:45 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:34:45 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:34:46 UTC] WebSocket connection established to Deriv API in 1127.15ms
[18-Nov-2025 01:34:46 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:34:46 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:46
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:46 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:34:46 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:34:55 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:34:56 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:56 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:34:45
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:34:56 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:34:45
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:34:56 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:56 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:56 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:56 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:56 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:56 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:56 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:56 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:56 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:34:56 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:34:56 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:34:56 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:34:56 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:34:56 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:56 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:34:56 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:34:56 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:34:56 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:34:56 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:34:56 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:34:56 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:34:56 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:34:56 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:34:56 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:34:57 UTC] WebSocket connection established to Deriv API in 1186.24ms
[18-Nov-2025 01:34:57 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:34:58 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:34:57
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:34:58 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:34:58 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:35:07 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:35:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:07
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:07 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:34:56
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:35:07 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:34:56
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:35:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:07 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:35:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:07 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:07 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:35:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:07 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:35:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:35:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:35:08 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:35:08 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:35:09 UTC] WebSocket connection established to Deriv API in 1070.38ms
[18-Nov-2025 01:35:09 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:35:09 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:09
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:09 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:35:09 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:35:18 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:35:19 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:18
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:19 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:35:08
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:35:19 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:35:07
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:35:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:19 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:35:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:19 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:19 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:19 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:35:19 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:19 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:35:19 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:35:19 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:35:19 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:35:19 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:35:20 UTC] WebSocket connection established to Deriv API in 1121.28ms
[18-Nov-2025 01:35:20 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:35:20 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:20
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:20 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:35:21 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:35:30 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:35:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:30
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:30 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:35:19
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:35:30 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:35:19
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:35:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:30 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:30 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:30 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:35:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:30 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:30 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:30 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:30 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:35:30 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:30 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:35:30 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:35:30 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:35:30 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:35:30 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:35:33 UTC] WebSocket connection established to Deriv API in 2473.39ms
[18-Nov-2025 01:35:33 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:35:33 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:33
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:33 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:35:33 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:35:42 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:35:43 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:42
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:43 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:35:30
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:35:43 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:35:30
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:35:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:43 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:35:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:43 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:35:43 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:43 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:35:43 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:35:43 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:35:43 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:35:43 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:35:44 UTC] WebSocket connection established to Deriv API in 1135.37ms
[18-Nov-2025 01:35:44 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:35:45 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:44
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:45 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:35:45 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:35:54 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:35:54 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:54
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:54 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:35:43
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:35:54 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:35:43
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:35:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:35:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:35:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:35:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:35:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:35:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:35:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:35:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:35:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:35:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:35:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:35:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:35:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:35:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:35:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:35:56 UTC] WebSocket connection established to Deriv API in 1103.55ms
[18-Nov-2025 01:35:56 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:35:56 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:35:56
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:35:56 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:35:56 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:36:05 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:36:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:06 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:35:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:36:06 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:35:54
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:36:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:06 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:06 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:06 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:36:06 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:06 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:06 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:06 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:36:06 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:06 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:36:06 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:36:06 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:36:06 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:36:06 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:36:07 UTC] WebSocket connection established to Deriv API in 1143.96ms
[18-Nov-2025 01:36:07 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:36:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:07
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:07 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:36:08 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:36:17 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:36:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:17
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:17 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:36:06
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:36:17 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:36:06
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:36:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:17 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:36:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:17 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:36:17 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:17 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:36:17 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:36:17 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:36:17 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:36:17 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:36:18 UTC] WebSocket connection established to Deriv API in 1044.2ms
[18-Nov-2025 01:36:18 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:36:19 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:18
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:19 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:36:19 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:36:28 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:36:28 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:28 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:36:17
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:36:28 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:36:17
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:36:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:28 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:36:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:28 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:36:28 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:28 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:36:28 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:36:28 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:36:28 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:36:28 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:36:29 UTC] WebSocket connection established to Deriv API in 1096.45ms
[18-Nov-2025 01:36:29 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:36:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:29
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:30 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:36:30 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:36:39 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:36:40 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:39
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:40 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:36:28
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:36:40 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:36:28
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:36:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:40 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:36:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:40 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:36:40 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:40 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:36:40 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:36:40 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:36:40 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:36:40 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:36:41 UTC] WebSocket connection established to Deriv API in 1074.62ms
[18-Nov-2025 01:36:41 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:36:41 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:41
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:41 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:36:42 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:36:51 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:36:51 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:51
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:51 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:36:40
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:36:51 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:36:40
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:36:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:36:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:36:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:36:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:36:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:36:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:36:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:36:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:36:51 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:36:51 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:36:51 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:36:51 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:36:51 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:36:51 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:36:51 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:36:52 UTC] WebSocket connection established to Deriv API in 1103.69ms
[18-Nov-2025 01:36:52 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:36:53 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:36:52
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:36:53 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:36:53 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:37:02 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:37:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:37:02
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:37:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:36:51
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:37:02 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:36:51
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:37:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:37:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:37:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:37:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:37:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:37:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:37:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:37:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:37:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:37:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:37:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:37:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:37:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:37:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:37:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:37:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:37:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:37:02 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:37:02 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:37:02 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:37:02 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:37:02 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:37:02 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:37:02 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:37:03 UTC] WebSocket connection established to Deriv API in 1107.51ms
[18-Nov-2025 01:37:03 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:37:04 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:37:03
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:37:04 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:37:04 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:37:13 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:37:14 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:37:13
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:37:14 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:37:02
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:37:14 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:37:02
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:37:14 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:37:14 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:37:14 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:37:14 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:37:14 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:37:14 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:37:14 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:37:14 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:37:14 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:37:14 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:37:14 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:37:14 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:37:14 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:37:14 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:37:14 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:37:14 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:37:14 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:37:14 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:14 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:37:15 UTC] WebSocket connection established to Deriv API in 1261.58ms
[18-Nov-2025 01:37:15 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:37:15 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:37:15
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:37:15 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:37:16 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:37:25 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:37:25 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:37:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:37:25 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:37:14
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:37:25 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:37:14
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:39:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:39:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:39:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:39:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:39:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:39:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:39:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:39:20 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:39:20 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:39:20 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:39:20 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:39:20 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:39:20 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:20 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:39:20 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:39:20 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:39:20 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:39:20 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:20 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:39:20 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:39:20 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:39:20 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:39:20 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:39:21 UTC] WebSocket connection established to Deriv API in 1108.06ms
[18-Nov-2025 01:39:21 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:39:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:39:21
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:39:21 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:39:22 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:39:31 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:39:31 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:39:31
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:39:31 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:39:20
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:39:31 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:39:20
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:39:31 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:39:20
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:39:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:39:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:39:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:39:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:39:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:39:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:39:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:39:31 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:39:31 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:39:31 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:39:31 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:39:31 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:39:31 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:31 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:39:31 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:39:31 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:39:31 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:39:31 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:31 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:39:31 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:39:31 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:39:31 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:39:31 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:39:32 UTC] WebSocket connection established to Deriv API in 1124.36ms
[18-Nov-2025 01:39:32 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:39:33 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:39:32
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:39:33 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:39:33 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:39:42 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:39:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:39:42
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:39:42 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:39:31
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:39:42 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:39:31
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:39:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:39:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:39:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:39:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:39:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:39:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:39:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:39:43 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:39:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:39:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:39:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:39:43 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:39:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:43 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:39:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:39:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:39:43 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:39:43 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:43 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:39:43 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:39:43 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:39:43 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:39:43 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:39:44 UTC] WebSocket connection established to Deriv API in 1151.01ms
[18-Nov-2025 01:39:44 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:39:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:39:44
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:39:44 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:39:44 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:39:53 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:39:54 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:39:53
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:39:54 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:39:43
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:39:54 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:39:43
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:39:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:39:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:39:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:39:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:39:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:39:54 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:39:54 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:39:54 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:39:54 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:39:54 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:54 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:39:54 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:39:54 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:39:54 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\autoload.php on line 83
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\api\realtime.php on line 41
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_k4ifnmotatm0aajclnd35h7dp1, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\vtmoption\app\middleware\AuthMiddleware.php on line 25
[18-Nov-2025 01:39:54 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:39:54 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:39:55 UTC] WebSocket connection established to Deriv API in 1135.53ms
[18-Nov-2025 01:39:55 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:39:56 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:39:55
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:39:56 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:39:56 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:40:05 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:40:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:40:05
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:40:05 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:39:54
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:40:05 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:39:54
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:42:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:42:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:42:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:42:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:42:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:42:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:42:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:42:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:42:44 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:42:44 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:42:44 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:42:44 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:42:44 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:42:44 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:42:44 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:42:44 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:42:44 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:42:44 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:42:44 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:42:44 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:42:44 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:42:44 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:42:44 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:42:44 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#5 {main}
[18-Nov-2025 01:42:55 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:42:55 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:42:44
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 01:42:55 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:42:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:42:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:42:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:42:55 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:42:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:42:55 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:42:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:42:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:42:55 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:42:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:42:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:42:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:42:55 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:42:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:42:55 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:42:55 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:42:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:42:55 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:43:06 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 01:43:06 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:43:06 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#5 {main}
[18-Nov-2025 01:43:06 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:43:06 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:42:55
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 01:43:06 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:43:06 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:42:44
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 0.5s before retry
  - Recreating connection
Step 5: Attempt 2/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 01:43:06 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:42:44
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 0.5s before retry
  - Recreating connection
Step 5: Attempt 2/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 01:43:06 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:42:44
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 0
Step 4: Balance type: double
Step 4: Balance value: 0.0
Step 5: Preparing response: {"balance":0,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":0}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:44:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:44:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:44:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:44:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:44:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:44:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:44:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:44:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:44:17 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:44:17 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:44:17 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:44:17 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:44:17 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:44:17 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:44:17 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:44:17 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:44:17 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:44:17 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:44:17 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:44:17 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:44:17 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:44:17 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:44:17 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:44:17 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:44:19 UTC] WebSocket connection established to Deriv API in 1349.9ms
[18-Nov-2025 01:44:19 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:44:19 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:44:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:44:19 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:44:19 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:44:28 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:44:29 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:44:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:44:29 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:44:17
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:44:29 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:44:17
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:44:29 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:44:17
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:46:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:46:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:46:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:46:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:46:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:46:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:46:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:46:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:46:05 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:46:05 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:46:05 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:46:05 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:46:05 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:46:05 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:46:05 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:46:05 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:46:05 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:46:05 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:46:05 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:46:05 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:46:05 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:46:05 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:46:05 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:46:05 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:46:06 UTC] WebSocket connection established to Deriv API in 1243.57ms
[18-Nov-2025 01:46:06 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:46:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:46:06
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:46:06 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:46:07 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:46:16 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:46:16 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:46:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:46:16 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:46:05
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:46:16 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:46:05
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:46:16 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:46:05
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:49:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:49:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:49:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:49:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:49:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:49:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:49:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:49:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:49:28 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:49:28 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:49:28 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:49:28 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:49:28 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:49:28 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:49:28 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:49:28 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:49:28 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:49:28 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:49:28 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:49:28 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:49:28 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:49:28 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:49:28 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:49:28 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#5 {main}
[18-Nov-2025 01:49:40 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:49:40 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:49:28
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 01:49:40 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:49:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:49:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:49:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:49:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:49:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:49:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:49:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:49:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:49:40 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:49:40 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:49:40 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:49:40 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:49:40 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:49:40 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:49:40 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:49:40 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:49:40 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:49:40 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#5 {main}
[18-Nov-2025 01:49:51 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:49:51 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:49:40
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 01:49:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:49:51 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:49:28
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 0.5s before retry
  - Recreating connection
Step 5: Attempt 2/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 01:49:51 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:49:28
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 0.5s before retry
  - Recreating connection
Step 5: Attempt 2/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 01:49:51 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:49:28
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 0
Step 4: Balance type: double
Step 4: Balance value: 0.0
Step 5: Preparing response: {"balance":0,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":0}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:49:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:49:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:49:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:49:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:49:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:49:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:49:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:49:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:49:51 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:49:51 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:49:51 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:49:51 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:49:51 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:49:51 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:49:51 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:49:51 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:49:51 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:49:51 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 01:50:02 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:50:02 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:49:51
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 01:50:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:02 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:02 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:02 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:02 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:02 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:02 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:02 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:02 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:02 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:50:02 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] ERROR: WebSocket connection failed
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] Exception message: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] Exception trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(138): App\Services\WebSocketClient->connect()
#1 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#2 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#4 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#5 {main}
[18-Nov-2025 01:50:13 UTC] WebSocket connection failed: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
[18-Nov-2025 01:50:13 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:50:02
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== DerivAPI::getBalance FAILED ===
[18-Nov-2025 01:50:13 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:13 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:49:51
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 0.5s before retry
  - Recreating connection
Step 5: Attempt 2/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
[18-Nov-2025 01:50:13 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:49:51
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 1 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
  - Waiting 0.5s before retry
  - Recreating connection
Step 5: Attempt 2/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Attempt 2 FAILED: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
  - Connection error detected, closing connection
Step 5 FAILED: All retries exhausted
  - Last error: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
=== TradingBotService::getAccountBalance FAILED ===
EXCEPTION CAUGHT: Failed to connect to Deriv API: DNS resolution failed for ws.derivws.com. Check your network connection and DNS settings.
Exception type: Exception
Stack trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(451): App\Services\DerivAPI->ensureConnection()
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
=== TradingBotService::getAccountBalance EXCEPTION ===
[18-Nov-2025 01:50:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:13 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:13 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:13 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:13 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:13 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:13 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:13 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:13 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:13 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:50:13 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:50:15 UTC] WebSocket connection established to Deriv API in 1899.27ms
[18-Nov-2025 01:50:15 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:50:16 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:15
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:16 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:50:16 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:50:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:18 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:18 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:18 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:18 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:18 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:18 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:18 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:18 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:18 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:18 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:50:18 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:18 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:50:18 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:50:18 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:50:18 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:50:18 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:50:19 UTC] WebSocket connection established to Deriv API in 1047.78ms
[18-Nov-2025 01:50:19 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:50:20 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:19
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:20 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:50:20 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:50:23 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:23 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:23 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:23 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:23 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:23 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:23 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:23 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:23 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:23 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:23 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:23 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:23 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:23 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:23 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:23 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:23 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:23 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:50:23 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:23 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:50:23 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:50:23 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:50:23 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:50:23 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:50:25 UTC] WebSocket connection established to Deriv API in 1153.62ms
[18-Nov-2025 01:50:25 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:50:25 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:50:25 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:25 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:50:25 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:25
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:25 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:50:13
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:50:25 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:50:13
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:50:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:25 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:50:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:25 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:25 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:25 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:25 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:25 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:25 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:25 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:25 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:25 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:25 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:50:25 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:25 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:50:25 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:50:25 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:50:25 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:50:25 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:50:26 UTC] WebSocket connection established to Deriv API in 1112.26ms
[18-Nov-2025 01:50:26 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:50:27 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:26
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:27 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:50:27 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:50:29 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:50:29 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:29
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:29 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:50:18
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:50:29 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:50:18
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:50:29 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:50:18
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:50:34 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:50:35 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:34
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:35 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:50:23
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:50:35 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:50:23
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:50:35 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-18 01:50:23
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[18-Nov-2025 01:50:36 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:50:37 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:36
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:37 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:50:25
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:50:37 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:50:25
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:50:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:37 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:37 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:37 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:37 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:37 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:37 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:50:37 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:37 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:50:37 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:50:37 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:50:37 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:50:37 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:50:38 UTC] WebSocket connection established to Deriv API in 1115.68ms
[18-Nov-2025 01:50:38 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:50:38 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:38
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:38 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:50:38 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:50:47 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:50:48 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:47
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:48 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:50:37
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:50:48 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:50:37
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:50:48 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:48 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:48 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:48 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:48 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:48 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:48 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:48 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:48 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:48 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:48 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:48 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:48 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:48 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:48 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:48 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:48 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:48 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:50:48 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:48 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:50:48 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:50:48 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:50:48 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:50:48 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:50:49 UTC] WebSocket connection established to Deriv API in 1111.43ms
[18-Nov-2025 01:50:49 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:50:50 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:49
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:50 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:50:50 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:50:59 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:50:59 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:50:59
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:50:59 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:50:48
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:50:59 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:50:48
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:50:59 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:59 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:59 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:59 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:50:59 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:50:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:50:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:50:59 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:50:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:59 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:50:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:50:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:50:59 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:50:59 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:50:59 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:50:59 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:50:59 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:50:59 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:50:59 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:51:01 UTC] WebSocket connection established to Deriv API in 1054.86ms
[18-Nov-2025 01:51:01 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:51:02 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:51:01
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:51:02 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:51:03 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:51:13 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:51:14 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:51:13
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:51:15 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:50:59
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:51:15 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:50:59
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:51:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:51:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:51:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:51:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:51:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:51:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:51:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:51:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:51:15 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:51:15 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:51:15 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:51:15 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:51:15 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:51:15 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:51:15 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:51:15 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:51:15 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:51:15 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:51:15 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:51:15 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:51:15 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:51:15 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:51:15 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:51:15 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:51:16 UTC] WebSocket connection established to Deriv API in 1197.25ms
[18-Nov-2025 01:51:16 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:51:17 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:51:16
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:51:17 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:51:17 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:51:26 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:51:26 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:51:26
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:51:26 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:51:15
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:51:26 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:51:15
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:51:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:51:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:51:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:51:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:51:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:51:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:51:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:51:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:51:27 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:51:27 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:51:27 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:51:27 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:51:27 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:51:27 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:51:27 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:51:27 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:51:27 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:51:27 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:51:27 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:51:27 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:51:27 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:51:27 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:51:27 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:51:27 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:51:28 UTC] WebSocket connection established to Deriv API in 1309.18ms
[18-Nov-2025 01:51:28 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:51:28 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:51:28
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:51:28 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:51:29 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[18-Nov-2025 01:51:38 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[18-Nov-2025 01:51:38 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:51:38
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:51:38 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-18 01:51:27
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtmoption\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtmoption\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtmoption\api\realtime.php(183): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtmoption\api\realtime.php(72): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[18-Nov-2025 01:51:38 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-18 01:51:27
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[18-Nov-2025 01:51:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:51:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:51:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:51:38 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:51:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:51:38 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:51:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:51:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:51:38 UTC] [TradingBotService] Closing connection for user 2
[18-Nov-2025 01:51:38 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[18-Nov-2025 01:51:38 UTC] [DerivAPI] Constructor - Building WebSocket URL
[18-Nov-2025 01:51:38 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[18-Nov-2025 01:51:38 UTC] [DerivAPI] appId: '105326'
[18-Nov-2025 01:51:38 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:51:38 UTC] [DerivAPI] wsUrl length: 48
[18-Nov-2025 01:51:38 UTC] [DerivAPI] wsUrl empty check: NO - OK
[18-Nov-2025 01:51:38 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[18-Nov-2025 01:51:38 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[18-Nov-2025 01:51:38 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[18-Nov-2025 01:51:38 UTC] [DerivAPI::ensureConnection] URL type: string
[18-Nov-2025 01:51:38 UTC] [DerivAPI::ensureConnection] URL length: 48
[18-Nov-2025 01:51:38 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[18-Nov-2025 01:51:38 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[18-Nov-2025 01:51:38 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[18-Nov-2025 01:51:39 UTC] WebSocket connection established to Deriv API in 1140.64ms
[18-Nov-2025 01:51:39 UTC] Not authorized, calling authorize() first
[18-Nov-2025 01:51:40 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-18 01:51:39
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[18-Nov-2025 01:51:40 UTC] Sending WebSocket request: account (req_id: 1)
[18-Nov-2025 01:51:40 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 01:04:22 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[19-Nov-2025 01:04:23 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 01:04:23 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 01:04:23 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 01:04:23 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 01:04:23 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 01:04:23 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 01:04:23 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 01:04:23 UTC] [TradingBotService] Closing connection for user 2
[19-Nov-2025 01:04:23 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[19-Nov-2025 01:04:23 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 01:04:23 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 01:04:23 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 01:04:23 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 01:04:23 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 01:04:23 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 01:04:23 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 01:04:23 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 01:04:23 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 01:04:23 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 01:04:23 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 01:04:23 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 01:04:23 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 01:04:23 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 01:04:24 UTC] WebSocket connection established to Deriv API in 1597.09ms
[19-Nov-2025 01:04:24 UTC] Not authorized, calling authorize() first
[19-Nov-2025 01:04:25 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 01:04:24
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 01:04:25 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 01:04:25 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 01:04:34 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 01:04:34 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 01:04:34
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 01:04:34 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 01:04:23
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 01:04:34 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-19 01:04:22
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 01:04:34 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-19 01:04:22
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 01:14:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[19-Nov-2025 01:14:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 01:14:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 01:14:07 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 01:14:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 01:14:07 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 01:14:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 01:14:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 01:14:07 UTC] [TradingBotService] Closing connection for user 2
[19-Nov-2025 01:14:07 UTC] [TradingBotService] Creating new DerivAPI connection for user 2
[19-Nov-2025 01:14:07 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 01:14:07 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 01:14:07 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 01:14:07 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 01:14:07 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 01:14:07 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 01:14:07 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 01:14:07 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 01:14:07 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 01:14:07 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 01:14:07 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 01:14:07 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 01:14:07 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 01:14:07 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 01:14:08 UTC] WebSocket connection established to Deriv API in 1216.05ms
[19-Nov-2025 01:14:08 UTC] Not authorized, calling authorize() first
[19-Nov-2025 01:14:09 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 01:14:08
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 01:14:09 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 01:14:09 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 01:14:18 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 01:14:18 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 01:14:18
Token length: 15
Token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"5mP5OrmfRtbDu3K"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 01:14:18 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 01:14:07
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(2)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(2)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 01:14:18 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 2 ===
Timestamp: 2025-11-19 01:14:07
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 78b880d92b8fdf353c8eb2e4626e1203:66667097a9231ff65...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: 5mP5OrmfRtbDu3K...rmfRtbDu3K
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 01:14:18 UTC] [handleGetBalance] === handleGetBalance START for user 2 ===
Timestamp: 2025-11-19 01:14:07
Step 1: Querying database for user 2
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-17 13:31:04
  - Token last used: 2025-11-17 13:31:04
Step 3: Calling TradingBotService->getAccountBalance(2)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 03:13:41 UTC] Login error: Query failed: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'is_admin' in 'field list'
[19-Nov-2025 03:13:49 UTC] Login error: Query failed: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'is_admin' in 'field list'
[19-Nov-2025 03:13:51 UTC] Login error: Query failed: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'is_admin' in 'field list'
[19-Nov-2025 03:13:52 UTC] Login error: Query failed: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'is_admin' in 'field list'
[19-Nov-2025 03:20:50 UTC] Login error: Query failed: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'is_admin' in 'field list'
[19-Nov-2025 03:20:56 UTC] Login error: Query failed: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'is_admin' in 'field list'
[19-Nov-2025 03:21:04 UTC] Login error: Query failed: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'is_admin' in 'field list'
[19-Nov-2025 03:25:04 UTC] Login error: Query failed: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'is_admin' in 'field list'
[19-Nov-2025 03:26:57 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-19 03:26:57
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: NO
  - Token length: 0
  - Token created: N/A
  - Token last used: N/A
Step 2: No API token found - returning 0 balance
[19-Nov-2025 03:52:59 UTC] Starting Deriv API validation for user 1
[19-Nov-2025 03:52:59 UTC] API token length: 15
[19-Nov-2025 03:52:59 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:52:59 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:52:59 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:52:59 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:52:59 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:52:59 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:52:59 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:52:59 UTC] Calling authorize() to validate token
[19-Nov-2025 03:52:59 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 03:52:59 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:52:59 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 03:52:59 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 03:52:59 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 03:52:59 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 03:52:59 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 03:53:00 UTC] WebSocket connection established to Deriv API in 1441.24ms
[19-Nov-2025 03:53:01 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:52:59
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:53:01 UTC] Authorization successful. LoginID: VRTC1155676
[19-Nov-2025 03:53:01 UTC] Deriv API validation completed successfully
[19-Nov-2025 03:53:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 03:53:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:53:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:53:03 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:53:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:53:03 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:53:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:53:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:53:03 UTC] [TradingBotService] Closing connection for user 1
[19-Nov-2025 03:53:03 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 03:53:03 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:53:03 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:53:03 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:53:03 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:53:03 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:53:03 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:53:03 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:53:03 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 03:53:03 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:53:03 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 03:53:03 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 03:53:03 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 03:53:03 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 03:53:03 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 03:53:04 UTC] WebSocket connection established to Deriv API in 1149.78ms
[19-Nov-2025 03:53:04 UTC] Not authorized, calling authorize() first
[19-Nov-2025 03:53:05 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:53:04
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:53:05 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 03:53:05 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 03:53:14 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 03:53:14 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:53:14
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:53:14 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 03:53:03
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 03:53:14 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-11-19 03:53:03
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 043242d980a3498ac82a7864b58d9293:d08fbc569d98eb9f8...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 03:53:14 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-19 03:53:03
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 03:53:01
  - Token last used: 2025-11-19 03:53:01
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 03:54:06 UTC] Starting Deriv API validation for user 1
[19-Nov-2025 03:54:06 UTC] API token length: 15
[19-Nov-2025 03:54:06 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:54:06 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:54:06 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:54:06 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:54:06 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:54:06 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:54:06 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:54:06 UTC] Calling authorize() to validate token
[19-Nov-2025 03:54:06 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 03:54:06 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:54:06 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 03:54:06 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 03:54:06 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 03:54:06 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 03:54:06 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 03:54:07 UTC] WebSocket connection established to Deriv API in 1122.43ms
[19-Nov-2025 03:54:08 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:54:06
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:54:08 UTC] Authorization successful. LoginID: VRTC1155676
[19-Nov-2025 03:54:08 UTC] Deriv API validation completed successfully
[19-Nov-2025 03:54:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 03:54:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:54:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:54:10 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:54:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:54:10 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:54:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:54:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:54:10 UTC] [TradingBotService] Closing connection for user 1
[19-Nov-2025 03:54:10 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 03:54:10 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:54:10 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:54:10 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:54:10 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:54:10 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:54:10 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:54:10 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:54:10 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 03:54:10 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:54:10 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 03:54:10 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 03:54:10 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 03:54:10 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 03:54:10 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 03:54:11 UTC] WebSocket connection established to Deriv API in 1137.42ms
[19-Nov-2025 03:54:11 UTC] Not authorized, calling authorize() first
[19-Nov-2025 03:54:12 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:54:11
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:54:12 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 03:54:12 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 03:54:21 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 03:54:21 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:54:21
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:54:21 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 03:54:10
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 03:54:21 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-11-19 03:54:10
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 684da5e5bcf84f2fa5a9e34543473ff6:737e9b454300cf1d0...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 03:54:21 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-19 03:54:10
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 03:54:08
  - Token last used: 2025-11-19 03:54:08
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 03:54:56 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 03:54:56 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:54:56 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:54:56 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:54:56 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:54:56 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:54:56 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:54:56 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:54:56 UTC] [TradingBotService] Closing connection for user 1
[19-Nov-2025 03:54:56 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 03:54:56 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:54:56 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:54:56 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:54:56 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:54:56 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:54:56 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:54:56 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:54:56 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 03:54:56 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:54:56 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 03:54:56 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 03:54:56 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 03:54:56 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 03:54:56 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 03:54:58 UTC] WebSocket connection established to Deriv API in 1132.93ms
[19-Nov-2025 03:54:58 UTC] Not authorized, calling authorize() first
[19-Nov-2025 03:54:58 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:54:58
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:54:58 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 03:54:58 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 03:55:07 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 03:55:08 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:55:07
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:55:08 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 03:54:56
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 03:55:08 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-11-19 03:54:56
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 684da5e5bcf84f2fa5a9e34543473ff6:737e9b454300cf1d0...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 03:55:08 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-19 03:54:56
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 03:54:08
  - Token last used: 2025-11-19 03:54:08
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 03:55:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 03:55:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:55:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:55:19 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:55:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:55:19 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:55:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:55:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:55:19 UTC] [TradingBotService] Closing connection for user 1
[19-Nov-2025 03:55:19 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 03:55:19 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 03:55:19 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 03:55:19 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 03:55:19 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:55:19 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 03:55:19 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 03:55:19 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 03:55:19 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 03:55:19 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 03:55:19 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 03:55:19 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 03:55:19 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 03:55:19 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 03:55:19 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 03:55:20 UTC] WebSocket connection established to Deriv API in 1189.54ms
[19-Nov-2025 03:55:20 UTC] Not authorized, calling authorize() first
[19-Nov-2025 03:55:20 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:55:20
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:55:20 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 03:55:21 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 03:55:30 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 03:55:30 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 03:55:30
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 03:55:30 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 03:55:19
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 03:55:30 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-11-19 03:55:19
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 684da5e5bcf84f2fa5a9e34543473ff6:737e9b454300cf1d0...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 03:55:30 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-19 03:55:19
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 03:54:08
  - Token last used: 2025-11-19 03:54:08
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 04:00:00 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 04:00:00 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 04:00:00 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 04:00:00 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 04:00:00 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:00:00 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 04:00:00 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 04:00:00 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 04:00:00 UTC] [TradingBotService] Closing connection for user 1
[19-Nov-2025 04:00:00 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 04:00:00 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 04:00:00 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 04:00:00 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 04:00:00 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:00:00 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 04:00:00 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 04:00:00 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 04:00:00 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 04:00:00 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:00:00 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 04:00:00 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 04:00:00 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 04:00:00 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 04:00:00 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 04:00:01 UTC] WebSocket connection established to Deriv API in 1203.33ms
[19-Nov-2025 04:00:01 UTC] Not authorized, calling authorize() first
[19-Nov-2025 04:00:01 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:00:01
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:00:01 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 04:00:02 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 04:00:11 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 04:00:11 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:00:11
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:00:11 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 04:00:00
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 04:00:11 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-11-19 04:00:00
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 684da5e5bcf84f2fa5a9e34543473ff6:737e9b454300cf1d0...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 04:00:11 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-19 04:00:00
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 03:54:08
  - Token last used: 2025-11-19 03:54:08
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 04:00:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 04:00:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 04:00:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 04:00:21 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 04:00:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:00:21 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 04:00:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 04:00:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 04:00:21 UTC] [TradingBotService] Closing connection for user 1
[19-Nov-2025 04:00:21 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 04:00:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 04:00:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 04:00:21 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 04:00:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:00:21 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 04:00:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 04:00:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 04:00:21 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 04:00:21 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:00:21 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 04:00:21 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 04:00:21 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 04:00:21 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 04:00:21 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 04:00:22 UTC] WebSocket connection established to Deriv API in 1091.39ms
[19-Nov-2025 04:00:22 UTC] Not authorized, calling authorize() first
[19-Nov-2025 04:00:23 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:00:22
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:00:23 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 04:00:23 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 04:00:32 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 04:00:32 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:00:32
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:00:32 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 04:00:21
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 04:00:32 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-11-19 04:00:21
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 684da5e5bcf84f2fa5a9e34543473ff6:737e9b454300cf1d0...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 04:00:32 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-19 04:00:21
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 03:54:08
  - Token last used: 2025-11-19 03:54:08
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 04:00:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 04:00:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 04:00:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 04:00:43 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 04:00:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:00:43 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 04:00:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 04:00:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 04:00:43 UTC] [TradingBotService] Closing connection for user 1
[19-Nov-2025 04:00:43 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 04:00:43 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 04:00:43 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 04:00:43 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 04:00:43 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:00:43 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 04:00:43 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 04:00:43 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 04:00:43 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 04:00:43 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:00:43 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 04:00:43 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 04:00:43 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 04:00:43 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 04:00:43 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 04:00:44 UTC] WebSocket connection established to Deriv API in 1149.28ms
[19-Nov-2025 04:00:44 UTC] Not authorized, calling authorize() first
[19-Nov-2025 04:00:44 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:00:44
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:00:44 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 04:00:44 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 04:00:53 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 04:00:54 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:00:53
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:00:54 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 04:00:43
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 04:00:54 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-11-19 04:00:43
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 684da5e5bcf84f2fa5a9e34543473ff6:737e9b454300cf1d0...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 04:00:54 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-19 04:00:43
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 03:54:08
  - Token last used: 2025-11-19 03:54:08
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 04:07:04 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 04:07:04 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 04:07:04 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 04:07:04 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 04:07:04 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:07:04 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 04:07:04 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 04:07:04 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 04:07:04 UTC] [TradingBotService] Closing connection for user 1
[19-Nov-2025 04:07:04 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[19-Nov-2025 04:07:04 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 04:07:04 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 04:07:04 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 04:07:04 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:07:04 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 04:07:04 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 04:07:04 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 04:07:04 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 04:07:04 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:07:04 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 04:07:04 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 04:07:04 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 04:07:04 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 04:07:04 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 04:07:06 UTC] WebSocket connection established to Deriv API in 1253.07ms
[19-Nov-2025 04:07:06 UTC] Not authorized, calling authorize() first
[19-Nov-2025 04:07:06 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:07:06
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:07:06 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 04:07:06 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 04:07:15 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 04:07:16 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:07:15
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:07:16 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 04:07:04
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(861): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\vtm\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 04:07:16 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-11-19 04:07:04
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 684da5e5bcf84f2fa5a9e34543473ff6:737e9b454300cf1d0...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[19-Nov-2025 04:07:16 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-19 04:07:04
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 03:54:08
  - Token last used: 2025-11-19 03:54:08
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[19-Nov-2025 04:07:21 UTC] [DerivAPI] Constructor - Building WebSocket URL
[19-Nov-2025 04:07:21 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[19-Nov-2025 04:07:21 UTC] [DerivAPI] appId: '105326'
[19-Nov-2025 04:07:21 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:07:21 UTC] [DerivAPI] wsUrl length: 48
[19-Nov-2025 04:07:21 UTC] [DerivAPI] wsUrl empty check: NO - OK
[19-Nov-2025 04:07:21 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[19-Nov-2025 04:07:21 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[19-Nov-2025 04:07:21 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[19-Nov-2025 04:07:21 UTC] [DerivAPI::ensureConnection] URL type: string
[19-Nov-2025 04:07:21 UTC] [DerivAPI::ensureConnection] URL length: 48
[19-Nov-2025 04:07:21 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[19-Nov-2025 04:07:21 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[19-Nov-2025 04:07:21 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[19-Nov-2025 04:07:22 UTC] WebSocket connection established to Deriv API in 1110.91ms
[19-Nov-2025 04:07:22 UTC] Not authorized, calling authorize() first
[19-Nov-2025 04:07:23 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:07:22
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:07:23 UTC] Sending WebSocket request: account (req_id: 1)
[19-Nov-2025 04:07:23 UTC] WebSocket receive attempt 1 failed: Deriv API error: Unrecognised request (UnrecognisedRequest)
[19-Nov-2025 04:07:32 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[19-Nov-2025 04:07:32 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-19 04:07:32
Token length: 15
Token preview: NobWoyZoq9ggbJM...yZoq9ggbJM
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"NobWoyZoq9ggbJM"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[19-Nov-2025 04:07:32 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-19 04:07:21
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Trying account endpoint
  - Request params: {"account":1}
  - Sending account request
  - Account endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\vtm\app\services\DerivAPI.php(463): App\Services\DerivAPI->sendRequest('account', Array)
#1 C:\xampp\htdocs\vtm\app\services\TradingBotService.php(138): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\vtm\api\trading.php(250): App\Services\TradingBotService->startTrading(1)
#3 C:\xampp\htdocs\vtm\api\trading.php(73): handleStartTrading(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[19-Nov-2025 04:07:32 UTC] Trading started for user 1. Balance: 108.88
[27-Nov-2025 09:01:07 UTC] PHP Warning:  Undefined array key "REQUEST_METHOD" in C:\xampp\htdocs\option\app\middleware\SecurityMiddleware.php on line 77
[27-Nov-2025 14:45:28 UTC] PHP Fatal error:  Uncaught Exception: Database connection failed: SQLSTATE[HY000] [2002] No connection could be made because the target machine actively refused it in C:\xampp\htdocs\option\app\config\Database.php:88
Stack trace:
#0 C:\xampp\htdocs\option\app\config\Database.php(59): App\Config\Database->connect()
#1 C:\xampp\htdocs\option\app\config\Database.php(106): App\Config\Database->getConnection()
#2 Command line code(1): App\Config\Database->query('SELECT state, C...')
#3 {main}
  thrown in C:\xampp\htdocs\option\app\config\Database.php on line 88
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] START - Encrypted data length: 96
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] Step 1: Getting encryption key
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] Step 1: OK - Key length: 32
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] Step 2: Validating encrypted data format
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] Step 3: Splitting encrypted data
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] Step 3: OK - IV length: 32, Tag length: 32, Encrypted length: 30
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] Step 4: Converting hex to binary
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] Step 4: OK - IV: 16 bytes, Tag: 16 bytes, Encrypted: 15 bytes
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] Step 5: Decrypting with OpenSSL
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] Step 5: OK - Decrypted length: 15
[30-Nov-2025 22:50:55 UTC] [EncryptionService::decrypt] SUCCESS - Decryption completed
[30-Nov-2025 22:50:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Final appId: '105326'
[30-Nov-2025 22:50:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[30-Nov-2025 22:50:55 UTC] [DerivAPI] wsUrl contains app_id: YES
[30-Nov-2025 22:50:55 UTC] [DerivAPI] wsUrl length: 48
[30-Nov-2025 22:50:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[30-Nov-2025 22:50:55 UTC] [TradingBotService] Closing connection for user 1
[30-Nov-2025 22:50:55 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Constructor - Building WebSocket URL
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Final appId: '105326'
[30-Nov-2025 22:50:55 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[30-Nov-2025 22:50:55 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[30-Nov-2025 22:50:55 UTC] [DerivAPI] wsUrl contains app_id: YES
[30-Nov-2025 22:50:55 UTC] [DerivAPI] wsUrl length: 48
[30-Nov-2025 22:50:55 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[30-Nov-2025 22:50:55 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[30-Nov-2025 22:50:55 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[30-Nov-2025 22:50:55 UTC] [DerivAPI::ensureConnection] URL type: string
[30-Nov-2025 22:50:55 UTC] [DerivAPI::ensureConnection] URL length: 48
[30-Nov-2025 22:50:55 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[30-Nov-2025 22:50:55 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[30-Nov-2025 22:50:55 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[30-Nov-2025 22:50:57 UTC] WebSocket connection established to Deriv API in 1649.59ms
[30-Nov-2025 22:50:57 UTC] Not authorized, calling authorize() first
[30-Nov-2025 22:50:57 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-30 22:50:57
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[30-Nov-2025 22:50:57 UTC] Sending WebSocket request: balance (req_id: 1)
[30-Nov-2025 22:50:58 UTC] WebSocket receive attempt 1 failed: Deriv API error: Input validation failed: balance (InputValidationFailed)
[30-Nov-2025 22:51:07 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[30-Nov-2025 22:51:07 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-30 22:51:07
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[30-Nov-2025 22:51:07 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-30 22:50:55
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Calling balance endpoint
  - Request params: {"balance":1}
  - Sending balance request
  - Balance endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\option\app\services\DerivAPI.php(496): App\Services\DerivAPI->sendRequest('balance', Array)
#1 C:\xampp\htdocs\option\app\services\TradingBotService.php(1036): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\option\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\option\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[30-Nov-2025 22:51:07 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-11-30 22:50:55
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 36352142e9a15bac9ae951fbdd22d9dd:7258bf5924748a087...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[30-Nov-2025 22:51:07 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-11-30 22:50:55
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 11:39:20
  - Token last used: 2025-11-19 11:39:20
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] START - Encrypted data length: 96
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] Step 1: Getting encryption key
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] Step 1: OK - Key length: 32
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] Step 2: Validating encrypted data format
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] Step 3: Splitting encrypted data
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] Step 3: OK - IV length: 32, Tag length: 32, Encrypted length: 30
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] Step 4: Converting hex to binary
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] Step 4: OK - IV: 16 bytes, Tag: 16 bytes, Encrypted: 15 bytes
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] Step 5: Decrypting with OpenSSL
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] Step 5: OK - Decrypted length: 15
[30-Nov-2025 22:51:12 UTC] [EncryptionService::decrypt] SUCCESS - Decryption completed
[30-Nov-2025 22:51:12 UTC] [DerivAPI] Constructor - Building WebSocket URL
[30-Nov-2025 22:51:12 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[30-Nov-2025 22:51:12 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[30-Nov-2025 22:51:12 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[30-Nov-2025 22:51:12 UTC] [DerivAPI] Final appId: '105326'
[30-Nov-2025 22:51:12 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[30-Nov-2025 22:51:12 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[30-Nov-2025 22:51:12 UTC] [DerivAPI] wsUrl contains app_id: YES
[30-Nov-2025 22:51:12 UTC] [DerivAPI] wsUrl length: 48
[30-Nov-2025 22:51:12 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[30-Nov-2025 22:51:12 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[30-Nov-2025 22:51:12 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[30-Nov-2025 22:51:12 UTC] [DerivAPI::ensureConnection] URL type: string
[30-Nov-2025 22:51:12 UTC] [DerivAPI::ensureConnection] URL length: 48
[30-Nov-2025 22:51:12 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[30-Nov-2025 22:51:12 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[30-Nov-2025 22:51:12 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[30-Nov-2025 22:51:13 UTC] WebSocket connection established to Deriv API in 1118.9ms
[30-Nov-2025 22:51:13 UTC] Not authorized, calling authorize() first
[30-Nov-2025 22:51:13 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-30 22:51:13
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[30-Nov-2025 22:51:13 UTC] Sending WebSocket request: balance (req_id: 1)
[30-Nov-2025 22:51:13 UTC] WebSocket receive attempt 1 failed: Deriv API error: Input validation failed: balance (InputValidationFailed)
[30-Nov-2025 22:51:22 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[30-Nov-2025 22:51:23 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-11-30 22:51:22
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[30-Nov-2025 22:51:23 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-11-30 22:51:12
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Calling balance endpoint
  - Request params: {"balance":1}
  - Sending balance request
  - Balance endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\option\app\services\DerivAPI.php(496): App\Services\DerivAPI->sendRequest('balance', Array)
#1 C:\xampp\htdocs\option\app\services\TradingBotService.php(138): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\option\api\trading.php(250): App\Services\TradingBotService->startTrading(1)
#3 C:\xampp\htdocs\option\api\trading.php(73): handleStartTrading(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[30-Nov-2025 22:51:23 UTC] Trading started for user 1. Balance: 108.88
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] START - Encrypted data length: 96
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] Step 1: Getting encryption key
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] Step 1: OK - Key length: 32
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] Step 2: Validating encrypted data format
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] Step 3: Splitting encrypted data
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] Step 3: OK - IV length: 32, Tag length: 32, Encrypted length: 30
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] Step 4: Converting hex to binary
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] Step 4: OK - IV: 16 bytes, Tag: 16 bytes, Encrypted: 15 bytes
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] Step 5: Decrypting with OpenSSL
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] Step 5: OK - Decrypted length: 15
[01-Dec-2025 00:26:36 UTC] [EncryptionService::decrypt] SUCCESS - Decryption completed
[01-Dec-2025 00:26:36 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Constructor - Building WebSocket URL
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Final appId: '105326'
[01-Dec-2025 00:26:36 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 00:26:36 UTC] [DerivAPI] wsUrl contains app_id: YES
[01-Dec-2025 00:26:36 UTC] [DerivAPI] wsUrl length: 48
[01-Dec-2025 00:26:36 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[01-Dec-2025 00:26:36 UTC] [TradingBotService] Closing connection for user 1
[01-Dec-2025 00:26:36 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Constructor - Building WebSocket URL
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Final appId: '105326'
[01-Dec-2025 00:26:36 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[01-Dec-2025 00:26:36 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 00:26:36 UTC] [DerivAPI] wsUrl contains app_id: YES
[01-Dec-2025 00:26:36 UTC] [DerivAPI] wsUrl length: 48
[01-Dec-2025 00:26:36 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[01-Dec-2025 00:26:36 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[01-Dec-2025 00:26:36 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 00:26:36 UTC] [DerivAPI::ensureConnection] URL type: string
[01-Dec-2025 00:26:36 UTC] [DerivAPI::ensureConnection] URL length: 48
[01-Dec-2025 00:26:36 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[01-Dec-2025 00:26:36 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[01-Dec-2025 00:26:36 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[01-Dec-2025 00:26:37 UTC] WebSocket connection established to Deriv API in 1414.55ms
[01-Dec-2025 00:26:37 UTC] Not authorized, calling authorize() first
[01-Dec-2025 00:26:38 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-12-01 00:26:37
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[01-Dec-2025 00:26:38 UTC] Sending WebSocket request: balance (req_id: 1)
[01-Dec-2025 00:26:38 UTC] WebSocket receive attempt 1 failed: Deriv API error: Input validation failed: balance (InputValidationFailed)
[01-Dec-2025 00:26:47 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[01-Dec-2025 00:26:48 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-12-01 00:26:47
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[01-Dec-2025 00:26:48 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-12-01 00:26:36
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Calling balance endpoint
  - Request params: {"balance":1}
  - Sending balance request
  - Balance endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\option\app\services\DerivAPI.php(496): App\Services\DerivAPI->sendRequest('balance', Array)
#1 C:\xampp\htdocs\option\app\services\TradingBotService.php(1036): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\option\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\option\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[01-Dec-2025 00:26:48 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-12-01 00:26:36
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 36352142e9a15bac9ae951fbdd22d9dd:7258bf5924748a087...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[01-Dec-2025 00:26:48 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-12-01 00:26:36
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 11:39:20
  - Token last used: 2025-11-19 11:39:20
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[01-Dec-2025 00:26:48 UTC] PHP Warning:  session_start(): open(C:\xampp\tmp\sess_5nvm1d8e4si1p1j96g14be98n6, O_RDWR) failed: Permission denied (13) in C:\xampp\htdocs\option\app\autoload.php on line 87
[01-Dec-2025 00:26:48 UTC] PHP Warning:  session_start(): Failed to read session data: files (path: C:\xampp\tmp) in C:\xampp\htdocs\option\app\autoload.php on line 87
[01-Dec-2025 00:51:37 UTC] [SignalService] Diagnostic: Found 1 active users
[01-Dec-2025 00:51:37 UTC] [SignalService] User 1 (rocketpaybiz@gmail.com): token=HAS_TOKEN, bot_active=1, session_state=active
[01-Dec-2025 00:51:37 UTC] [SignalService] Found 1 eligible users with valid tokens and active sessions
[01-Dec-2025 00:51:37 UTC] Pre-validating 1 users for API token availability
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] START - Encrypted data length: 96
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 1: Getting encryption key
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 1: OK - Key length: 32
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 2: Validating encrypted data format
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 3: Splitting encrypted data
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 3: OK - IV length: 32, Tag length: 32, Encrypted length: 30
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 4: Converting hex to binary
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 4: OK - IV: 16 bytes, Tag: 16 bytes, Encrypted: 15 bytes
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 5: Decrypting with OpenSSL
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 5: OK - Decrypted length: 15
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] SUCCESS - Decryption completed
[01-Dec-2025 00:51:37 UTC] User 1 (rocketpaybiz@gmail.com) token validation OK - length: 15
[01-Dec-2025 00:51:37 UTC] User validation complete - Valid: 1, Skipped: 0
[01-Dec-2025 00:51:37 UTC] Processing 1 valid users in 1 batch(es)
[01-Dec-2025 00:51:37 UTC] Processing batch 1 of 1 (1 users)
[01-Dec-2025 00:51:37 UTC] Processing user 1 (rocketpaybiz@gmail.com) - 1 of 1 in batch
[01-Dec-2025 00:51:37 UTC] [SignalService::executeSignalForUser] user=1 START {"signalType":"RISE","asset":"R_75","timestamp":"2025-12-01 00:51:37"}
[01-Dec-2025 00:51:37 UTC] [SignalService::executeSignalForUser] user=1 START - signalType=RISE asset=R_75
[01-Dec-2025 00:51:37 UTC] [SignalService::executeSignalForUser] user=1 Checking if trading is active
[01-Dec-2025 00:51:37 UTC] [SignalService::executeSignalForUser] user=1 Checking if trading is active
[01-Dec-2025 00:51:37 UTC] [SignalService::executeSignalForUser] user=1 Trading active check result {"is_active":true}
[01-Dec-2025 00:51:37 UTC] [SignalService::executeSignalForUser] user=1 Trading is active - proceeding with trade execution
[01-Dec-2025 00:51:37 UTC] [SignalService::executeSignalForUser] user=1 Trading is active
[01-Dec-2025 00:51:37 UTC] [SignalService::executeSignalForUser] user=1 Calling TradingBotService::executeSignalTrade
[01-Dec-2025 00:51:37 UTC] [SignalService::executeSignalForUser] user=1 Calling TradingBotService::executeSignalTrade
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 START - direction=RISE asset=R_75
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 1: Checking active trading session
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 1: OK - Session ID: 4, State: active
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 2: Loading user settings
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 2: OK - Stake: 1.00
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 3: Retrieving encrypted API token
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 3: OK - Encrypted token length: 96
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 4: Validating encrypted token format
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 4: OK - Token format valid
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 5: Decrypting API token
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] START - Encrypted data length: 96
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 1: Getting encryption key
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 1: OK - Key length: 32
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 2: Validating encrypted data format
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 3: Splitting encrypted data
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 3: OK - IV length: 32, Tag length: 32, Encrypted length: 30
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 4: Converting hex to binary
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 4: OK - IV: 16 bytes, Tag: 16 bytes, Encrypted: 15 bytes
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 5: Decrypting with OpenSSL
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] Step 5: OK - Decrypted length: 15
[01-Dec-2025 00:51:37 UTC] [EncryptionService::decrypt] SUCCESS - Decryption completed
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 5: OK - Decrypted token length: 15
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 6: Creating DerivAPI instance
[01-Dec-2025 00:51:37 UTC] [DerivAPI] Constructor - Building WebSocket URL
[01-Dec-2025 00:51:37 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[01-Dec-2025 00:51:37 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[01-Dec-2025 00:51:37 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[01-Dec-2025 00:51:37 UTC] [DerivAPI] Final appId: '105326'
[01-Dec-2025 00:51:37 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[01-Dec-2025 00:51:37 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 00:51:37 UTC] [DerivAPI] wsUrl contains app_id: YES
[01-Dec-2025 00:51:37 UTC] [DerivAPI] wsUrl length: 48
[01-Dec-2025 00:51:37 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 6: OK - DerivAPI instance created
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 7: SKIP - Asset specified: R_75
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 8: Contract type: CALL (from direction: RISE)
[01-Dec-2025 00:51:37 UTC] [TradingBot::executeSignalTrade] user=1 Step 9: Placing trade - asset=R_75 type=CALL stake=1.00 duration=5
[01-Dec-2025 00:51:37 UTC] [DerivAPI::buyContract] START - symbol=R_75 type=CALL amount=1 duration=5
[01-Dec-2025 00:51:37 UTC] [DerivAPI::buyContract] Step 1: Ensuring authorization
[01-Dec-2025 00:51:37 UTC] [DerivAPI::buyContract] Not authorized, calling authorize()
[01-Dec-2025 00:51:37 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[01-Dec-2025 00:51:37 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 00:51:37 UTC] [DerivAPI::ensureConnection] URL type: string
[01-Dec-2025 00:51:37 UTC] [DerivAPI::ensureConnection] URL length: 48
[01-Dec-2025 00:51:37 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[01-Dec-2025 00:51:37 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[01-Dec-2025 00:51:37 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[01-Dec-2025 00:51:38 UTC] WebSocket connection established to Deriv API in 1521.13ms
[01-Dec-2025 00:51:39 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-12-01 00:51:37
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[01-Dec-2025 00:51:39 UTC] [DerivAPI::buyContract] Step 1: OK - Authorized
[01-Dec-2025 00:51:39 UTC] [DerivAPI::buyContract] Step 2: Getting contracts_for for symbol: R_75
[01-Dec-2025 00:51:39 UTC] [DerivAPI::getContractsFor] START - symbol=R_75
[01-Dec-2025 00:51:39 UTC] [DerivAPI::getContractsFor] Sending contracts_for request for symbol: R_75
[01-Dec-2025 00:51:39 UTC] Sending WebSocket request: contracts_for (req_id: 1)
[01-Dec-2025 00:51:39 UTC] WebSocket receive attempt 1 failed: Deriv API error: Input validation failed: contracts_for (InputValidationFailed)
[01-Dec-2025 00:51:48 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[01-Dec-2025 00:51:48 UTC] [DerivAPI::getContractsFor] ERROR: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
[01-Dec-2025 00:51:48 UTC] [DerivAPI::getContractsFor] Exception trace: #0 C:\xampp\htdocs\option\app\services\DerivAPI.php(584): App\Services\DerivAPI->sendRequest('contracts_for', Array)
#1 C:\xampp\htdocs\option\app\services\DerivAPI.php(711): App\Services\DerivAPI->getContractsFor('R_75')
#2 C:\xampp\htdocs\option\app\services\TradingBotService.php(548): App\Services\DerivAPI->buyContract('R_75', 'CALL', 1, 5, 't')
#3 C:\xampp\htdocs\option\app\services\SignalService.php(556): App\Services\TradingBotService->executeSignalTrade(1, 'RISE', 'R_75')
#4 C:\xampp\htdocs\option\app\services\SignalService.php(352): App\Services\SignalService->executeSignalForUser(1, 'RISE', 'R_75')
#5 C:\xampp\htdocs\option\app\services\SignalService.php(117): App\Services\SignalService->executeSignalForAllUsers(1, 'RISE', 'R_75')
#6 C:\xampp\htdocs\option\cron\url_signal_watcher.php(161): App\Services\SignalService->receiveSignal(Array)
#7 {main}
[01-Dec-2025 00:51:48 UTC] [DerivAPI::buyContract] FATAL ERROR: Buy contract error: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
[01-Dec-2025 00:51:48 UTC] [DerivAPI::buyContract] Exception trace: #0 C:\xampp\htdocs\option\app\services\DerivAPI.php(711): App\Services\DerivAPI->getContractsFor('R_75')
#1 C:\xampp\htdocs\option\app\services\TradingBotService.php(548): App\Services\DerivAPI->buyContract('R_75', 'CALL', 1, 5, 't')
#2 C:\xampp\htdocs\option\app\services\SignalService.php(556): App\Services\TradingBotService->executeSignalTrade(1, 'RISE', 'R_75')
#3 C:\xampp\htdocs\option\app\services\SignalService.php(352): App\Services\SignalService->executeSignalForUser(1, 'RISE', 'R_75')
#4 C:\xampp\htdocs\option\app\services\SignalService.php(117): App\Services\SignalService->executeSignalForAllUsers(1, 'RISE', 'R_75')
#5 C:\xampp\htdocs\option\cron\url_signal_watcher.php(161): App\Services\SignalService->receiveSignal(Array)
#6 {main}
[01-Dec-2025 00:51:48 UTC] [TradingBot::executeSignalTrade] user=1 ERROR: Failed to place trade: Buy contract error: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
[01-Dec-2025 00:51:48 UTC] [TradingBot::executeSignalTrade] user=1 buyContract exception: #0 C:\xampp\htdocs\option\app\services\TradingBotService.php(548): App\Services\DerivAPI->buyContract('R_75', 'CALL', 1, 5, 't')
#1 C:\xampp\htdocs\option\app\services\SignalService.php(556): App\Services\TradingBotService->executeSignalTrade(1, 'RISE', 'R_75')
#2 C:\xampp\htdocs\option\app\services\SignalService.php(352): App\Services\SignalService->executeSignalForUser(1, 'RISE', 'R_75')
#3 C:\xampp\htdocs\option\app\services\SignalService.php(117): App\Services\SignalService->executeSignalForAllUsers(1, 'RISE', 'R_75')
#4 C:\xampp\htdocs\option\cron\url_signal_watcher.php(161): App\Services\SignalService->receiveSignal(Array)
#5 {main}
[01-Dec-2025 00:51:48 UTC] [TradingBot::executeSignalTrade] user=1 EXCEPTION in trade execution: Failed to place trade: Buy contract error: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
[01-Dec-2025 00:51:48 UTC] [TradingBot::executeSignalTrade] user=1 Exception trace: #0 C:\xampp\htdocs\option\app\services\SignalService.php(556): App\Services\TradingBotService->executeSignalTrade(1, 'RISE', 'R_75')
#1 C:\xampp\htdocs\option\app\services\SignalService.php(352): App\Services\SignalService->executeSignalForUser(1, 'RISE', 'R_75')
#2 C:\xampp\htdocs\option\app\services\SignalService.php(117): App\Services\SignalService->executeSignalForAllUsers(1, 'RISE', 'R_75')
#3 C:\xampp\htdocs\option\cron\url_signal_watcher.php(161): App\Services\SignalService->receiveSignal(Array)
#4 {main}
[01-Dec-2025 00:51:48 UTC] [TradingBot::executeSignalTrade] user=1 DerivAPI connection closed
[01-Dec-2025 00:51:48 UTC] [TradingBot::executeSignalTrade] user=1 FATAL ERROR: Failed to place trade: Buy contract error: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
[01-Dec-2025 00:51:48 UTC] [TradingBot::executeSignalTrade] user=1 Fatal exception trace: #0 C:\xampp\htdocs\option\app\services\SignalService.php(556): App\Services\TradingBotService->executeSignalTrade(1, 'RISE', 'R_75')
#1 C:\xampp\htdocs\option\app\services\SignalService.php(352): App\Services\SignalService->executeSignalForUser(1, 'RISE', 'R_75')
#2 C:\xampp\htdocs\option\app\services\SignalService.php(117): App\Services\SignalService->executeSignalForAllUsers(1, 'RISE', 'R_75')
#3 C:\xampp\htdocs\option\cron\url_signal_watcher.php(161): App\Services\SignalService->receiveSignal(Array)
#4 {main}
[01-Dec-2025 00:51:48 UTC] [SignalService::executeSignalForUser] user=1 EXCEPTION {"error":"TradingBotService execution failed: Failed to place trade: Buy contract error: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout","exception_type":"Exception","exception_message":"Failed to place trade: Buy contract error: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout","exception_file":"C:\\xampp\\htdocs\\option\\app\\services\\TradingBotService.php","exception_line":563,"trace":["#0 C:\\xampp\\htdocs\\option\\app\\services\\SignalService.php(556): App\\Services\\TradingBotService->executeSignalTrade(1, 'RISE', 'R_75')","#1 C:\\xampp\\htdocs\\option\\app\\services\\SignalService.php(352): App\\Services\\SignalService->executeSignalForUser(1, 'RISE', 'R_75')","#2 C:\\xampp\\htdocs\\option\\app\\services\\SignalService.php(117): App\\Services\\SignalService->executeSignalForAllUsers(1, 'RISE', 'R_75')","#3 C:\\xampp\\htdocs\\option\\cron\\url_signal_watcher.php(161): App\\Services\\SignalService->receiveSignal(Array)","#4 {main}"]}
[01-Dec-2025 00:51:48 UTC] [SignalService::executeSignalForUser] user=1 ERROR: TradingBotService execution failed: Failed to place trade: Buy contract error: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
[01-Dec-2025 00:51:48 UTC] [SignalService::executeSignalForUser] user=1 Exception type: Exception
[01-Dec-2025 00:51:48 UTC] [SignalService::executeSignalForUser] user=1 Exception trace: #0 C:\xampp\htdocs\option\app\services\SignalService.php(556): App\Services\TradingBotService->executeSignalTrade(1, 'RISE', 'R_75')
#1 C:\xampp\htdocs\option\app\services\SignalService.php(352): App\Services\SignalService->executeSignalForUser(1, 'RISE', 'R_75')
#2 C:\xampp\htdocs\option\app\services\SignalService.php(117): App\Services\SignalService->executeSignalForAllUsers(1, 'RISE', 'R_75')
#3 C:\xampp\htdocs\option\cron\url_signal_watcher.php(161): App\Services\SignalService->receiveSignal(Array)
#4 {main}
[01-Dec-2025 00:51:48 UTC] User 1 trade execution FAILED - Error: TradingBotService execution failed: Failed to place trade: Buy contract error: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
[01-Dec-2025 00:51:48 UTC] User 1 Exception type: Exception
[01-Dec-2025 00:51:48 UTC] Signal executed: RISE on R_75 - Total: 1, Valid: 1, Skipped: 0, Successful: 0, Failed: 1
[01-Dec-2025 00:51:48 UTC] === SIGNAL EXECUTION SUMMARY === {"signal_type":"RISE","asset":"R_75","total_users":1,"valid_users":1,"skipped_users":0,"successful_executions":0,"failed_executions":1,"execution_time_ms":11489,"results":[{"user_id":1,"success":false,"error":"TradingBotService execution failed: Failed to place trade: Buy contract error: Failed to get contracts for R_75: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout","exception_type":"Exception","exception_file":"C:\\xampp\\htdocs\\option\\app\\services\\TradingBotService.php","exception_line":563}],"skipped_users_details":[]}
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] START - Encrypted data length: 96
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] Step 1: Getting encryption key
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] Step 1: OK - Key length: 32
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] Step 2: Validating encrypted data format
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] Step 3: Splitting encrypted data
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] Step 3: OK - IV length: 32, Tag length: 32, Encrypted length: 30
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] Step 4: Converting hex to binary
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] Step 4: OK - IV: 16 bytes, Tag: 16 bytes, Encrypted: 15 bytes
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] Step 5: Decrypting with OpenSSL
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] Step 5: OK - Decrypted length: 15
[01-Dec-2025 01:03:30 UTC] [EncryptionService::decrypt] SUCCESS - Decryption completed
[01-Dec-2025 01:03:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Final appId: '105326'
[01-Dec-2025 01:03:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 01:03:30 UTC] [DerivAPI] wsUrl contains app_id: YES
[01-Dec-2025 01:03:30 UTC] [DerivAPI] wsUrl length: 48
[01-Dec-2025 01:03:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[01-Dec-2025 01:03:30 UTC] [TradingBotService] Closing connection for user 1
[01-Dec-2025 01:03:30 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Constructor - Building WebSocket URL
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Final appId: '105326'
[01-Dec-2025 01:03:30 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[01-Dec-2025 01:03:30 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 01:03:30 UTC] [DerivAPI] wsUrl contains app_id: YES
[01-Dec-2025 01:03:30 UTC] [DerivAPI] wsUrl length: 48
[01-Dec-2025 01:03:30 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[01-Dec-2025 01:03:30 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[01-Dec-2025 01:03:30 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 01:03:30 UTC] [DerivAPI::ensureConnection] URL type: string
[01-Dec-2025 01:03:30 UTC] [DerivAPI::ensureConnection] URL length: 48
[01-Dec-2025 01:03:30 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[01-Dec-2025 01:03:30 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[01-Dec-2025 01:03:30 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[01-Dec-2025 01:03:32 UTC] WebSocket connection established to Deriv API in 1344.52ms
[01-Dec-2025 01:03:32 UTC] Not authorized, calling authorize() first
[01-Dec-2025 01:03:32 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-12-01 01:03:32
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[01-Dec-2025 01:03:32 UTC] Sending WebSocket request: balance (req_id: 1)
[01-Dec-2025 01:03:32 UTC] WebSocket receive attempt 1 failed: Deriv API error: Input validation failed: balance (InputValidationFailed)
[01-Dec-2025 01:03:41 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[01-Dec-2025 01:03:42 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-12-01 01:03:41
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[01-Dec-2025 01:03:42 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-12-01 01:03:30
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Calling balance endpoint
  - Request params: {"balance":1}
  - Sending balance request
  - Balance endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\option\app\services\DerivAPI.php(496): App\Services\DerivAPI->sendRequest('balance', Array)
#1 C:\xampp\htdocs\option\app\services\TradingBotService.php(1036): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\option\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\option\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[01-Dec-2025 01:03:42 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-12-01 01:03:30
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 36352142e9a15bac9ae951fbdd22d9dd:7258bf5924748a087...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[01-Dec-2025 01:03:42 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-12-01 01:03:30
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 11:39:20
  - Token last used: 2025-11-19 11:39:20
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] START - Encrypted data length: 96
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] Step 1: Getting encryption key
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] Step 1: OK - Key length: 32
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] Step 2: Validating encrypted data format
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] Step 3: Splitting encrypted data
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] Step 3: OK - IV length: 32, Tag length: 32, Encrypted length: 30
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] Step 4: Converting hex to binary
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] Step 4: OK - IV: 16 bytes, Tag: 16 bytes, Encrypted: 15 bytes
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] Step 5: Decrypting with OpenSSL
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] Step 5: OK - Decrypted length: 15
[01-Dec-2025 01:03:45 UTC] [EncryptionService::decrypt] SUCCESS - Decryption completed
[01-Dec-2025 01:03:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Final appId: '105326'
[01-Dec-2025 01:03:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 01:03:45 UTC] [DerivAPI] wsUrl contains app_id: YES
[01-Dec-2025 01:03:45 UTC] [DerivAPI] wsUrl length: 48
[01-Dec-2025 01:03:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[01-Dec-2025 01:03:45 UTC] [TradingBotService] Closing connection for user 1
[01-Dec-2025 01:03:45 UTC] [TradingBotService] Creating new DerivAPI connection for user 1
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Constructor - Building WebSocket URL
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Environment check - getenv('DERIV_APP_ID'): false
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Environment check - $_ENV['DERIV_APP_ID']: '105326'
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Environment check - DERIV_APP_ID constant: 105326
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Final appId: '105326'
[01-Dec-2025 01:03:45 UTC] [DerivAPI] wsHost: 'ws.derivws.com'
[01-Dec-2025 01:03:45 UTC] [DerivAPI] Final wsUrl: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 01:03:45 UTC] [DerivAPI] wsUrl contains app_id: YES
[01-Dec-2025 01:03:45 UTC] [DerivAPI] wsUrl length: 48
[01-Dec-2025 01:03:45 UTC] DerivAPI initialized: wss://ws.derivws.com/websockets/v3?app_id=105326, App ID: 105326
[01-Dec-2025 01:03:45 UTC] [DerivAPI::ensureConnection] About to create WebSocketClient
[01-Dec-2025 01:03:45 UTC] [DerivAPI::ensureConnection] URL to pass: 'wss://ws.derivws.com/websockets/v3?app_id=105326'
[01-Dec-2025 01:03:45 UTC] [DerivAPI::ensureConnection] URL type: string
[01-Dec-2025 01:03:45 UTC] [DerivAPI::ensureConnection] URL length: 48
[01-Dec-2025 01:03:45 UTC] [DerivAPI::ensureConnection] URL empty check: NO - OK
[01-Dec-2025 01:03:45 UTC] [DerivAPI::ensureConnection] WebSocketClient created successfully, calling connect()
[01-Dec-2025 01:03:45 UTC] [DerivAPI::ensureConnection] Connection timeout: 8 seconds
[01-Dec-2025 01:03:46 UTC] WebSocket connection established to Deriv API in 1117.36ms
[01-Dec-2025 01:03:46 UTC] Not authorized, calling authorize() first
[01-Dec-2025 01:03:47 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-12-01 01:03:46
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[01-Dec-2025 01:03:47 UTC] Sending WebSocket request: balance (req_id: 1)
[01-Dec-2025 01:03:47 UTC] WebSocket receive attempt 1 failed: Deriv API error: Input validation failed: balance (InputValidationFailed)
[01-Dec-2025 01:03:56 UTC] WebSocket receive attempt 2 failed: WebSocket receive timeout
[01-Dec-2025 01:03:56 UTC] [DerivAPI::authorize] === DerivAPI::authorize START ===
Timestamp: 2025-12-01 01:03:56
Token length: 15
Token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 1: Built auth message
  - Message structure: ["authorize"]
Step 2: Ensuring WebSocket connection
  - Connection ensured
  - WebSocket is connected
Step 3: Sending authorization request
  - Request data length: 31
  - Request preview: {"authorize":"KeNPW20DGi0zHyX"}...
  - Request sent successfully
Step 4: Waiting for authorization response
  - Receiving response (attempt 1)
  - Response received, length: 1685
  - Response preview: {"authorize":{"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landin
  - JSON decoded successfully
  - Response keys: authorize, echo_req, msg_type
  - Authorization response found!
  - Authorize data keys: account_list, balance, country, currency, email, fullname, is_virtual, landing_company_fullname, landing_company_name, linked_to, local_currencies, loginid, preferred_language, scopes, upgradeable_landing_companies, user_id
Step 5: Authorization successful
  - LoginID: VRTC1155676
  - Balance: 108.88
  - Currency: USD
  - Full auth data: {"account_list":[{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1444056419,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR335357"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1585006292,"currency":"BTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR1309754"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1627123130,"currency":"LTC","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2672829"},{"account_category":"trading","account_type":"binary","broker":"CR","created_at":1633708706,"currency":"eUSDT","currency_type":"crypto","is_disabled":0,"is_virtual":0,"landing_company_name":"svg","linked_to":[],"loginid":"CR2950600"},{"account_category":"trading","account_type":"binary","broker":"VRTC","created_at":1443990814,"currency":"USD","currency_type":"fiat","is_disabled":0,"is_virtual":1,"landing_company_name":"virtual","linked_to":[],"loginid":"VRTC1155676"}],"balance":108.88,"country":"ng","currency":"USD","email":"gogodswilly@gmail.com","fullname":"Mr Godswill Shaibu","is_virtual":1,"landing_company_fullname":"Deriv Limited","landing_company_name":"virtual","linked_to":[],"local_currencies":{"NGN":{"fractional_digits":2}},"loginid":"VRTC1155676","preferred_language":"EN","scopes":["read","trade","trading_information"],"upgradeable_landing_companies":["svg"],"user_id":5266100}
=== DerivAPI::authorize SUCCESS ===
[01-Dec-2025 01:03:56 UTC] [DerivAPI::getBalance] === DerivAPI::getBalance START ===
Timestamp: 2025-12-01 01:03:45
Step 1: Checking cached auth data
  - No cached balance available
Step 2: Ensuring connection
  - Connection ensured
  - isConnected(): false
  - isAuthorized: false
Step 3: Calling balance endpoint
  - Request params: {"balance":1}
  - Sending balance request
  - Balance endpoint FAILED: Failed to get response from Deriv API after 2 attempts. Last error: WebSocket receive timeout
  - Error type: Exception
  - Error trace: #0 C:\xampp\htdocs\option\app\services\DerivAPI.php(496): App\Services\DerivAPI->sendRequest('balance', Array)
#1 C:\xampp\htdocs\option\app\services\TradingBotService.php(1036): App\Services\DerivAPI->getBalance()
#2 C:\xampp\htdocs\option\api\trading.php(327): App\Services\TradingBotService->getAccountBalance(1)
#3 C:\xampp\htdocs\option\api\trading.php(61): handleGetBalance(1)
#4 {main}
Step 4: Falling back to authorize()
  - authorize() completed
  - Auth data keys: account_list, balance, currency, loginid, country, email, fullname, scopes
  - Auth data balance: 108.88
  - Final balance: 108.88
=== DerivAPI::getBalance SUCCESS (authorize fallback) ===
[01-Dec-2025 01:03:56 UTC] [TradingBotService::getAccountBalance] === TradingBotService::getAccountBalance START for user 1 ===
Timestamp: 2025-12-01 01:03:45
Step 1: Checking balance cache
  - No cache found
Step 2: Querying database for user token
  - User query result: FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
Step 3: Decrypting token
  - Encrypted token length: 96
  - Encrypted token preview: 36352142e9a15bac9ae951fbdd22d9dd:7258bf5924748a087...
  - Decryption SUCCESS
  - Decrypted token length: 15
  - Decrypted token preview: KeNPW20DGi0zHyX...20DGi0zHyX
Step 4: Getting or creating DerivAPI connection
  - DerivAPI instance obtained
  - Connection status: NOT CONNECTED
Step 5: Attempt 1/2 to get balance
  - Connection check: NOT CONNECTED
  - Connection not healthy, recreating
  - New connection status: NOT CONNECTED
  - Calling derivApi->getBalance()
  - Balance retrieved: 108.88
  - Balance type: double
  - Balance value: 108.88
  - Balance cached
=== TradingBotService::getAccountBalance SUCCESS ===
[01-Dec-2025 01:03:56 UTC] [handleGetBalance] === handleGetBalance START for user 1 ===
Timestamp: 2025-12-01 01:03:45
Step 1: Querying database for user 1
Step 1 Result: User FOUND
  - Email: rocketpaybiz@gmail.com
  - Has encrypted_token: YES
  - Token length: 96
  - Token created: 2025-11-19 11:39:20
  - Token last used: 2025-11-19 11:39:20
Step 3: Calling TradingBotService->getAccountBalance(1)
Step 3: TradingBotService instance obtained
Step 4: Balance retrieved from service: 108.88
Step 4: Balance type: double
Step 4: Balance value: 108.88
Step 5: Preparing response: {"balance":108.88,"currency":"USD","hasToken":true,"debug":{"user_found":true,"has_token":true,"balance_retrieved":true,"balance_value":108.88}}
=== handleGetBalance SUCCESS ===
